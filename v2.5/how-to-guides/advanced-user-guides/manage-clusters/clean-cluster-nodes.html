<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-2.5 plugin-docs plugin-id-default docs-doc-id-how-to-guides/advanced-user-guides/manage-clusters/clean-cluster-nodes">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="search" type="application/opensearchdescription+xml" title="Rancher Manager" href="/opensearch.xml"><title data-rh="true">Removing Kubernetes Components from Nodes | Rancher Manager</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://docs.ranchermanager.rancher.io//v2.5/how-to-guides/advanced-user-guides/manage-clusters/clean-cluster-nodes"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="2.5"><meta data-rh="true" name="docusaurus_tag" content="docs-default-2.5"><meta data-rh="true" name="docsearch:version" content="2.5"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-2.5"><meta data-rh="true" property="og:title" content="Removing Kubernetes Components from Nodes | Rancher Manager"><meta data-rh="true" name="description" content="Learn about cluster cleanup when removing nodes from your Rancher-launched Kubernetes cluster. What is removed, how to do it manually"><meta data-rh="true" property="og:description" content="Learn about cluster cleanup when removing nodes from your Rancher-launched Kubernetes cluster. What is removed, how to do it manually"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="http://docs.ranchermanager.rancher.io//v2.5/how-to-guides/advanced-user-guides/manage-clusters/clean-cluster-nodes"><link data-rh="true" rel="alternate" href="http://docs.ranchermanager.rancher.io//v2.5/how-to-guides/advanced-user-guides/manage-clusters/clean-cluster-nodes" hreflang="en"><link data-rh="true" rel="alternate" href="http://docs.ranchermanager.rancher.io//v2.5/how-to-guides/advanced-user-guides/manage-clusters/clean-cluster-nodes" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://30NEY6C9UY-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.31d3122a.css">
<link rel="preload" href="/assets/js/runtime~main.d2604d48.js" as="script">
<link rel="preload" href="/assets/js/main.aa78001f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/v2.5">v2.5</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/how-to-guides/advanced-user-guides/manage-clusters/clean-cluster-nodes">v2.6</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/v2.5/how-to-guides/advanced-user-guides/manage-clusters/clean-cluster-nodes">v2.5</a></li><li><a class="dropdown__link" href="/v2.0-v2.4/how-to-guides/advanced-user-guides/manage-clusters/clean-cluster-nodes">v2.0-v2.4</a></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__docs navbar__link--active" href="/v2.5">Docs</a><a href="https://github.com/rancher/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__github btn btn-secondary icon-github">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v2.5">Rancher 2.5</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/getting-started">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/v2.5/how-to-guides">How-to Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;How-to Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/new-user-guides">New User Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;New User Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/v2.5/pages-for-subheaders/advanced-user-guides">Advanced User Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Advanced User Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/authentication-permissions-and-global-configuration">Authentication, Permissions, and Global Configuration</a><button aria-label="Toggle the collapsible sidebar category &#x27;Authentication, Permissions, and Global Configuration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/v2.5/pages-for-subheaders/manage-clusters">Manage Clusters</a><button aria-label="Toggle the collapsible sidebar category &#x27;Manage Clusters&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/access-clusters">Access Clusters</a><button aria-label="Toggle the collapsible sidebar category &#x27;Access Clusters&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/install-cluster-autoscaler">Install Cluster Autoscaler</a><button aria-label="Toggle the collapsible sidebar category &#x27;Install Cluster Autoscaler&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/create-kubernetes-persistent-storage">Create Kubernetes Persistent Storage</a><button aria-label="Toggle the collapsible sidebar category &#x27;Create Kubernetes Persistent Storage&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/how-to-guides/advanced-user-guides/manage-clusters/projects-and-namespaces">Projects and Kubernetes Namespaces with Rancher</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/how-to-guides/advanced-user-guides/manage-clusters/clone-cluster-configuration">Cloning Clusters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/how-to-guides/advanced-user-guides/manage-clusters/rotate-certificates">Certificate Rotation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/how-to-guides/advanced-user-guides/manage-clusters/nodes-and-node-pools">Nodes and Node Pools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/v2.5/how-to-guides/advanced-user-guides/manage-clusters/clean-cluster-nodes">Removing Kubernetes Components from Nodes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/how-to-guides/advanced-user-guides/manage-clusters/add-a-pod-security-policy">Adding a Pod Security Policy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/how-to-guides/advanced-user-guides/manage-clusters/assign-pod-security-policies">Assigning Pod Security Policies</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/manage-projects">Manage Projects</a><button aria-label="Toggle the collapsible sidebar category &#x27;Manage Projects&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/monitoring-alerting-guides">Monitoring/Alerting Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Monitoring/Alerting Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/monitoring-v2-configuration-guides">Monitoring V2 Configuration Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Monitoring V2 Configuration Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/istio-setup-guide">Istio Setup Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;Istio Setup Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/cis-scan-guides">CIS Scan Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;CIS Scan Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/reference-guides">Reference Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reference Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/explanations">Explanations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Explanations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/faq">FAQ</a><button aria-label="Toggle the collapsible sidebar category &#x27;FAQ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/troubleshooting">Troubleshooting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Troubleshooting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v2.5/contribute-to-rancher">Contributing to Rancher</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Rancher Manager<!-- --> <b>v2.5</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/how-to-guides/advanced-user-guides/manage-clusters/clean-cluster-nodes">latest version</a></b> (<!-- -->v2.6<!-- -->).</div></div><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.5/how-to-guides"><span itemprop="name">How-to Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.5/pages-for-subheaders/advanced-user-guides"><span itemprop="name">Advanced User Guides</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.5/pages-for-subheaders/manage-clusters"><span itemprop="name">Manage Clusters</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Removing Kubernetes Components from Nodes</span><meta itemprop="position" content="4"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v2.5</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Removing Kubernetes Components from Nodes</h1></header><p>This section describes how to disconnect a node from a Rancher-launched Kubernetes cluster and remove all of the Kubernetes components from the node. This process allows you to use the node for other purposes.</p><p>When you use Rancher to install Kubernetes on new nodes in an infrastructure provider, resources (containers/virtual network interfaces) and configuration items (certificates/configuration files) are created.</p><p>When removing nodes from your Rancher launched Kubernetes cluster (provided that they are in <code>Active</code> state), those resources are automatically cleaned, and the only action needed is to restart the node. When a node has become unreachable and the automatic cleanup process cannot be used, we describe the steps that need to be executed before the node can be added to a cluster again.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-gets-removed">What Gets Removed?<a class="hash-link" href="#what-gets-removed" title="Direct link to heading">​</a></h2><p>When cleaning nodes provisioned using Rancher, the following components are deleted based on the type of cluster node you&#x27;re removing.</p><table><thead><tr><th>Removed Component</th><th><a href="/v2.5/pages-for-subheaders/use-new-nodes-in-an-infra-provider">Nodes Hosted by Infrastructure Provider</a></th><th><a href="/v2.5/pages-for-subheaders/use-existing-nodes">Custom Nodes</a></th><th><a href="/v2.5/pages-for-subheaders/amazon-eks-permissions">Hosted Cluster</a></th><th><a href="/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/register-existing-clusters">Registered Nodes</a></th></tr></thead><tbody><tr><td>The Rancher deployment namespace (<code>cattle-system</code> by default)</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr><tr><td><code>serviceAccount</code>, <code>clusterRoles</code>, and <code>clusterRoleBindings</code> labeled by Rancher</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr><tr><td>Labels, Annotations, and Finalizers</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td></tr><tr><td>Rancher Deployment</td><td>✓</td><td>✓</td><td>✓</td><td></td></tr><tr><td>Machines, clusters, projects, and user custom resource definitions (CRDs)</td><td>✓</td><td>✓</td><td>✓</td><td></td></tr><tr><td>All resources create under the <code>management.cattle.io</code> API Group</td><td>✓</td><td>✓</td><td>✓</td><td></td></tr><tr><td>All CRDs created by Rancher v2.x</td><td>✓</td><td>✓</td><td>✓</td><td></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="removing-a-node-from-a-cluster-by-rancher-ui">Removing a Node from a Cluster by Rancher UI<a class="hash-link" href="#removing-a-node-from-a-cluster-by-rancher-ui" title="Direct link to heading">​</a></h2><p>When the node is in <code>Active</code> state, removing the node from a cluster will trigger a process to clean up the node. Please restart the node after the automatic cleanup process is done to make sure any non-persistent data is properly removed.</p><p><strong>To restart a node:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># using reboot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ sudo reboot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># using shutdown</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ sudo shutdown -r now</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="removing-rancher-components-from-a-cluster-manually">Removing Rancher Components from a Cluster Manually<a class="hash-link" href="#removing-rancher-components-from-a-cluster-manually" title="Direct link to heading">​</a></h2><p>When a node is unreachable and removed from the cluster, the automatic cleaning process can&#x27;t be triggered because the node is unreachable. Please follow the steps below to manually remove the Rancher components.</p><blockquote><p><strong>Warning:</strong> The commands listed below will remove data from the node. Make sure you have created a backup of files you want to keep before executing any of the commands as data will be lost.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="removing-rancher-components-from-registered-clusters">Removing Rancher Components from Registered Clusters<a class="hash-link" href="#removing-rancher-components-from-registered-clusters" title="Direct link to heading">​</a></h3><p>For registered clusters, the process for removing Rancher is a little different. You have the option of simply deleting the cluster in the Rancher UI, or your can run a script that removes Rancher components from the nodes. Both options make the same deletions.</p><p>After the registered cluster is detached from Rancher, the cluster&#x27;s workloads will be unaffected and you can access the cluster using the same methods that you did before the cluster was registered into Rancher.</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">By UI / API</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">By Script</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><blockquote><p><strong>Warning:</strong> This process will remove data from your cluster. Make sure you have created a backup of files you want to keep before executing the command, as data will be lost.</p></blockquote><p>After you initiate the removal of a registered cluster using the Rancher UI (or API), the following events occur.</p><ol><li><p>Rancher creates a <code>serviceAccount</code> that it uses to remove the Rancher components from the cluster. This account is assigned the <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/#role-and-clusterrole" target="_blank" rel="noopener noreferrer">clusterRole</a> and <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/#rolebinding-and-clusterrolebinding" target="_blank" rel="noopener noreferrer">clusterRoleBinding</a> permissions, which are required to remove the Rancher components.</p></li><li><p>Using the <code>serviceAccount</code>, Rancher schedules and runs a <a href="https://kubernetes.io/docs/concepts/workloads/controllers/jobs-run-to-completion/" target="_blank" rel="noopener noreferrer">job</a> that cleans the Rancher components off of the cluster. This job also references the <code>serviceAccount</code> and its roles as dependencies, so the job deletes them before its completion.</p></li><li><p>Rancher is removed from the cluster. However, the cluster persists, running the native version of Kubernetes.</p></li></ol><p><strong>Result:</strong> All components listed for registered clusters in <a href="#what-gets-removed">What Gets Removed?</a> are deleted.</p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Rather than cleaning registered cluster nodes using the Rancher UI, you can run a script instead.</p><blockquote><p><strong>Prerequisite:</strong></p><p>Install <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" target="_blank" rel="noopener noreferrer">kubectl</a>.</p></blockquote><ol><li><p>Open a web browser, navigate to <a href="https://github.com/rancher/rancher/blob/master/cleanup/user-cluster.sh" target="_blank" rel="noopener noreferrer">GitHub</a>, and download <code>user-cluster.sh</code>.</p></li><li><p>Make the script executable by running the following command from the same directory as <code>user-cluster.sh</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">chmod +x user-cluster.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p><strong>Air Gap Environments Only:</strong> Open <code>user-cluster.sh</code> and replace <code>yaml_url</code> with the URL in <code>user-cluster.yml</code>.</p><p>If you don&#x27;t have an air gap environment, skip this step.</p></li><li><p>From the same directory, run the script and provide the <code>rancher/rancher-agent</code> image version which should be equal to the version of Rancher used to manage the cluster. (<code>&lt;RANCHER_VERSION&gt;</code>):</p><blockquote><p><strong>Tip:</strong></p><p>Add the <code>-dry-run</code> flag to preview the script&#x27;s outcome without making changes.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./user-cluster.sh rancher/rancher-agent:&lt;RANCHER_VERSION&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote></li></ol><p><strong>Result:</strong> The script runs. All components listed for registered clusters in <a href="#what-gets-removed">What Gets Removed?</a> are deleted.</p></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="windows-nodes">Windows Nodes<a class="hash-link" href="#windows-nodes" title="Direct link to heading">​</a></h3><p>To clean up a Windows node, you can run a cleanup script located in <code>c:\etc\rancher</code>. The script deletes Kubernetes generated resources and the execution binary. It also drops the firewall rules and network settings.</p><p>To run the script, you can use this command in the PowerShell:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">pushd c:\etc\rancher</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">.\cleanup.ps1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">popd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Result:</strong> The node is reset and can be re-added to a Kubernetes cluster.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-containers-images-and-volumes">Docker Containers, Images, and Volumes<a class="hash-link" href="#docker-containers-images-and-volumes" title="Direct link to heading">​</a></h3><p>Based on what role you assigned to the node, there are Kubernetes components in containers, containers belonging to overlay networking, DNS, ingress controller and Rancher agent. (and pods you created that have been scheduled to this node)</p><p><strong>To clean all Docker containers, images and volumes:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker rm -f $(docker ps -qa)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker rmi -f $(docker images -q)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker volume rm $(docker volume ls -q)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mounts">Mounts<a class="hash-link" href="#mounts" title="Direct link to heading">​</a></h3><p>Kubernetes components and secrets leave behind mounts on the system that need to be unmounted.</p><table><thead><tr><th>Mounts</th></tr></thead><tbody><tr><td><code>/var/lib/kubelet/pods/XXX</code> (miscellaneous mounts)</td></tr><tr><td><code>/var/lib/kubelet</code></td></tr><tr><td><code>/var/lib/rancher</code></td></tr></tbody></table><p><strong>To unmount all mounts:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">for mount in $(mount | grep tmpfs | grep &#x27;/var/lib/kubelet&#x27; | awk &#x27;{ print $3 }&#x27;) /var/lib/kubelet /var/lib/rancher; do umount $mount; done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="directories-and-files">Directories and Files<a class="hash-link" href="#directories-and-files" title="Direct link to heading">​</a></h3><p>The following directories are used when adding a node to a cluster, and should be removed. You can remove a directory using <code>rm -rf /directory_name</code>.</p><blockquote><p><strong>Note:</strong> Depending on the role you assigned to the node, some of the directories will or won&#x27;t be present on the node.</p></blockquote><table><thead><tr><th>Directories</th></tr></thead><tbody><tr><td><code>/etc/ceph</code></td></tr><tr><td><code>/etc/cni</code></td></tr><tr><td><code>/etc/kubernetes</code></td></tr><tr><td><code>/opt/cni</code></td></tr><tr><td><code>/opt/rke</code></td></tr><tr><td><code>/run/secrets/kubernetes.io</code></td></tr><tr><td><code>/run/calico</code></td></tr><tr><td><code>/run/flannel</code></td></tr><tr><td><code>/var/lib/calico</code></td></tr><tr><td><code>/var/lib/etcd</code></td></tr><tr><td><code>/var/lib/cni</code></td></tr><tr><td><code>/var/lib/kubelet</code></td></tr><tr><td><code>/var/lib/rancher/rke/log</code></td></tr><tr><td><code>/var/log/containers</code></td></tr><tr><td><code>/var/log/kube-audit</code></td></tr><tr><td><code>/var/log/pods</code></td></tr><tr><td><code>/var/run/calico</code></td></tr></tbody></table><p><strong>To clean the directories:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">rm -rf /etc/ceph \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /etc/cni \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /etc/kubernetes \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /opt/cni \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /opt/rke \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /run/secrets/kubernetes.io \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /run/calico \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /run/flannel \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /var/lib/calico \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /var/lib/etcd \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /var/lib/cni \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /var/lib/kubelet \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /var/lib/rancher/rke/log \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /var/log/containers \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /var/log/kube-audit \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /var/log/pods \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">       /var/run/calico</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-interfaces-and-iptables">Network Interfaces and Iptables<a class="hash-link" href="#network-interfaces-and-iptables" title="Direct link to heading">​</a></h3><p>The remaining two components that are changed/configured are (virtual) network interfaces and iptables rules. Both are non-persistent to the node, meaning that they will be cleared after a restart of the node. To remove these components, a restart is recommended.</p><p><strong>To restart a node:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># using reboot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ sudo reboot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># using shutdown</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ sudo shutdown -r now</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you want to know more on (virtual) network interfaces or iptables rules, please see the specific subjects below.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-interfaces">Network Interfaces<a class="hash-link" href="#network-interfaces" title="Direct link to heading">​</a></h3><blockquote><p><strong>Note:</strong> Depending on the network provider configured for the cluster the node was part of, some of the interfaces will or won&#x27;t be present on the node.</p></blockquote><table><thead><tr><th>Interfaces</th></tr></thead><tbody><tr><td><code>flannel.1</code></td></tr><tr><td><code>cni0</code></td></tr><tr><td><code>tunl0</code></td></tr><tr><td><code>caliXXXXXXXXXXX</code> (random interface names)</td></tr><tr><td><code>vethXXXXXXXX</code> (random interface names)</td></tr></tbody></table><p><strong>To list all interfaces:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Using ip</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip address show</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Using ifconfig</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ifconfig -a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>To remove an interface:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ip link delete interface_name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="iptables">Iptables<a class="hash-link" href="#iptables" title="Direct link to heading">​</a></h3><blockquote><p><strong>Note:</strong> Depending on the network provider configured for the cluster the node was part of, some of the chains will or won&#x27;t be present on the node.</p></blockquote><p>Iptables rules are used to route traffic from and to containers. The created rules are not persistent, so restarting the node will restore iptables to its original state.</p><table><thead><tr><th>Chains</th></tr></thead><tbody><tr><td><code>cali-failsafe-in</code></td></tr><tr><td><code>cali-failsafe-out</code></td></tr><tr><td><code>cali-fip-dnat</code></td></tr><tr><td><code>cali-fip-snat</code></td></tr><tr><td><code>cali-from-hep-forward</code></td></tr><tr><td><code>cali-from-host-endpoint</code></td></tr><tr><td><code>cali-from-wl-dispatch</code></td></tr><tr><td><code>cali-fw-caliXXXXXXXXXXX</code> (random chain names)</td></tr><tr><td><code>cali-nat-outgoing</code></td></tr><tr><td><code>cali-pri-kns.NAMESPACE</code> (chain per namespace)</td></tr><tr><td><code>cali-pro-kns.NAMESPACE</code> (chain per namespace)</td></tr><tr><td><code>cali-to-hep-forward</code></td></tr><tr><td><code>cali-to-host-endpoint</code></td></tr><tr><td><code>cali-to-wl-dispatch</code></td></tr><tr><td><code>cali-tw-caliXXXXXXXXXXX</code> (random chain names)</td></tr><tr><td><code>cali-wl-to-host</code></td></tr><tr><td><code>KUBE-EXTERNAL-SERVICES</code></td></tr><tr><td><code>KUBE-FIREWALL</code></td></tr><tr><td><code>KUBE-MARK-DROP</code></td></tr><tr><td><code>KUBE-MARK-MASQ</code></td></tr><tr><td><code>KUBE-NODEPORTS</code></td></tr><tr><td><code>KUBE-SEP-XXXXXXXXXXXXXXXX</code> (random chain names)</td></tr><tr><td><code>KUBE-SERVICES</code></td></tr><tr><td><code>KUBE-SVC-XXXXXXXXXXXXXXXX</code> (random chain names)</td></tr></tbody></table><p><strong>To list all iptables rules:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">iptables -L -t nat</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iptables -L -t mangle</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">iptables -L</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/rancher/rancher-docs/edit/main/versioned_docs/version-2.5/how-to-guides/advanced-user-guides/manage-clusters/clean-cluster-nodes.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-09-10T07:31:45.000Z">9/10/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/v2.5/how-to-guides/advanced-user-guides/manage-clusters/nodes-and-node-pools"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Nodes and Node Pools</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/v2.5/how-to-guides/advanced-user-guides/manage-clusters/add-a-pod-security-policy"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Adding a Pod Security Policy</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-gets-removed" class="table-of-contents__link toc-highlight">What Gets Removed?</a></li><li><a href="#removing-a-node-from-a-cluster-by-rancher-ui" class="table-of-contents__link toc-highlight">Removing a Node from a Cluster by Rancher UI</a></li><li><a href="#removing-rancher-components-from-a-cluster-manually" class="table-of-contents__link toc-highlight">Removing Rancher Components from a Cluster Manually</a><ul><li><a href="#removing-rancher-components-from-registered-clusters" class="table-of-contents__link toc-highlight">Removing Rancher Components from Registered Clusters</a></li><li><a href="#windows-nodes" class="table-of-contents__link toc-highlight">Windows Nodes</a></li><li><a href="#docker-containers-images-and-volumes" class="table-of-contents__link toc-highlight">Docker Containers, Images, and Volumes</a></li><li><a href="#mounts" class="table-of-contents__link toc-highlight">Mounts</a></li><li><a href="#directories-and-files" class="table-of-contents__link toc-highlight">Directories and Files</a></li><li><a href="#network-interfaces-and-iptables" class="table-of-contents__link toc-highlight">Network Interfaces and Iptables</a></li><li><a href="#network-interfaces" class="table-of-contents__link toc-highlight">Network Interfaces</a></li><li><a href="#iptables" class="table-of-contents__link toc-highlight">Iptables</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 SUSE Rancher. All Rights Reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.d2604d48.js"></script>
<script src="/assets/js/main.aa78001f.js"></script>
</body>
</html>
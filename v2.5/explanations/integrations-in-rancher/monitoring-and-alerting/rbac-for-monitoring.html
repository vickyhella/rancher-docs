<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-2.5 plugin-docs plugin-id-default docs-doc-id-explanations/integrations-in-rancher/monitoring-and-alerting/rbac-for-monitoring">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="search" type="application/opensearchdescription+xml" title="Rancher Manager" href="/opensearch.xml"><title data-rh="true">Role-based Access Control | Rancher Manager</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://docs.ranchermanager.rancher.io//v2.5/explanations/integrations-in-rancher/monitoring-and-alerting/rbac-for-monitoring"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="2.5"><meta data-rh="true" name="docusaurus_tag" content="docs-default-2.5"><meta data-rh="true" name="docsearch:version" content="2.5"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-2.5"><meta data-rh="true" property="og:title" content="Role-based Access Control | Rancher Manager"><meta data-rh="true" name="description" content="This section describes the expectations for RBAC for Rancher Monitoring."><meta data-rh="true" property="og:description" content="This section describes the expectations for RBAC for Rancher Monitoring."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="http://docs.ranchermanager.rancher.io//v2.5/explanations/integrations-in-rancher/monitoring-and-alerting/rbac-for-monitoring"><link data-rh="true" rel="alternate" href="http://docs.ranchermanager.rancher.io//v2.5/explanations/integrations-in-rancher/monitoring-and-alerting/rbac-for-monitoring" hreflang="en"><link data-rh="true" rel="alternate" href="http://docs.ranchermanager.rancher.io//v2.5/explanations/integrations-in-rancher/monitoring-and-alerting/rbac-for-monitoring" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://30NEY6C9UY-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.31d3122a.css">
<link rel="preload" href="/assets/js/runtime~main.d2604d48.js" as="script">
<link rel="preload" href="/assets/js/main.aa78001f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/v2.5">v2.5</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/explanations/integrations-in-rancher/monitoring-and-alerting/rbac-for-monitoring">v2.6</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/v2.5/explanations/integrations-in-rancher/monitoring-and-alerting/rbac-for-monitoring">v2.5</a></li><li><a class="dropdown__link" href="/v2.0-v2.4">v2.0-v2.4</a></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__docs navbar__link--active" href="/v2.5">Docs</a><a href="https://github.com/rancher/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__github btn btn-secondary icon-github">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v2.5">Rancher 2.5</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/getting-started">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/how-to-guides">How-to Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;How-to Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/reference-guides">Reference Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reference Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/v2.5/explanations">Explanations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Explanations&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/v2.5/pages-for-subheaders/integrations-in-rancher">Integrations in Rancher</a><button aria-label="Toggle the collapsible sidebar category &#x27;Integrations in Rancher&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/cis-scans">CIS Scans</a><button aria-label="Toggle the collapsible sidebar category &#x27;CIS Scans&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/fleet-gitops-at-scale">Fleet - GitOps at Scale</a><button aria-label="Toggle the collapsible sidebar category &#x27;Fleet - GitOps at Scale&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/istio">Istio</a><button aria-label="Toggle the collapsible sidebar category &#x27;Istio&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/explanations/integrations-in-rancher/longhorn">Longhorn - Cloud native distributed block storage for Kubernetes</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/logging">Logging</a><button aria-label="Toggle the collapsible sidebar category &#x27;Logging&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/v2.5/pages-for-subheaders/monitoring-and-alerting">Monitoring and Alerting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Monitoring and Alerting&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/explanations/integrations-in-rancher/monitoring-and-alerting/how-monitoring-works">How Monitoring Works</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/v2.5/explanations/integrations-in-rancher/monitoring-and-alerting/rbac-for-monitoring">Role-based Access Control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/explanations/integrations-in-rancher/monitoring-and-alerting/built-in-dashboards">Built-in Dashboards</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/explanations/integrations-in-rancher/monitoring-and-alerting/windows-support">Windows Cluster Support for Monitoring V2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/explanations/integrations-in-rancher/monitoring-and-alerting/promql-expressions">PromQL Expression Reference</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/explanations/integrations-in-rancher/opa-gatekeeper">OPA Gatekeeper</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/faq">FAQ</a><button aria-label="Toggle the collapsible sidebar category &#x27;FAQ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/troubleshooting">Troubleshooting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Troubleshooting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v2.5/contribute-to-rancher">Contributing to Rancher</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Rancher Manager<!-- --> <b>v2.5</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/explanations/integrations-in-rancher/monitoring-and-alerting/rbac-for-monitoring">latest version</a></b> (<!-- -->v2.6<!-- -->).</div></div><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.5/explanations"><span itemprop="name">Explanations</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.5/pages-for-subheaders/integrations-in-rancher"><span itemprop="name">Integrations in Rancher</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.5/pages-for-subheaders/monitoring-and-alerting"><span itemprop="name">Monitoring and Alerting</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Role-based Access Control</span><meta itemprop="position" content="4"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v2.5</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Role-based Access Control</h1></header><p>This section describes the expectations for RBAC for Rancher Monitoring.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cluster-admins">Cluster Admins<a class="hash-link" href="#cluster-admins" title="Direct link to heading">​</a></h2><p>By default, only those with the cluster-admin <code>ClusterRole</code> should be able to:</p><ul><li>Install the <code>rancher-monitoring</code> App onto a cluster and all other relevant configuration performed on the chart deploy<ul><li>e.g. whether default dashboards are created, what exporters are deployed onto the cluster to collect metrics, etc.</li></ul></li><li>Create / modify / delete Prometheus deployments in the cluster via Prometheus CRs</li><li>Create / modify / delete Alertmanager deployments in the cluster via Alertmanager CRs</li><li>Persist new Grafana dashboards or datasources via creating ConfigMaps in the appropriate namespace</li><li>Expose certain Prometheus metrics to the k8s Custom Metrics API for HPA via a Secret in the <code>cattle-monitoring-system</code> namespace</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="users-with-kubernetes-clusterrole-based-permissions">Users with Kubernetes ClusterRole-based Permissions<a class="hash-link" href="#users-with-kubernetes-clusterrole-based-permissions" title="Direct link to heading">​</a></h2><p>The <code>rancher-monitoring</code> chart installs the following three <code>ClusterRoles</code>. By default, they aggregate into the corresponding k8s <code>ClusterRoles</code>:</p><table><thead><tr><th>ClusterRole</th><th>Aggregates To Default K8s ClusterRole</th></tr></thead><tbody><tr><td><code>monitoring-admin</code></td><td><code>admin</code></td></tr><tr><td><code>monitoring-edit</code></td><td><code>edit</code></td></tr><tr><td><code>monitoring-view</code></td><td><code>view </code></td></tr></tbody></table><p>These <code>ClusterRoles</code> provide different levels of access to the Monitoring CRDs based on the actions that can be performed:</p><table><thead><tr><th>CRDs (monitoring.coreos.com)</th><th>Admin</th><th>Edit</th><th>View</th></tr></thead><tbody><tr><td><ul><li><code>prometheuses</code></li><li><code>alertmanagers</code></li></ul></td><td>Get, List, Watch</td><td>Get, List, Watch</td><td>Get, List, Watch</td></tr><tr><td><ul><li><code>servicemonitors</code></li><li><code>podmonitors</code></li><li><code>prometheusrules</code></li></ul></td><td>*</td><td>*</td><td>Get, List, Watch</td></tr></tbody></table><p>On a high level, the following permissions are assigned by default as a result.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="users-with-kubernetes-adminedit-permissions">Users with Kubernetes Admin/Edit Permissions<a class="hash-link" href="#users-with-kubernetes-adminedit-permissions" title="Direct link to heading">​</a></h3><p>Only those with the the cluster-admin, admin or edit <code>ClusterRole</code> should be able to:</p><ul><li>Modify the scrape configuration of Prometheus deployments via ServiceMonitor and PodMonitor CRs</li><li>Modify the alerting / recording rules of a Prometheus deployment via PrometheusRules CRs</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="users-with-kubernetes-view-permissions">Users with Kubernetes View Permissions<a class="hash-link" href="#users-with-kubernetes-view-permissions" title="Direct link to heading">​</a></h3><p>Only those with who have some Kubernetes <code>ClusterRole</code> should be able to:</p><ul><li>View the configuration of Prometheuses that are deployed within the cluster</li><li>View the configuration of Alertmanagers that are deployed within the cluster</li><li>View the scrape configuration of Prometheus deployments via ServiceMonitor and PodMonitor CRs</li><li>View the alerting/recording rules of a Prometheus deployment via PrometheusRules CRs</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="additional-monitoring-roles">Additional Monitoring Roles<a class="hash-link" href="#additional-monitoring-roles" title="Direct link to heading">​</a></h3><p>Monitoring also creates additional <code>Roles</code> that are not assigned to users by default but are created within the cluster. They can be bound to a namespace by deploying a <code>RoleBinding</code> that references it. To define a <code>RoleBinding</code> with <code>kubectl</code> instead of through Rancher, click <a href="#assigning-roles-and-clusterroles-with-kubectl">here</a>.</p><p>Admins should use these roles to provide more fine-grained access to users:</p><table><thead><tr><th>Role</th><th>Purpose</th></tr></thead><tbody><tr><td>monitoring-config-admin</td><td>Allow admins to assign roles to users to be able to view / modify Secrets and ConfigMaps within the cattle-monitoring-system namespace. Modifying Secrets / ConfigMaps in this namespace could allow users to alter the cluster&#x27;s Alertmanager configuration, Prometheus Adapter configuration, additional Grafana datasources, TLS secrets, etc.</td></tr><tr><td>monitoring-config-edit</td><td>Allow admins to assign roles to users to be able to view / modify Secrets and ConfigMaps within the cattle-monitoring-system namespace. Modifying Secrets / ConfigMaps in this namespace could allow users to alter the cluster&#x27;s Alertmanager configuration, Prometheus Adapter configuration, additional Grafana datasources, TLS secrets, etc.</td></tr><tr><td>monitoring-config-view</td><td>Allow admins to assign roles to users to be able to view Secrets and ConfigMaps within the cattle-monitoring-system namespace. Viewing Secrets / ConfigMaps in this namespace could allow users to observe the cluster&#x27;s Alertmanager configuration, Prometheus Adapter configuration, additional Grafana datasources, TLS secrets, etc.</td></tr><tr><td>monitoring-dashboard-admin</td><td>Allow admins to assign roles to users to be able to edit / view ConfigMaps within the cattle-dashboards namespace. ConfigMaps in this namespace will correspond to Grafana Dashboards that are persisted onto the cluster.</td></tr><tr><td>monitoring-dashboard-edit</td><td>Allow admins to assign roles to users to be able to edit / view ConfigMaps within the cattle-dashboards namespace. ConfigMaps in this namespace will correspond to Grafana Dashboards that are persisted onto the cluster.</td></tr><tr><td>monitoring-dashboard-view</td><td>Allow admins to assign roles to users to be able to view ConfigMaps within the cattle-dashboards namespace. ConfigMaps in this namespace will correspond to Grafana Dashboards that are persisted onto the cluster.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="additional-monitoring-clusterroles">Additional Monitoring ClusterRoles<a class="hash-link" href="#additional-monitoring-clusterroles" title="Direct link to heading">​</a></h3><p>Monitoring also creates additional <code>ClusterRoles</code> that are not assigned to users by default but are created within the cluster.  They are not aggregated by default but can be bound to a namespace by deploying a <code>RoleBinding</code> or <code>ClusterRoleBinding</code> that references it. To define a <code>RoleBinding</code> with <code>kubectl</code> instead of through Rancher, click <a href="#assigning-roles-and-clusterroles-with-kubectl">here</a>.</p><table><thead><tr><th>Role</th><th>Purpose</th></tr></thead><tbody><tr><td>monitoring-ui-view</td><td><a id="monitoring-ui-view"></a><em>Available as of Monitoring v2 14.5.100+</em> Provides read-only access to external Monitoring UIs by giving a user permission to list the Prometheus, Alertmanager, and Grafana endpoints and make GET requests to Prometheus, Grafana, and Alertmanager UIs through the Rancher proxy.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="assigning-roles-and-clusterroles-with-kubectl">Assigning Roles and ClusterRoles with kubectl<a class="hash-link" href="#assigning-roles-and-clusterroles-with-kubectl" title="Direct link to heading">​</a></h3><p>An alternative method to using Rancher to attach a <code>Role</code> or <code>ClusterRole</code> to a user or group is by defining bindings in YAML files that you create. You must first configure the <code>RoleBinding</code> with the YAML file, then you apply the config changes by running the <code>kubectl apply</code> command. </p><ul><li><strong>Roles</strong>: Below is an example of a YAML file to help you configure <code>RoleBindings</code> in Kubernetes to attach to a user. You will need to fill in the name below, and name is case-sensitive. </li></ul><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># monitoring-config-view-role-binding.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rbac.authorization.k8s.io/v1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> RoleBinding</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> monitoring</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">view</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> cattle</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">monitoring</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">system</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">roleRef</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Role</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> monitoring</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">view</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">apiGroup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rbac.authorization.k8s.io</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">subjects</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> User</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> u</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">b4qkhsnliz </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># this can be found via `kubectl get users -A`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">apiGroup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rbac.authorization.k8s.io</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p><strong>kubectl</strong>: Below is an example of a <code>kubectl</code> command used to apply the binding you&#x27;ve created in the YAML file. As noted, you will need to fill in your YAML filename accordingly.</p><ul><li>**<code>kubectl apply -f monitoring-config-view-role-binding.yaml</code></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="users-with-rancher-cluster-manager-based-permissions">Users with Rancher Cluster Manager Based Permissions<a class="hash-link" href="#users-with-rancher-cluster-manager-based-permissions" title="Direct link to heading">​</a></h2><p>The relationship between the default roles deployed by Rancher Cluster Manager (i.e. cluster-owner, cluster-member, project-owner, project-member), the default k8s roles, and the roles deployed by the rancher-monitoring chart are detailed in the table below:</p><figcaption>Default Rancher Permissions and Corresponding Kubernetes ClusterRoles</figcaption><table><thead><tr><th>Cluster Manager Role</th><th>k8s Role</th><th>Monitoring ClusterRole / Role</th><th>ClusterRoleBinding or RoleBinding?</th></tr></thead><tbody><tr><td>cluster-owner</td><td>cluster-admin</td><td>N/A</td><td>ClusterRoleBinding</td></tr><tr><td>cluster-member</td><td>admin</td><td>monitoring-admin</td><td>ClusterRoleBinding</td></tr><tr><td>project-owner</td><td>admin</td><td>monitoring-admin</td><td>RoleBinding within Project namespace</td></tr><tr><td>project-member</td><td>edit</td><td>monitoring-edit</td><td>RoleBinding within Project namespace</td></tr></tbody></table><p>In addition to these default Roles, the following additional Rancher project roles can be applied to members of your Cluster to provide additional access to Monitoring. These Rancher Roles will be tied to ClusterRoles deployed by the Monitoring chart:</p><figcaption>Non-default Rancher Permissions and Corresponding Kubernetes ClusterRoles</figcaption><table><thead><tr><th>Cluster Manager Role</th><th>Kubernetes ClusterRole</th><th>Available In Rancher From</th><th>Available in Monitoring v2 From</th></tr></thead><tbody><tr><td>View Monitoring*</td><td><a href="#monitoring-ui-view">monitoring-ui-view</a></td><td>2.4.8+</td><td>9.4.204+</td></tr></tbody></table><p>*<!-- --> A User bound to the <strong>View Monitoring</strong> Rancher Role only has permissions to access external Monitoring UIs if provided links to those UIs. In order to access the Monitoring Pane on Cluster Explorer to get those links, the User must be a Project Member of at least one Project.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="differences-in-25x">Differences in 2.5.x<a class="hash-link" href="#differences-in-25x" title="Direct link to heading">​</a></h3><p>Users with the project-member or project-owners roles assigned will not be given access to either Prometheus or Grafana in Rancher 2.5.x since we only create Grafana or Prometheus on a cluster-level.</p><p>In addition, while project owners will still be only able to add ServiceMonitors / PodMonitors that scrape resources within their project&#x27;s namespace by default, PrometheusRules are not scoped to a single namespace / project. Therefore, any alert rules or recording rules created by project-owners within their project namespace will be applied across the entire cluster, although they will be unable to view / edit / delete any rules that were created outside the project&#x27;s namespace.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="assigning-additional-access">Assigning Additional Access<a class="hash-link" href="#assigning-additional-access" title="Direct link to heading">​</a></h3><p>If cluster-admins would like to provide additional admin/edit access to users outside of the roles offered by the rancher-monitoring chart, the following table identifies the potential impact:</p><table><thead><tr><th>CRDs (monitoring.coreos.com)</th><th>Can it cause impact outside of a namespace / project?</th><th>Impact</th></tr></thead><tbody><tr><td><code>prometheuses</code></td><td>Yes, this resource can scrape metrics from any targets across the entire cluster (unless the Operator itself is otherwise configured).</td><td>User will be able to define the configuration of new cluster-level Prometheus deployments that should be created in the cluster.</td></tr><tr><td><code>alertmanagers</code></td><td>No</td><td>User will be able to define the configuration of new cluster-level Alertmanager deployments that should be created in the cluster. Note: if you just want to allow users to configure settings like Routes and Receivers, you should just provide access to the Alertmanager Config Secret instead.</td></tr><tr><td><ul><li><code>servicemonitors</code></li><li><code>podmonitors</code></li></ul></td><td>No, not by default; this is configurable via <code>ignoreNamespaceSelectors</code> on the Prometheus CR.</td><td>User will be able to set up scrapes by Prometheus on endpoints exposed by Services / Pods within the namespace they are given this permission in.</td></tr><tr><td><code>prometheusrules</code></td><td>Yes, PrometheusRules are cluster-scoped.</td><td>User will be able to define alert or recording rules on Prometheus based on any series collected across the entire cluster.</td></tr></tbody></table><table><thead><tr><th>k8s Resources</th><th>Namespace</th><th>Can it cause impact outside of a namespace / project?</th><th>Impact</th></tr></thead><tbody><tr><td><ul><li><code>secrets</code></li><li><code>configmaps</code></li></ul></td><td><code>cattle-monitoring-system</code></td><td>Yes, Configs and Secrets in this namespace can impact the entire monitoring / alerting pipeline.</td><td>User will be able to create or edit Secrets / ConfigMaps such as the Alertmanager Config, Prometheus Adapter Config, TLS secrets, additional Grafana datasources, etc. This can have broad impact on all cluster monitoring / alerting.</td></tr><tr><td><ul><li><code>secrets</code></li><li><code>configmaps</code></li></ul></td><td><code>cattle-dashboards</code></td><td>Yes, Configs and Secrets in this namespace can create dashboards that make queries on all metrics collected at a cluster-level.</td><td>User will be able to create Secrets / ConfigMaps that persist new Grafana Dashboards only.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="role-based-access-control-for-grafana">Role-based Access Control for Grafana<a class="hash-link" href="#role-based-access-control-for-grafana" title="Direct link to heading">​</a></h2><p>Rancher allows any users who are authenticated by Kubernetes and have access the Grafana service deployed by the Rancher Monitoring chart to access Grafana via the Rancher Dashboard UI. By default, all users who are able to access Grafana are given the <a href="https://grafana.com/docs/grafana/latest/permissions/organization_roles/#viewer-role" target="_blank" rel="noopener noreferrer">Viewer</a> role, which allows them to view any of the default dashboards deployed by Rancher.</p><p>However, users can choose to log in to Grafana as an <a href="https://grafana.com/docs/grafana/latest/permissions/organization_roles/#admin-role" target="_blank" rel="noopener noreferrer">Admin</a> if necessary. The default Admin username and password for the Grafana instance will be <code>admin</code>/<code>prom-operator</code>, but alternative credentials can also be supplied on deploying or upgrading the chart.</p><p>To see the Grafana UI, install <code>rancher-monitoring</code>. Then go to the <strong>Cluster Explorer.</strong> In the top left corner, click <strong>Cluster Explorer &gt; Monitoring.</strong> Then click **Grafana.</p><figcaption>Cluster Compute Resources Dashboard in Grafana</figcaption>![Cluster Compute Resources Dashboard in Grafana](/img/cluster-compute-resources-dashboard.png)<figcaption>Default Dashboards in Grafana</figcaption>![Default Dashboards in Grafana](/img/grafana-default-dashboard.png)</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/rancher/rancher-docs/edit/main/versioned_docs/version-2.5/explanations/integrations-in-rancher/monitoring-and-alerting/rbac-for-monitoring.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-09-10T07:31:45.000Z">9/10/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/v2.5/explanations/integrations-in-rancher/monitoring-and-alerting/how-monitoring-works"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">How Monitoring Works</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/v2.5/explanations/integrations-in-rancher/monitoring-and-alerting/built-in-dashboards"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Built-in Dashboards</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#cluster-admins" class="table-of-contents__link toc-highlight">Cluster Admins</a></li><li><a href="#users-with-kubernetes-clusterrole-based-permissions" class="table-of-contents__link toc-highlight">Users with Kubernetes ClusterRole-based Permissions</a><ul><li><a href="#users-with-kubernetes-adminedit-permissions" class="table-of-contents__link toc-highlight">Users with Kubernetes Admin/Edit Permissions</a></li><li><a href="#users-with-kubernetes-view-permissions" class="table-of-contents__link toc-highlight">Users with Kubernetes View Permissions</a></li><li><a href="#additional-monitoring-roles" class="table-of-contents__link toc-highlight">Additional Monitoring Roles</a></li><li><a href="#additional-monitoring-clusterroles" class="table-of-contents__link toc-highlight">Additional Monitoring ClusterRoles</a></li><li><a href="#assigning-roles-and-clusterroles-with-kubectl" class="table-of-contents__link toc-highlight">Assigning Roles and ClusterRoles with kubectl</a></li></ul></li><li><a href="#users-with-rancher-cluster-manager-based-permissions" class="table-of-contents__link toc-highlight">Users with Rancher Cluster Manager Based Permissions</a><ul><li><a href="#differences-in-25x" class="table-of-contents__link toc-highlight">Differences in 2.5.x</a></li><li><a href="#assigning-additional-access" class="table-of-contents__link toc-highlight">Assigning Additional Access</a></li></ul></li><li><a href="#role-based-access-control-for-grafana" class="table-of-contents__link toc-highlight">Role-based Access Control for Grafana</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 SUSE Rancher. All Rights Reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.d2604d48.js"></script>
<script src="/assets/js/main.aa78001f.js"></script>
</body>
</html>
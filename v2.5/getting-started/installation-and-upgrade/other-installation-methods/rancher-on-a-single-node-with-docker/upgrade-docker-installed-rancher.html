<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-2.5 plugin-docs plugin-id-default docs-doc-id-getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/upgrade-docker-installed-rancher">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="search" type="application/opensearchdescription+xml" title="Rancher Manager" href="/opensearch.xml"><title data-rh="true">Upgrading Rancher Installed with Docker | Rancher Manager</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://docs.ranchermanager.rancher.io//v2.5/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/upgrade-docker-installed-rancher"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="2.5"><meta data-rh="true" name="docusaurus_tag" content="docs-default-2.5"><meta data-rh="true" name="docsearch:version" content="2.5"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-2.5"><meta data-rh="true" property="og:title" content="Upgrading Rancher Installed with Docker | Rancher Manager"><meta data-rh="true" name="description" content="The following instructions will guide you through upgrading a Rancher server that was installed with Docker."><meta data-rh="true" property="og:description" content="The following instructions will guide you through upgrading a Rancher server that was installed with Docker."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="http://docs.ranchermanager.rancher.io//v2.5/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/upgrade-docker-installed-rancher"><link data-rh="true" rel="alternate" href="http://docs.ranchermanager.rancher.io//v2.5/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/upgrade-docker-installed-rancher" hreflang="en"><link data-rh="true" rel="alternate" href="http://docs.ranchermanager.rancher.io//v2.5/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/upgrade-docker-installed-rancher" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://30NEY6C9UY-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.9543bcfd.css">
<link rel="preload" href="/assets/js/runtime~main.217a7f9f.js" as="script">
<link rel="preload" href="/assets/js/main.00d8b9dc.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/v2.5">v2.5</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/upgrade-docker-installed-rancher">v2.6</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/v2.5/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/upgrade-docker-installed-rancher">v2.5</a></li><li><a class="dropdown__link" href="/v2.0-v2.4/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/upgrade-docker-installed-rancher">v2.0-v2.4</a></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__docs navbar__link--active" href="/v2.5">Docs</a><a href="https://github.com/rancher/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__github btn btn-secondary icon-github">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v2.5">Rancher 2.5</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/v2.5/getting-started">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/introduction">Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/quick-start-guides">Quick Start Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Quick Start Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/v2.5/pages-for-subheaders/installation-and-upgrade">Installation and Upgrade</a><button aria-label="Toggle the collapsible sidebar category &#x27;Installation and Upgrade&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/installation-requirements">Installation Requirements</a><button aria-label="Toggle the collapsible sidebar category &#x27;Installation Requirements&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/install-upgrade-on-a-kubernetes-cluster">Install/Upgrade on a Kubernetes Cluster</a><button aria-label="Toggle the collapsible sidebar category &#x27;Install/Upgrade on a Kubernetes Cluster&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/v2.5/pages-for-subheaders/other-installation-methods">Other Installation Methods</a><button aria-label="Toggle the collapsible sidebar category &#x27;Other Installation Methods&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/air-gapped-helm-cli-install">Air-Gapped Helm CLI Install</a><button aria-label="Toggle the collapsible sidebar category &#x27;Air-Gapped Helm CLI Install&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/v2.5/pages-for-subheaders/rancher-on-a-single-node-with-docker">Rancher on a Single Node with Docker</a><button aria-label="Toggle the collapsible sidebar category &#x27;Rancher on a Single Node with Docker&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/v2.5/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/upgrade-docker-installed-rancher">Upgrading Rancher Installed with Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/roll-back-docker-installed-rancher">Rolling Back Rancher Installed with Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/certificate-troubleshooting">Certificate Troubleshooting</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/rancher-behind-an-http-proxy">Rancher Behind an HTTP Proxy</a><button aria-label="Toggle the collapsible sidebar category &#x27;Rancher Behind an HTTP Proxy&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/install-rancher-on-linux">Install/Upgrade Rancher with RancherD</a><button aria-label="Toggle the collapsible sidebar category &#x27;Install/Upgrade Rancher with RancherD&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/resources">Resources</a><button aria-label="Toggle the collapsible sidebar category &#x27;Resources&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/getting-started/installation-and-upgrade/upgrade-and-roll-back-kubernetes">Upgrading and Rolling Back Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/getting-started/installation-and-upgrade/upgrade-kubernetes-without-upgrading-rancher">Upgrading Kubernetes without Upgrading Rancher</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/pages-for-subheaders/advanced-options">Advanced Options</a><button aria-label="Toggle the collapsible sidebar category &#x27;Advanced Options&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/how-to-guides">How-to Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;How-to Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/reference-guides">Reference Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reference Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/explanations">Explanations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Explanations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/faq">FAQ</a><button aria-label="Toggle the collapsible sidebar category &#x27;FAQ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/troubleshooting">Troubleshooting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Troubleshooting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v2.5/contribute-to-rancher">Contributing to Rancher</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Rancher Manager<!-- --> <b>v2.5</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/upgrade-docker-installed-rancher">latest version</a></b> (<!-- -->v2.6<!-- -->).</div></div><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.5/getting-started"><span itemprop="name">Getting Started</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.5/pages-for-subheaders/installation-and-upgrade"><span itemprop="name">Installation and Upgrade</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.5/pages-for-subheaders/other-installation-methods"><span itemprop="name">Other Installation Methods</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.5/pages-for-subheaders/rancher-on-a-single-node-with-docker"><span itemprop="name">Rancher on a Single Node with Docker</span></a><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Upgrading Rancher Installed with Docker</span><meta itemprop="position" content="5"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v2.5</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Upgrading Rancher Installed with Docker</h1></header><p>The following instructions will guide you through upgrading a Rancher server that was installed with Docker.</p><h1>Prerequisites</h1><ul><li>**Review the <a href="/v2.5/getting-started/installation-and-upgrade/install-upgrade-on-a-kubernetes-cluster/upgrades#known-upgrade-issues">known upgrade issues</a> in the Rancher documentation for the most noteworthy issues to consider when upgrading Rancher. A more complete list of known issues for each Rancher version can be found in the release notes on <a href="https://github.com/rancher/rancher/releases" target="_blank" rel="noopener noreferrer">GitHub</a> and on the <a href="https://forums.rancher.com/c/announcements/12" target="_blank" rel="noopener noreferrer">Rancher forums.</a> Note that upgrades to or from any chart in the <a href="/v2.5/reference-guides/installation-references/helm-chart-options#helm-chart-repositories/">rancher-alpha repository</a> aren’t supported.</li><li><strong>For <a href="/v2.5/pages-for-subheaders/air-gapped-helm-cli-install">air gap installs only,</a> collect and populate images for the new Rancher server version.</strong> Follow the guide to <a href="/v2.5/getting-started/installation-and-upgrade/other-installation-methods/air-gapped-helm-cli-install/publish-images">populate your private registry</a> with the images for the Rancher version that you want to upgrade to.</li></ul><h1>Placeholder Review</h1><p>During upgrade, you&#x27;ll enter a series of commands, filling placeholders with data from your environment. These placeholders are denoted with angled brackets and all capital letters (<code>&lt;EXAMPLE&gt;</code>).</p><p>Here&#x27;s an <strong>example</strong> of a command with a placeholder:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker stop &lt;RANCHER_CONTAINER_NAME&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In this command, <code>&lt;RANCHER_CONTAINER_NAME&gt;</code> is the name of your Rancher container.</p><h1>Get Data for Upgrade Commands</h1><p>To obtain the data to replace the placeholders, run:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker ps</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Write down or copy this information before starting the upgrade.</p><sup>Terminal <code>docker ps</code> Command, Displaying Where to Find <code>&lt;RANCHER_CONTAINER_TAG&gt;</code> and <code>&lt;RANCHER_CONTAINER_NAME&gt;</code></sup><p><img loading="lazy" alt="Placeholder Reference" src="/assets/images/placeholder-ref-70c9571e1a85164291c80a55c7c614b5.png" width="1275" height="258" class="img_ev3q"></p><table><thead><tr><th>Placeholder</th><th>Example</th><th>Description</th></tr></thead><tbody><tr><td><code>&lt;RANCHER_CONTAINER_TAG&gt;</code></td><td><code>v2.1.3</code></td><td>The rancher/rancher image you pulled for initial install.</td></tr><tr><td><code>&lt;RANCHER_CONTAINER_NAME&gt;</code></td><td><code>festive_mestorf</code></td><td>The name of your Rancher container.</td></tr><tr><td><code>&lt;RANCHER_VERSION&gt;</code></td><td><code>v2.1.3</code></td><td>The version of Rancher that you&#x27;re creating a backup for.</td></tr><tr><td><code>&lt;DATE&gt;</code></td><td><code>2018-12-19</code></td><td>The date that the data container or backup was created.</td></tr></tbody></table><br><p>You can obtain <code>&lt;RANCHER_CONTAINER_TAG&gt;</code> and <code>&lt;RANCHER_CONTAINER_NAME&gt;</code> by logging into your Rancher server by remote connection and entering the command to view the containers that are running: <code>docker ps</code>. You can also view containers that are stopped using a different command: <code>docker ps -a</code>. Use these commands for help anytime during while creating backups.</p><h1>Upgrade Outline</h1><p>During upgrade, you create a copy of the data from your current Rancher container and a backup in case something goes wrong. Then you deploy the new version of Rancher in a new container using your existing data. Follow the steps to upgrade Rancher server:</p><ul><li><a href="#1-create-a-copy-of-the-data-from-your-rancher-server-container">1. Create a copy of the data from your Rancher server container</a></li><li><a href="#2-create-a-backup-tarball">2. Create a backup tarball</a></li><li><a href="#3-pull-the-new-docker-image">3. Pull the new Docker image</a></li><li><a href="#4-start-the-new-rancher-server-container">4. Start the new Rancher server container</a></li><li><a href="#5-verify-the-upgrade">5. Verify the Upgrade</a></li><li><a href="#6-clean-up-your-old-rancher-server-container">6. Clean up your old Rancher server container</a></li></ul><h1>1. Create a copy of the data from your Rancher server container</h1><ol><li><p>Using a remote Terminal connection, log into the node running your Rancher server.</p></li><li><p>Stop the container currently running Rancher server. Replace <code>&lt;RANCHER_CONTAINER_NAME&gt;</code> with the name of your Rancher container.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker stop &lt;RANCHER_CONTAINER_NAME&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><a id="backup"></a>Use the command below, replacing each placeholder, to create a data container from the Rancher container that you just stopped.<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker create --volumes-from &lt;RANCHER_CONTAINER_NAME&gt; --name rancher-data rancher/rancher:&lt;RANCHER_CONTAINER_TAG&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><h1>2. Create a backup tarball</h1><ol><li><a id="tarball"></a>From the data container that you just created (<code>rancher-data</code>), create a backup tarball (<code>rancher-data-backup-&lt;RANCHER_VERSION&gt;-&lt;DATE&gt;.tar.gz</code>).<p>This tarball will serve as a rollback point if something goes wrong during upgrade. Use the following command, replacing each placeholder.</p></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --volumes-from rancher-data -v &quot;$PWD:/backup&quot; --rm busybox tar zcvf /backup/rancher-data-backup-&lt;RANCHER_VERSION&gt;-&lt;DATE&gt;.tar.gz /var/lib/rancher</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">**Step Result:** When you enter this command, a series of commands should run.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li><p>Enter the <code>ls</code> command to confirm that the backup tarball was created. It will have a name similar to <code>rancher-data-backup-&lt;RANCHER_VERSION&gt;-&lt;DATE&gt;.tar.gz</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[rancher@ip-10-0-0-50 ~]$ ls</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rancher-data-backup-v2.1.3-20181219.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Move your backup tarball to a safe location external from your Rancher server.</p></li></ol><h1>3. Pull the New Docker Image</h1><p>Pull the image of the Rancher version that you want to upgrade to.</p><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>&lt;RANCHER_VERSION_TAG&gt;</code></td><td>The release tag of the <a href="/v2.5/reference-guides/installation-references/helm-chart-options">Rancher version</a> that you want to upgrade to.</td></tr></tbody></table><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker pull rancher/rancher:&lt;RANCHER_VERSION_TAG&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>4. Start the New Rancher Server Container</h1><p>Start a new Rancher server container using the data from the <code>rancher-data</code> container. Remember to pass in all the environment variables that you had used when you started the original container.</p><blockquote><p><strong>Important:</strong> <em>Do not</em> stop the upgrade after initiating it, even if the upgrade process seems longer than expected. Stopping the upgrade may result in database migration errors during future upgrades.</p></blockquote><p>If you used a proxy, see <a href="/v2.5/reference-guides/single-node-rancher-in-docker/http-proxy-configuration">HTTP Proxy Configuration.</a></p><p>If you configured a custom CA root certificate to access your services, see <a href="/v2.5/reference-guides/single-node-rancher-in-docker/advanced-options#custom-ca-certificate">Custom CA root certificate.</a></p><p>If you are recording all transactions with the Rancher API, see <a href="/v2.5/reference-guides/single-node-rancher-in-docker/advanced-options#api-audit-log">API Auditing</a></p><p>To see the command to use when starting the new Rancher server container, choose from the following options:</p><ul><li>Docker Upgrade</li><li>Docker Upgrade for Air Gap Installs</li></ul><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Docker Upgrade</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Docker Air Gap Upgrade</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>Select which option you had installed Rancher server</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-a-default-self-signed-certificate">Option A: Default Self-Signed Certificate<a class="hash-link" href="#option-a-default-self-signed-certificate" title="Direct link to heading">​</a></h3><details id="option-a" class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Click to expand</summary><div><div class="collapsibleContent_i85q"><p>If you have selected to use the Rancher generated self-signed certificate, you add the <code>--volumes-from rancher-data</code> to the command that you had started your original Rancher server container.</p><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>&lt;RANCHER_VERSION_TAG&gt;</code></td><td>The release tag of the <a href="/v2.5/reference-guides/installation-references/helm-chart-options">Rancher version</a> that you want to upgrade to.</td></tr></tbody></table><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --volumes-from rancher-data \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --restart=unless-stopped \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p 80:80 -p 443:443 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --privileged \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  rancher/rancher:&lt;RANCHER_VERSION_TAG&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As of Rancher v2.5, privileged access is <a href="/v2.5/pages-for-subheaders/rancher-on-a-single-node-with-docker#privileged-access-for-rancher-v2-5">required.</a></p></div></div></details><h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-b-bring-your-own-certificate-self-signed">Option B: Bring Your Own Certificate: Self-Signed<a class="hash-link" href="#option-b-bring-your-own-certificate-self-signed" title="Direct link to heading">​</a></h3><details id="option-b" class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Click to expand</summary><div><div class="collapsibleContent_i85q"><p>If you have selected to bring your own self-signed certificate, you add the <code>--volumes-from rancher-data</code> to the command that you had started your original Rancher server container and need to have access to the same certificate that you had originally installed with.</p><blockquote><p><strong>Reminder of the Cert Prerequisite:</strong> The certificate files must be in PEM format. In your certificate file, include all intermediate certificates in the chain. Order your certificates with your certificate first, followed by the intermediates.</p></blockquote><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>&lt;CERT_DIRECTORY&gt;</code></td><td>The path to the directory containing your certificate files.</td></tr><tr><td><code>&lt;FULL_CHAIN.pem&gt;</code></td><td>The path to your full certificate chain.</td></tr><tr><td><code>&lt;PRIVATE_KEY.pem&gt;</code></td><td>The path to the private key for your certificate.</td></tr><tr><td><code>&lt;CA_CERTS.pem&gt;</code></td><td>The path to the certificate authority&#x27;s certificate.</td></tr><tr><td><code>&lt;RANCHER_VERSION_TAG&gt;</code></td><td>The release tag of the <a href="/v2.5/reference-guides/installation-references/helm-chart-options">Rancher version</a> that you want to upgrade to.</td></tr></tbody></table><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --volumes-from rancher-data \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --restart=unless-stopped \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p 80:80 -p 443:443 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /&lt;CERT_DIRECTORY&gt;/&lt;FULL_CHAIN.pem&gt;:/etc/rancher/ssl/cert.pem \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /&lt;CERT_DIRECTORY&gt;/&lt;PRIVATE_KEY.pem&gt;:/etc/rancher/ssl/key.pem \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /&lt;CERT_DIRECTORY&gt;/&lt;CA_CERTS.pem&gt;:/etc/rancher/ssl/cacerts.pem \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --privileged \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  rancher/rancher:&lt;RANCHER_VERSION_TAG&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As of Rancher v2.5, privileged access is <a href="/v2.5/pages-for-subheaders/rancher-on-a-single-node-with-docker#privileged-access-for-rancher-v2-5">required.</a></p></div></div></details><h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-c-bring-your-own-certificate-signed-by-recognized-ca">Option C: Bring Your Own Certificate: Signed by Recognized CA<a class="hash-link" href="#option-c-bring-your-own-certificate-signed-by-recognized-ca" title="Direct link to heading">​</a></h3><details id="option-c" class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Click to expand</summary><div><div class="collapsibleContent_i85q"><p>If you have selected to use a certificate signed by a recognized CA, you add the <code>--volumes-from rancher-data</code> to the command that you had started your original Rancher server container and need to have access to the same certificates that you had originally installed with. Remember to include <code>--no-cacerts</code> as an argument to the container to disable the default CA certificate generated by Rancher.</p><blockquote><p><strong>Reminder of the Cert Prerequisite:</strong> The certificate files must be in PEM format. In your certificate file, include all intermediate certificates provided by the recognized CA. Order your certificates with your certificate first, followed by the intermediates. For an example, see <a href="/v2.5/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/certificate-troubleshooting">Certificate Troubleshooting.</a></p></blockquote><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>&lt;CERT_DIRECTORY&gt;</code></td><td>The path to the directory containing your certificate files.</td></tr><tr><td><code>&lt;FULL_CHAIN.pem&gt;</code></td><td>The path to your full certificate chain.</td></tr><tr><td><code>&lt;PRIVATE_KEY.pem&gt;</code></td><td>The path to the private key for your certificate.</td></tr><tr><td><code>&lt;RANCHER_VERSION_TAG&gt;</code></td><td>The release tag of the <a href="/v2.5/reference-guides/installation-references/helm-chart-options">Rancher version</a> that you want to upgrade to.</td></tr></tbody></table><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --volumes-from rancher-data \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --restart=unless-stopped \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p 80:80 -p 443:443 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /&lt;CERT_DIRECTORY&gt;/&lt;FULL_CHAIN.pem&gt;:/etc/rancher/ssl/cert.pem \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -v /&lt;CERT_DIRECTORY&gt;/&lt;PRIVATE_KEY.pem&gt;:/etc/rancher/ssl/key.pem \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --privileged \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  rancher/rancher:&lt;RANCHER_VERSION_TAG&gt; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --no-cacerts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As of Rancher v2.5, privileged access is <a href="/v2.5/pages-for-subheaders/rancher-on-a-single-node-with-docker#privileged-access-for-rancher-v2-5">required.</a></p></div></div></details><h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-d-lets-encrypt-certificate">Option D: Let&#x27;s Encrypt Certificate<a class="hash-link" href="#option-d-lets-encrypt-certificate" title="Direct link to heading">​</a></h3><details id="option-d" class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Click to expand</summary><div><div class="collapsibleContent_i85q"><blockquote><p><strong>Remember:</strong> Let&#x27;s Encrypt provides rate limits for requesting new certificates. Therefore, limit how often you create or destroy the container. For more information, see <a href="https://letsencrypt.org/docs/rate-limits/" target="_blank" rel="noopener noreferrer">Let&#x27;s Encrypt documentation on rate limits</a>.</p></blockquote><p>If you have selected to use <a href="https://letsencrypt.org/" target="_blank" rel="noopener noreferrer">Let&#x27;s Encrypt</a> certificates, you add the <code>--volumes-from rancher-data</code> to the command that you had started your original Rancher server container and need to provide the domain that you had used when you originally installed Rancher.</p><blockquote><p><strong>Reminder of the Cert Prerequisites:</strong></p><ul><li>Create a record in your DNS that binds your Linux host IP address to the hostname that you want to use for Rancher access (<code>rancher.mydomain.com</code> for example).</li><li>Open port <code>TCP/80</code> on your Linux host. The Let&#x27;s Encrypt http-01 challenge can come from any source IP address, so port <code>TCP/80</code> must be open to all IP addresses.</li></ul></blockquote><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>&lt;RANCHER_VERSION_TAG&gt;</code></td><td>The release tag of the <a href="/v2.5/reference-guides/installation-references/helm-chart-options">Rancher version</a> that you want to upgrade to.</td></tr><tr><td><code>&lt;YOUR.DNS.NAME&gt;</code></td><td>The domain address that you had originally started with</td></tr></tbody></table><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --volumes-from rancher-data \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --restart=unless-stopped \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  -p 80:80 -p 443:443 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --privileged \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  rancher/rancher:&lt;RANCHER_VERSION_TAG&gt; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --acme-domain &lt;YOUR.DNS.NAME&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As of Rancher v2.5, privileged access is <a href="/v2.5/pages-for-subheaders/rancher-on-a-single-node-with-docker#privileged-access-for-rancher-v2-5">required.</a></p></div></div></details></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>For security purposes, SSL (Secure Sockets Layer) is required when using Rancher. SSL secures all Rancher network communication, like when you login or interact with a cluster.</p><p>When starting the new Rancher server container, choose from the following options:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-a-default-self-signed-certificate-1">Option A: Default Self-Signed Certificate<a class="hash-link" href="#option-a-default-self-signed-certificate-1" title="Direct link to heading">​</a></h3><details id="option-a" class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Click to expand</summary><div><div class="collapsibleContent_i85q"><p>If you have selected to use the Rancher generated self-signed certificate, you add the <code>--volumes-from rancher-data</code> to the command that you had started your original Rancher server container.</p><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>&lt;REGISTRY.YOURDOMAIN.COM:PORT&gt;</code></td><td>Your private registry URL and port.</td></tr><tr><td><code>&lt;RANCHER_VERSION_TAG&gt;</code></td><td>The release tag of the <a href="/v2.5/reference-guides/installation-references/helm-chart-options">Rancher version</a> that you want to to upgrade to.</td></tr></tbody></table><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  docker run -d --volumes-from rancher-data \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      --restart=unless-stopped \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      -p 80:80 -p 443:443 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      -e CATTLE_SYSTEM_DEFAULT_REGISTRY=&lt;REGISTRY.YOURDOMAIN.COM:PORT&gt; \ # Set a default private registry to be used in Rancher</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      -e CATTLE_SYSTEM_CATALOG=bundled \ # Use the packaged Rancher system charts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      --privileged \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &lt;REGISTRY.YOURDOMAIN.COM:PORT&gt;/rancher/rancher:&lt;RANCHER_VERSION_TAG&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As of Rancher v2.5, privileged access is <a href="/v2.5/pages-for-subheaders/rancher-on-a-single-node-with-docker#privileged-access-for-rancher-v2-5">required.</a></p></div></div></details><h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-b-bring-your-own-certificate-self-signed-1">Option B: Bring Your Own Certificate: Self-Signed<a class="hash-link" href="#option-b-bring-your-own-certificate-self-signed-1" title="Direct link to heading">​</a></h3><details id="option-b" class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Click to expand</summary><div><div class="collapsibleContent_i85q"><p>If you have selected to bring your own self-signed certificate, you add the <code>--volumes-from rancher-data</code> to the command that you had started your original Rancher server container and need to have access to the same certificate that you had originally installed with.</p><blockquote><p><strong>Reminder of the Prerequisite:</strong> The certificate files must be in PEM format. In your certificate file, include all intermediate certificates in the chain. Order your certificates with your certificate first, followed by the intermediates. For an example, see <a href="/v2.5/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/certificate-troubleshooting">Certificate Troubleshooting.</a></p></blockquote><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>&lt;CERT_DIRECTORY&gt;</code></td><td>The path to the directory containing your certificate files.</td></tr><tr><td><code>&lt;FULL_CHAIN.pem&gt;</code></td><td>The path to your full certificate chain.</td></tr><tr><td><code>&lt;PRIVATE_KEY.pem&gt;</code></td><td>The path to the private key for your certificate.</td></tr><tr><td><code>&lt;CA_CERTS.pem&gt;</code></td><td>The path to the certificate authority&#x27;s certificate.</td></tr><tr><td><code>&lt;REGISTRY.YOURDOMAIN.COM:PORT&gt;</code></td><td>Your private registry URL and port.</td></tr><tr><td><code>&lt;RANCHER_VERSION_TAG&gt;</code></td><td>The release tag of the <a href="/v2.5/reference-guides/installation-references/helm-chart-options">Rancher version</a> that you want to upgrade to.</td></tr></tbody></table><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --restart=unless-stopped \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -p 80:80 -p 443:443 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -v /&lt;CERT_DIRECTORY&gt;/&lt;FULL_CHAIN.pem&gt;:/etc/rancher/ssl/cert.pem \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -v /&lt;CERT_DIRECTORY&gt;/&lt;PRIVATE_KEY.pem&gt;:/etc/rancher/ssl/key.pem \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -v /&lt;CERT_DIRECTORY&gt;/&lt;CA_CERTS.pem&gt;:/etc/rancher/ssl/cacerts.pem \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -e CATTLE_SYSTEM_DEFAULT_REGISTRY=&lt;REGISTRY.YOURDOMAIN.COM:PORT&gt; \ # Set a default private registry to be used in Rancher</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    -e CATTLE_SYSTEM_CATALOG=bundled \ # Use the packaged Rancher system charts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --privileged \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;REGISTRY.YOURDOMAIN.COM:PORT&gt;/rancher/rancher:&lt;RANCHER_VERSION_TAG&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As of Rancher v2.5, privileged access is <a href="/v2.5/pages-for-subheaders/rancher-on-a-single-node-with-docker#privileged-access-for-rancher-v2-5">required.</a></p></div></div></details><h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-c-bring-your-own-certificate-signed-by-recognized-ca-1">Option C: Bring Your Own Certificate: Signed by Recognized CA<a class="hash-link" href="#option-c-bring-your-own-certificate-signed-by-recognized-ca-1" title="Direct link to heading">​</a></h3><details id="option-c" class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Click to expand</summary><div><div class="collapsibleContent_i85q"><p>If you have selected to use a certificate signed by a recognized CA, you add the <code>--volumes-from rancher-data</code> to the command that you had started your original Rancher server container and need to have access to the same certificates that you had originally installed with.</p><blockquote><p><strong>Reminder of the Prerequisite:</strong> The certificate files must be in PEM format. In your certificate file, include all intermediate certificates provided by the recognized CA. Order your certificates with your certificate first, followed by the intermediates. For an example, see <a href="/v2.5/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/certificate-troubleshooting">Certificate Troubleshooting.</a></p></blockquote><table><thead><tr><th>Placeholder</th><th>Description</th></tr></thead><tbody><tr><td><code>&lt;CERT_DIRECTORY&gt;</code></td><td>The path to the directory containing your certificate files.</td></tr><tr><td><code>&lt;FULL_CHAIN.pem&gt;</code></td><td>The path to your full certificate chain.</td></tr><tr><td><code>&lt;PRIVATE_KEY.pem&gt;</code></td><td>The path to the private key for your certificate.</td></tr><tr><td><code>&lt;REGISTRY.YOURDOMAIN.COM:PORT&gt;</code></td><td>Your private registry URL and port.</td></tr><tr><td><code>&lt;RANCHER_VERSION_TAG&gt;</code></td><td>The release tag of the <a href="/v2.5/reference-guides/installation-references/helm-chart-options">Rancher version</a> that you want to upgrade to.</td></tr></tbody></table><blockquote><p><strong>Note:</strong>  Use the <code>--no-cacerts</code> as argument to the container to disable the default CA certificate generated by Rancher.</p></blockquote><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --volumes-from rancher-data \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    --restart=unless-stopped \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     -p 80:80 -p 443:443 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     --no-cacerts \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     -v /&lt;CERT_DIRECTORY&gt;/&lt;FULL_CHAIN.pem&gt;:/etc/rancher/ssl/cert.pem \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     -v /&lt;CERT_DIRECTORY&gt;/&lt;PRIVATE_KEY.pem&gt;:/etc/rancher/ssl/key.pem \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     -e CATTLE_SYSTEM_DEFAULT_REGISTRY=&lt;REGISTRY.YOURDOMAIN.COM:PORT&gt; \ # Set a default private registry to be used in Rancher</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     -e CATTLE_SYSTEM_CATALOG=bundled \ # Use the packaged Rancher system charts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     --privileged</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     &lt;REGISTRY.YOURDOMAIN.COM:PORT&gt;/rancher/rancher:&lt;RANCHER_VERSION_TAG&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As of Rancher v2.5, privileged access is <a href="/v2.5/pages-for-subheaders/rancher-on-a-single-node-with-docker#privileged-access-for-rancher-v2-5">required.</a></p></div></div></details></div></div></div><p><strong>Result:</strong> You have upgraded Rancher. Data from your upgraded server is now saved to the <code>rancher-data</code> container for use in future upgrades.</p><h1>5. Verify the Upgrade</h1><p>Log into Rancher. Confirm that the upgrade succeeded by checking the version displayed in the bottom-left corner of the browser window.</p><blockquote><p><strong>Having network issues in your user clusters following upgrade?</strong></p><p>See <a href="/v2.0-v2.4/getting-started/installation-and-upgrade/install-upgrade-on-a-kubernetes-cluster/upgrades/namespace-migration">Restoring Cluster Networking</a>.</p></blockquote><h1>6. Clean up Your Old Rancher Server Container</h1><p>Remove the previous Rancher server container. If you only stop the previous Rancher server container (and don&#x27;t remove it), the container may restart after the next server reboot.</p><h1>Rolling Back</h1><p>If your upgrade does not complete successfully, you can roll back Rancher server and its data back to its last healthy state. For more information, see <a href="/v2.5/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/roll-back-docker-installed-rancher">Docker Rollback</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/rancher/rancher-docs/edit/main/versioned_docs/version-2.5/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/upgrade-docker-installed-rancher.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-09-08T22:35:34.000Z">9/8/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/v2.5/pages-for-subheaders/rancher-on-a-single-node-with-docker"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Installing Rancher on a Single Node Using Docker</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/v2.5/getting-started/installation-and-upgrade/other-installation-methods/rancher-on-a-single-node-with-docker/roll-back-docker-installed-rancher"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Rolling Back Rancher Installed with Docker</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#option-a-default-self-signed-certificate" class="table-of-contents__link toc-highlight">Option A: Default Self-Signed Certificate</a></li><li><a href="#option-b-bring-your-own-certificate-self-signed" class="table-of-contents__link toc-highlight">Option B: Bring Your Own Certificate: Self-Signed</a></li><li><a href="#option-c-bring-your-own-certificate-signed-by-recognized-ca" class="table-of-contents__link toc-highlight">Option C: Bring Your Own Certificate: Signed by Recognized CA</a></li><li><a href="#option-d-lets-encrypt-certificate" class="table-of-contents__link toc-highlight">Option D: Let&#39;s Encrypt Certificate</a></li><li><a href="#option-a-default-self-signed-certificate-1" class="table-of-contents__link toc-highlight">Option A: Default Self-Signed Certificate</a></li><li><a href="#option-b-bring-your-own-certificate-self-signed-1" class="table-of-contents__link toc-highlight">Option B: Bring Your Own Certificate: Self-Signed</a></li><li><a href="#option-c-bring-your-own-certificate-signed-by-recognized-ca-1" class="table-of-contents__link toc-highlight">Option C: Bring Your Own Certificate: Signed by Recognized CA</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 SUSE Rancher. All Rights Reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.217a7f9f.js"></script>
<script src="/assets/js/main.00d8b9dc.js"></script>
</body>
</html>
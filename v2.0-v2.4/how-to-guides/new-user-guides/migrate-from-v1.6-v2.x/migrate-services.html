<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-2.0-2.4 plugin-docs plugin-id-default docs-doc-id-how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/migrate-services">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="search" type="application/opensearchdescription+xml" title="Rancher Manager" href="/opensearch.xml"><title data-rh="true">2. Migrate Your Services | Rancher Manager</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://docs.ranchermanager.rancher.io//v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/migrate-services"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="2.0-2.4"><meta data-rh="true" name="docusaurus_tag" content="docs-default-2.0-2.4"><meta data-rh="true" name="docsearch:version" content="2.0-2.4"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-2.0-2.4"><meta data-rh="true" property="og:title" content="2. Migrate Your Services | Rancher Manager"><meta data-rh="true" name="description" content="Although your services from v1.6 won&#x27;t work in Rancher v2.x by default, that doesn&#x27;t mean you have to start again from square one, manually rebuilding your applications in v2.x. To help with migration from v1.6 to v2.x, Rancher has developed a migration tool. The migration-tools CLI is a utility that helps you recreate your applications in Rancher v2.x. This tool exports your Rancher v1.6 services as Compose files and converts them to a Kubernetes manifest that Rancher v2.x can consume."><meta data-rh="true" property="og:description" content="Although your services from v1.6 won&#x27;t work in Rancher v2.x by default, that doesn&#x27;t mean you have to start again from square one, manually rebuilding your applications in v2.x. To help with migration from v1.6 to v2.x, Rancher has developed a migration tool. The migration-tools CLI is a utility that helps you recreate your applications in Rancher v2.x. This tool exports your Rancher v1.6 services as Compose files and converts them to a Kubernetes manifest that Rancher v2.x can consume."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="http://docs.ranchermanager.rancher.io//v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/migrate-services"><link data-rh="true" rel="alternate" href="http://docs.ranchermanager.rancher.io//v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/migrate-services" hreflang="en"><link data-rh="true" rel="alternate" href="http://docs.ranchermanager.rancher.io//v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/migrate-services" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://30NEY6C9UY-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.9543bcfd.css">
<link rel="preload" href="/assets/js/runtime~main.217a7f9f.js" as="script">
<link rel="preload" href="/assets/js/main.00d8b9dc.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/v2.0-v2.4">v2.0-v2.4</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/">v2.6</a></li><li><a class="dropdown__link" href="/v2.5">v2.5</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/migrate-services">v2.0-v2.4</a></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__docs navbar__link--active" href="/v2.0-v2.4">Docs</a><a href="https://github.com/rancher/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__github btn btn-secondary icon-github">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v2.0-v2.4">Rancher 2.0-2.4</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.0-v2.4/getting-started">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/v2.0-v2.4/how-to-guides">How-to Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;How-to Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/v2.0-v2.4/pages-for-subheaders/new-user-guides">New User Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;New User Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.0-v2.4/pages-for-subheaders/kubernetes-cluster-setup">Kubernetes Cluster Setup</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kubernetes Cluster Setup&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.0-v2.4/pages-for-subheaders/infrastructure-setup">Infrastructure Setup</a><button aria-label="Toggle the collapsible sidebar category &#x27;Infrastructure Setup&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.0-v2.4/pages-for-subheaders/kubernetes-clusters-in-rancher-setup">Kubernetes Clusters in Rancher Setup</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kubernetes Clusters in Rancher Setup&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.0-v2.4/pages-for-subheaders/kubernetes-resources-setup">Kubernetes Resources Setup</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kubernetes Resources Setup&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.0-v2.4/pages-for-subheaders/helm-charts-in-rancher">Helm Charts in Rancher</a><button aria-label="Toggle the collapsible sidebar category &#x27;Helm Charts in Rancher&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.0-v2.4/how-to-guides/new-user-guides/deploy-apps-across-clusters">Deploying Applications across Clusters</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.0-v2.4/pages-for-subheaders/backup-restore-and-disaster-recovery">Backup, Restore, and Disaster Recovery</a><button aria-label="Toggle the collapsible sidebar category &#x27;Backup, Restore, and Disaster Recovery&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/v2.0-v2.4/pages-for-subheaders/migrate-from-v1.6-v2.x">Migrating from v1.6 to v2.x</a><button aria-label="Toggle the collapsible sidebar category &#x27;Migrating from v1.6 to v2.x&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/kubernetes-introduction">Kubernetes Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/install-and-configure-rancher">1. Get Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/migrate-services">2. Migrate Your Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/expose-services">3. Expose Your Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/monitor-apps">4. Configure Health Checks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/schedule-services">5. Schedule Your Services</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/discover-services">6. Service Discovery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/load-balancing">7. Load Balancing</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.0-v2.4/pages-for-subheaders/advanced-user-guides">Advanced User Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Advanced User Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.0-v2.4/reference-guides">Reference Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reference Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.0-v2.4/explanations">Explanations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Explanations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.0-v2.4/faq">FAQ</a><button aria-label="Toggle the collapsible sidebar category &#x27;FAQ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.0-v2.4/troubleshooting">Troubleshooting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Troubleshooting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v2.0-v2.4/contribute-to-rancher">Contributing to Rancher</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Rancher Manager<!-- --> <b>v2.0-v2.4</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/">latest version</a></b> (<!-- -->v2.6<!-- -->).</div></div><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.0-v2.4/how-to-guides"><span itemprop="name">How-to Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.0-v2.4/pages-for-subheaders/new-user-guides"><span itemprop="name">New User Guides</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.0-v2.4/pages-for-subheaders/migrate-from-v1.6-v2.x"><span itemprop="name">Migrating from v1.6 to v2.x</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">2. Migrate Your Services</span><meta itemprop="position" content="4"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v2.0-v2.4</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>2. Migrate Your Services</h1></header><p>Although your services from v1.6 won&#x27;t work in Rancher v2.x by default, that doesn&#x27;t mean you have to start again from square one, manually rebuilding your applications in v2.x. To help with migration from v1.6 to v2.x, Rancher has developed a migration tool. The migration-tools CLI is a utility that helps you recreate your applications in Rancher v2.x. This tool exports your Rancher v1.6 services as Compose files and converts them to a Kubernetes manifest that Rancher v2.x can consume.</p><p>Additionally, for each Rancher v1.6-specific Compose directive that cannot be consumed by Kubernetes, migration-tools CLI provides instructions on how to manually recreate them in Rancher v2.x.</p><p>This command line interface tool will:</p><ul><li><p>Export Compose files (i.e., <code>docker-compose.yml</code> and <code>rancher-compose.yml</code>) for each stack in your v1.6 Cattle environment. For every stack, files are exported to a unique folder: <code>&lt;EXPORT_DIR&gt;/&lt;ENV_NAME&gt;/&lt;STACK_NAME&gt;</code>.</p></li><li><p>Parse Compose files that you’ve exported from your Rancher v1.6 stacks and converts them to Kubernetes manifests that Rancher v2.x can consume. The tool also outputs a list of directives present in the Compose files that cannot be converted automatically to Rancher v2.x. These are directives that you’ll have to manually configure using the Rancher v2.x UI.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="outline">Outline<a class="hash-link" href="#outline" title="Direct link to heading">​</a></h2><ul><li><a href="#a-download-the-migration-tools-cli">A. Download the migration-tools CLI</a></li><li><a href="#b-configure-the-migration-tools-cli">B. Configure the migration-tools CLI</a></li><li><a href="#c-run-the-migration-tools-cli">C. Run the migration-tools CLI</a></li><li><a href="#d-re-deploy-services-as-kubernetes-manifests">D. Deploy Services Using Rancher CLI</a></li><li><a href="#what-now">What Now?</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-download-the-migration-tools-cli">A. Download the migration-tools CLI<a class="hash-link" href="#a-download-the-migration-tools-cli" title="Direct link to heading">​</a></h2><p>The migration-tools CLI for your platform can be downloaded from our <a href="https://github.com/rancher/migration-tools/releases" target="_blank" rel="noopener noreferrer">GitHub releases page</a>. The tools are available for Linux, Mac, and Windows platforms.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="b-configure-the-migration-tools-cli">B. Configure the migration-tools CLI<a class="hash-link" href="#b-configure-the-migration-tools-cli" title="Direct link to heading">​</a></h2><p>After you download migration-tools CLI, rename it and make it executable.</p><ol><li><p>Open a terminal window and change to the directory that contains the migration-tool file.</p></li><li><p>Rename the file to <code>migration-tools</code> so that it no longer includes the platform name.</p></li><li><p>Enter the following command to make <code>migration-tools</code> executable:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">chmod +x migration-tools</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="c-run-the-migration-tools-cli">C. Run the migration-tools CLI<a class="hash-link" href="#c-run-the-migration-tools-cli" title="Direct link to heading">​</a></h2><p>Next, use the migration-tools CLI to export all stacks in all of the Cattle environments into Compose files. Then, for stacks that you want to migrate to Rancher v2.x, convert the Compose files into Kubernetes manifest.</p><blockquote><p><strong>Prerequisite:</strong> Create an <a href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/{{&lt;baseurl&gt;}}/rancher/v1.6/en/api/v2-beta/api-keys#account-api-keys">Account API Key</a> to authenticate with Rancher v1.6 when using the migration-tools CLI.</p></blockquote><ol><li><p>Export the Docker Compose files for your Cattle environments and stacks from Rancher v1.6.</p><p>In the terminal window, execute the following command, replacing each placeholder with your values.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">migration-tools export --url http://&lt;RANCHER_URL:PORT&gt; --access-key &lt;RANCHER_ACCESS_KEY&gt; --secret-key &lt;RANCHER_SECRET_KEY&gt; --export-dir &lt;EXPORT_DIR&gt; --all</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Step Result:</strong> migration-tools exports Compose files (<code>docker-compose.yml</code> and <code>rancher-compose.yml</code>) for each stack in the <code>--export-dir</code> directory. If you omitted this option, Compose files are output to your current directory.</p><p>A unique directory is created for each environment and stack. For example, if we export each <a href="/v2.0-v2.4/pages-for-subheaders/migrate-from-v1.6-v2.x#migration-example-files">environment/stack</a> from Rancher v1.6, the following directory structure is created:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">export/                            # migration-tools --export-dir</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">|--&lt;ENVIRONMENT&gt;/                  # Rancher v1.6 ENVIRONMENT</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    |--&lt;STACK&gt;/                    # Rancher v1.6 STACK</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         |--docker-compose.yml     # STANDARD DOCKER DIRECTIVES FOR ALL STACK SERVICES</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         |--rancher-compose.yml    # RANCHER-SPECIFIC DIRECTIVES FOR ALL STACK SERVICES</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         |--README.md              # README OF CHANGES FROM v1.6 to v2.x</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><ol><li><p>Convert the exported Compose files to Kubernetes manifest.</p><p>Execute the following command, replacing each placeholder with the absolute path to your Stack&#x27;s Compose files. If you want to migrate multiple stacks, you&#x27;ll have to re-run the command for each pair of Compose files that you exported.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">migration-tools parse --docker-file &lt;DOCKER_COMPOSE_ABSOLUTE_PATH&gt; --rancher-file &lt;RANCHER_COMPOSE_ABSOLUTE_PATH&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>Note:</strong> If you omit the <code>--docker-file</code> and <code>--rancher-file</code> options from your command, migration-tools uses the current working directory to find Compose files.</p></blockquote></li></ol><blockquote><p><strong>Want full usage and options for the migration-tools CLI?</strong> See the <a href="/v2.0-v2.4/reference-guides/v1.6-migration/migration-tools-cli-reference">Migration Tools CLI Reference</a>.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="migration-tools-cli-output">migration-tools CLI Output<a class="hash-link" href="#migration-tools-cli-output" title="Direct link to heading">​</a></h3><p>After you run the migration-tools parse command, the following files are output to your target directory.</p><table><thead><tr><th>Output</th><th>Description</th></tr></thead><tbody><tr><td><code>output.txt</code></td><td>This file lists how to recreate your Rancher v1.6-specific functionality in Kubernetes. Each listing links to the relevant blog articles on how to implement it in Rancher v2.x.</td></tr><tr><td>Kubernetes manifest specs</td><td>Migration-tools internally invokes <a href="https://github.com/kubernetes/kompose" target="_blank" rel="noopener noreferrer">Kompose</a> to generate a Kubernetes manifest for each service you&#x27;re migrating to v2.x. Each YAML spec file is named for the service you&#x27;re migrating.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="why-are-there-separate-deployment-and-service-manifests">Why are There Separate Deployment and Service Manifests?<a class="hash-link" href="#why-are-there-separate-deployment-and-service-manifests" title="Direct link to heading">​</a></h4><p>To make an application publicly accessible by URL, a Kubernetes service is required in support of the deployment. A Kubernetes service is a REST object that abstracts access to the pods in the workload. In other words, a service provides a static endpoint to the pods by mapping a URL to pod(s) Therefore, even if the pods change IP address, the public endpoint remains unchanged. A service object points to its corresponding deployment (workload) by using selector labels.</p><p>When a you export a service from Rancher v1.6 that exposes public ports, migration-tools CLI parses those ports to a Kubernetes service spec that links to a deployment YAML spec.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="migration-example-file-output">Migration Example File Output<a class="hash-link" href="#migration-example-file-output" title="Direct link to heading">​</a></h4><p>If we parse the two example files from <a href="/v2.0-v2.4/pages-for-subheaders/migrate-from-v1.6-v2.x#migration-example-files">Migration Example Files</a>, <code>docker-compose.yml</code> and <code>rancher-compose.yml</code>, the following files are output:</p><table><thead><tr><th>File</th><th>Description</th></tr></thead><tbody><tr><td><code>web-deployment.yaml</code></td><td>A file containing Kubernetes container specs for a Let&#x27;s Chat deployment.</td></tr><tr><td><code>web-service.yaml</code></td><td>A file containing specs for the Let&#x27;s Chat service.</td></tr><tr><td><code>database-deployment.yaml</code></td><td>A file containing container specs for the MongoDB deployment in support of Let&#x27;s Chat.</td></tr><tr><td><code>webLB-deployment.yaml</code></td><td>A file containing container specs for an HAProxy deployment that&#x27;s serving as a load balancer.<sup>1</sup></td></tr><tr><td><code>webLB-service.yaml</code></td><td>A file containing specs for the HAProxy service.<sup>1</sup></td></tr></tbody></table><blockquote><sup>1</sup> Because Rancher v2.x uses Ingress for load balancing, we won&#x27;t be migrating our Rancher v1.6 load balancer to v2.x.</blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="d-re-deploy-services-as-kubernetes-manifests">D. Re-Deploy Services as Kubernetes Manifests<a class="hash-link" href="#d-re-deploy-services-as-kubernetes-manifests" title="Direct link to heading">​</a></h2><blockquote><p><strong>Note:</strong> Although these instructions deploy your v1.6 services in Rancher v2.x, they will not work correctly until you adjust their Kubernetes manifests.</p></blockquote><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Rancher UI</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Rancher CLI</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>You can deploy the Kubernetes manifests created by migration-tools by importing them into Rancher v2.x.</p><blockquote><p><strong>Receiving an <code>ImportYaml Error</code>?</strong></p><p>Delete the YAML directive listed in the error message. These are YAML directives from your v1.6 services that Kubernetes can&#x27;t read.</p></blockquote><figcaption>Deploy Services: Import Kubernetes Manifest</figcaption><p><img loading="lazy" alt="Deploy Services" src="/assets/images/deploy-service-b11452e9b2810fbe3205376f2956f24e.gif" width="1920" height="1080" class="img_ev3q"></p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><blockquote><p><strong>Prerequisite:</strong> <a href="/v2.0-v2.4/pages-for-subheaders/cli-with-rancher">Install Rancher CLI</a> for Rancher v2.x.</p></blockquote><p>Use the following Rancher CLI commands to deploy your application using Rancher v2.x. For each Kubernetes manifest output by migration-tools CLI, enter one of the commands below to import it into Rancher v2.x.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./rancher kubectl create -f &lt;DEPLOYMENT_YAML_FILE&gt; # DEPLOY THE DEPLOYMENT YAML</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./rancher kubectl create -f &lt;SERVICE_YAML_FILE&gt; # DEPLOY THE SERVICE YAML</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p>Following importation, you can view your v1.6 services in the v2.x UI as Kubernetes manifests by using the context menu to select <code>&lt;CLUSTER&gt; &gt; &lt;PROJECT&gt;</code> that contains your services. The imported manifests will display on the <strong>Resources &gt; Workloads</strong> and on the tab at <strong>Resources &gt; Workloads &gt; Service Discovery.</strong> (In Rancher v2.x before v2.3.0, these are on the <strong>Workloads</strong> and <strong>Service Discovery</strong> tabs in the top navigation bar.)</p><figcaption>Imported Services</figcaption><p><img loading="lazy" alt="Imported Services" src="/assets/images/imported-workloads-c4017880dad280661ea7a9e6ce6627f9.png" width="1688" height="792" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-now">What Now?<a class="hash-link" href="#what-now" title="Direct link to heading">​</a></h2><p>Although the migration-tool CLI parses your Rancher v1.6 Compose files to Kubernetes manifests, there are discrepancies between v1.6 and v2.x that you must address by manually editing your parsed <a href="#output">Kubernetes manifests</a>. In other words, you need to edit each workload and service imported into Rancher v2.x, as displayed below.</p><figcaption>Edit Migrated Services</figcaption><p><img loading="lazy" alt="Edit Migrated Workload" src="/assets/images/edit-migration-workload-08f9205acd01cd05496fe4c952c01453.gif" width="1920" height="1080" class="img_ev3q"></p><p>As mentioned in <a href="#migration-tools-cli-output">Migration Tools CLI Output</a>, the <code>output.txt</code> files generated during parsing lists the manual steps you must make for each deployment. Review the upcoming topics for more information on manually editing your Kubernetes specs.</p><p>Open your <code>output.txt</code> file and take a look at its contents. When you parsed your Compose files into Kubernetes manifests, migration-tools CLI output a manifest for each workload that it creates for Kubernetes. For example, our when our <a href="/v2.0-v2.4/pages-for-subheaders/migrate-from-v1.6-v2.x#migration-example-files">Migration Example Files</a> are parsed into Kubernetes manifests, <code>output.txt</code> lists each resultant parsed <a href="#migration-example-file-output">Kubernetes manifest file</a> (i.e., workloads). Each workload features a list of action items to restore operations for the workload in v2.x.</p><figcaption>Output.txt Example</figcaption><p><img loading="lazy" alt="output.txt" src="/assets/images/output-dot-text-e0106ece19c59d930ec86a5739a88b16.png" width="996" height="411" class="img_ev3q"></p><p>The following table lists possible directives that may appear in <code>output.txt</code>, what they mean, and links on how to resolve them.</p><table><thead><tr><th>Directive</th><th>Instructions</th></tr></thead><tbody><tr><td><a href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/expose-services">ports</a></td><td>Rancher v1.6 <em>Port Mappings</em> cannot be migrated to v2.x. Instead, you must manually declare either a HostPort or NodePort, which are similar to Port Mappings.</td></tr><tr><td><a href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/monitor-apps#configuring-probes-in-rancher-v2-x">health_check</a></td><td>The Rancher v1.6 health check microservice has been replaced with native Kubernetes health checks, called <em>probes</em>. Recreate your v1.6 health checks in v2.0 using probes.</td></tr><tr><td><a href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/schedule-services#scheduling-using-labels">labels</a></td><td>Rancher v1.6 uses labels to implement a variety of features in v1.6. In v2.x, Kubernetes uses different mechanisms to implement these features. Click through on the links here for instructions on how to address each label.<br><br><a href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/schedule-services#scheduling-using-labels">io.rancher.container.pull_image</a>: In v1.6, this label instructed deployed containers to pull a new version of the image upon restart. In v2.x, this functionality is replaced by the  <code>imagePullPolicy</code> directive.<br><br><a href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/schedule-services#scheduling-global-services">io.rancher.scheduler.global</a>: In v1.6, this label scheduled a container replica on every cluster host. In v2.x, this functionality is replaced by <a href="https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/" target="_blank" rel="noopener noreferrer">Daemon Sets</a>.<br><br><a href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/schedule-services#label-affinity-antiaffinity">io.rancher.scheduler.affinity</a>: In v2.x, affinity is applied in a different way.</td></tr><tr><td><a href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/discover-services">links</a></td><td>During migration, you must create links between your Kubernetes workloads and services for them to function properly in v2.x.</td></tr><tr><td><a href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/schedule-services#scheduling-pods-to-a-specific-node">scale</a></td><td>In v1.6, scale refers to the number of container replicas running on a single node. In v2.x, this feature is replaced by replica sets.</td></tr><tr><td>start_on_create</td><td>No Kubernetes equivalent. No action is required from you.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="next-expose-your-services"><a href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/expose-services">Next: Expose Your Services</a><a class="hash-link" href="#next-expose-your-services" title="Direct link to heading">​</a></h3></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/rancher/rancher-docs/edit/main/versioned_docs/version-2.0-2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/migrate-services.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-09-08T22:35:34.000Z">9/8/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/install-and-configure-rancher"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">1. Get Started</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/v2.0-v2.4/how-to-guides/new-user-guides/migrate-from-v1.6-v2.x/expose-services"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">3. Expose Your Services</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#outline" class="table-of-contents__link toc-highlight">Outline</a></li><li><a href="#a-download-the-migration-tools-cli" class="table-of-contents__link toc-highlight">A. Download the migration-tools CLI</a></li><li><a href="#b-configure-the-migration-tools-cli" class="table-of-contents__link toc-highlight">B. Configure the migration-tools CLI</a></li><li><a href="#c-run-the-migration-tools-cli" class="table-of-contents__link toc-highlight">C. Run the migration-tools CLI</a><ul><li><a href="#migration-tools-cli-output" class="table-of-contents__link toc-highlight">migration-tools CLI Output</a></li></ul></li><li><a href="#d-re-deploy-services-as-kubernetes-manifests" class="table-of-contents__link toc-highlight">D. Re-Deploy Services as Kubernetes Manifests</a></li><li><a href="#what-now" class="table-of-contents__link toc-highlight">What Now?</a><ul><li><a href="#next-expose-your-services" class="table-of-contents__link toc-highlight">Next: Expose Your Services</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 SUSE Rancher. All Rights Reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.217a7f9f.js"></script>
<script src="/assets/js/main.00d8b9dc.js"></script>
</body>
</html>
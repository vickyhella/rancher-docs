"use strict";(self.webpackChunkrancher_docs=self.webpackChunkrancher_docs||[]).push([[24404],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=r.createContext({}),d=function(e){var t=r.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},c=function(e){var t=d(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=d(a),m=n,g=p["".concat(l,".").concat(m)]||p[m]||u[m]||o;return a?r.createElement(g,s(s({ref:t},c),{},{components:a})):r.createElement(g,s({ref:t},c))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,s=new Array(o);s[0]=p;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:n,s[1]=i;for(var d=2;d<o;d++)s[d]=a[d];return r.createElement.apply(null,s)}return r.createElement.apply(null,a)}p.displayName="MDXCreateElement"},24450:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var r=a(87462),n=(a(67294),a(3905));const o={title:"Adding Ingresses to Your Project",description:"Ingresses can be added for workloads to provide load balancing, SSL termination and host/path-based routing. Learn how to add Rancher ingress to your project"},s=void 0,i={unversionedId:"how-to-guides/new-user-guides/kubernetes-resources-setup/load-balancer-and-ingress-controller/add-ingresses",id:"version-2.0-2.4/how-to-guides/new-user-guides/kubernetes-resources-setup/load-balancer-and-ingress-controller/add-ingresses",title:"Adding Ingresses to Your Project",description:"Ingresses can be added for workloads to provide load balancing, SSL termination and host/path-based routing. Learn how to add Rancher ingress to your project",source:"@site/versioned_docs/version-2.0-2.4/how-to-guides/new-user-guides/kubernetes-resources-setup/load-balancer-and-ingress-controller/add-ingresses.md",sourceDirName:"how-to-guides/new-user-guides/kubernetes-resources-setup/load-balancer-and-ingress-controller",slug:"/how-to-guides/new-user-guides/kubernetes-resources-setup/load-balancer-and-ingress-controller/add-ingresses",permalink:"/zh/v2.0-v2.4/how-to-guides/new-user-guides/kubernetes-resources-setup/load-balancer-and-ingress-controller/add-ingresses",draft:!1,editUrl:"https://github.com/rancher/rancher-docs/edit/main/versioned_docs/version-2.0-2.4/how-to-guides/new-user-guides/kubernetes-resources-setup/load-balancer-and-ingress-controller/add-ingresses.md",tags:[],version:"2.0-2.4",lastUpdatedAt:1667008130,formattedLastUpdatedAt:"2022\u5e7410\u670829\u65e5",frontMatter:{title:"Adding Ingresses to Your Project",description:"Ingresses can be added for workloads to provide load balancing, SSL termination and host/path-based routing. Learn how to add Rancher ingress to your project"},sidebar:"tutorialSidebar",previous:{title:"Layer 4 and Layer 7 Load Balancing",permalink:"/zh/v2.0-v2.4/how-to-guides/new-user-guides/kubernetes-resources-setup/load-balancer-and-ingress-controller/layer-4-and-layer-7-load-balancing"},next:{title:"Service Discovery",permalink:"/zh/v2.0-v2.4/how-to-guides/new-user-guides/kubernetes-resources-setup/create-services"}},l={},d=[{value:"Ingress Rule Configuration",id:"ingress-rule-configuration",level:2},{value:"Automatically generate a sslip.io hostname",id:"automatically-generate-a-sslipio-hostname",level:3},{value:"Specify a hostname to use",id:"specify-a-hostname-to-use",level:3},{value:"Use as the default backend",id:"use-as-the-default-backend",level:3},{value:"Certificates",id:"certificates",level:3},{value:"Labels and Annotations",id:"labels-and-annotations",level:3}],c={toc:d};function u(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,r.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Ingress can be added for workloads to provide load balancing, SSL termination and host/path based routing. When using ingresses in a project, you can program the ingress hostname to an external DNS by setting up a ",(0,n.kt)("a",{parentName:"p",href:"/zh/v2.0-v2.4/how-to-guides/new-user-guides/helm-charts-in-rancher/globaldns"},"Global DNS entry"),"."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"From the ",(0,n.kt)("strong",{parentName:"li"},"Global")," view, open the project that you want to add ingress to."),(0,n.kt)("li",{parentName:"ol"},"Click ",(0,n.kt)("strong",{parentName:"li"},"Resources")," in the main navigation bar. Click the ",(0,n.kt)("strong",{parentName:"li"},"Load Balancing")," tab. (In versions before v2.3.0, just click the ",(0,n.kt)("strong",{parentName:"li"},"Load Balancing")," tab.) Then click ",(0,n.kt)("strong",{parentName:"li"},"Add Ingress"),"."),(0,n.kt)("li",{parentName:"ol"},"Enter a ",(0,n.kt)("strong",{parentName:"li"},"Name")," for the ingress."),(0,n.kt)("li",{parentName:"ol"},"Select an existing ",(0,n.kt)("strong",{parentName:"li"},"Namespace")," from the drop-down list. Alternatively, you can create a new namespace on the fly by clicking ",(0,n.kt)("strong",{parentName:"li"},"Add to a new namespace"),"."),(0,n.kt)("li",{parentName:"ol"},"Create ingress forwarding ",(0,n.kt)("strong",{parentName:"li"},"Rules"),". For help configuring the rules, refer to ",(0,n.kt)("a",{parentName:"li",href:"#ingress-rule-configuration"},"this section.")," If any of your ingress rules handle requests for encrypted ports, add a certificate to encrypt/decrypt communications."),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Optional:")," click ",(0,n.kt)("strong",{parentName:"li"},"Add Rule")," to create additional ingress rules. For example, after you create ingress rules to direct requests for your hostname, you'll likely want to create a default backend to handle 404s.")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Result:")," Your ingress is added to the project. The ingress begins enforcing your ingress rules."),(0,n.kt)("h2",{id:"ingress-rule-configuration"},"Ingress Rule Configuration"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#automatically-generate-a-sslip-io-hostname"},"Automatically generate a sslip.io hostname")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#specify-a-hostname-to-use"},"Specify a hostname to use")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#use-as-the-default-backend"},"Use as the default backend")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#certificates"},"Certificates")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#labels-and-annotations"},"Labels and Annotations"))),(0,n.kt)("h3",{id:"automatically-generate-a-sslipio-hostname"},"Automatically generate a sslip.io hostname"),(0,n.kt)("p",null,"If you choose this option, ingress routes requests to hostname to a DNS name that's automatically generated. Rancher uses ",(0,n.kt)("a",{parentName:"p",href:"http://sslip.io/"},"sslip.io")," to automatically generates the DNS name. This option is best used for testing, ",(0,n.kt)("em",{parentName:"p"},"not")," production environments."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},(0,n.kt)("strong",{parentName:"p"},"Note:")," To use this option, you must be able to resolve to ",(0,n.kt)("inlineCode",{parentName:"p"},"sslip.io")," addresses.")),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Add a ",(0,n.kt)("strong",{parentName:"li"},"Target Backend"),". By default, a workload is added to the ingress, but you can add more targets by clicking either ",(0,n.kt)("strong",{parentName:"li"},"Service")," or ",(0,n.kt)("strong",{parentName:"li"},"Workload"),"."),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Optional:")," If you want specify a workload or service when a request is sent to a particular hostname path, add a ",(0,n.kt)("strong",{parentName:"li"},"Path")," for the target. For example, if you want requests for ",(0,n.kt)("inlineCode",{parentName:"li"},"www.mysite.com/contact-us")," to be sent to a different service than ",(0,n.kt)("inlineCode",{parentName:"li"},"www.mysite.com"),", enter ",(0,n.kt)("inlineCode",{parentName:"li"},"/contact-us")," in the ",(0,n.kt)("strong",{parentName:"li"},"Path")," field. Typically, the first rule that you create does not include a path."),(0,n.kt)("li",{parentName:"ol"},"Select a workload or service from the ",(0,n.kt)("strong",{parentName:"li"},"Target")," drop-down list for each target you've added."),(0,n.kt)("li",{parentName:"ol"},"Enter the ",(0,n.kt)("strong",{parentName:"li"},"Port")," number that each target operates on.")),(0,n.kt)("h3",{id:"specify-a-hostname-to-use"},"Specify a hostname to use"),(0,n.kt)("p",null,"If you use this option, ingress routes requests for a hostname to the service or workload that you specify."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Enter the hostname that your ingress will handle request forwarding for. For example, ",(0,n.kt)("inlineCode",{parentName:"li"},"www.mysite.com"),"."),(0,n.kt)("li",{parentName:"ol"},"Add a ",(0,n.kt)("strong",{parentName:"li"},"Target Backend"),". By default, a workload is added to the ingress, but you can add more targets by clicking either ",(0,n.kt)("strong",{parentName:"li"},"Service")," or ",(0,n.kt)("strong",{parentName:"li"},"Workload"),"."),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Optional:")," If you want specify a workload or service when a request is sent to a particular hostname path, add a ",(0,n.kt)("strong",{parentName:"li"},"Path")," for the target. For example, if you want requests for ",(0,n.kt)("inlineCode",{parentName:"li"},"www.mysite.com/contact-us")," to be sent to a different service than ",(0,n.kt)("inlineCode",{parentName:"li"},"www.mysite.com"),", enter ",(0,n.kt)("inlineCode",{parentName:"li"},"/contact-us")," in the ",(0,n.kt)("strong",{parentName:"li"},"Path")," field. Typically, the first rule that you create does not include a path."),(0,n.kt)("li",{parentName:"ol"},"Select a workload or service from the ",(0,n.kt)("strong",{parentName:"li"},"Target")," drop-down list for each target you've added."),(0,n.kt)("li",{parentName:"ol"},"Enter the ",(0,n.kt)("strong",{parentName:"li"},"Port")," number that each target operates on.")),(0,n.kt)("h3",{id:"use-as-the-default-backend"},"Use as the default backend"),(0,n.kt)("p",null,"Use this option to set an ingress rule for handling requests that don't match any other ingress rules. For example, use this option to route requests that can't be found to a ",(0,n.kt)("inlineCode",{parentName:"p"},"404")," page."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},(0,n.kt)("strong",{parentName:"p"},"Note:")," If you deployed Rancher using RKE, a default backend for 404s and 202s is already configured.")),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Add a ",(0,n.kt)("strong",{parentName:"li"},"Target Backend"),". Click either ",(0,n.kt)("strong",{parentName:"li"},"Service")," or ",(0,n.kt)("strong",{parentName:"li"},"Workload")," to add the target."),(0,n.kt)("li",{parentName:"ol"},"Select a service or workload from the ",(0,n.kt)("strong",{parentName:"li"},"Target")," drop-down list.")),(0,n.kt)("h3",{id:"certificates"},"Certificates"),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},(0,n.kt)("strong",{parentName:"p"},"Note:")," You must have an SSL certificate that the ingress can use to encrypt/decrypt communications. For more information see ",(0,n.kt)("a",{parentName:"p",href:"/zh/v2.0-v2.4/how-to-guides/new-user-guides/kubernetes-resources-setup/encrypt-http-communication"},"Adding SSL Certificates"),".")),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Click ",(0,n.kt)("strong",{parentName:"li"},"Add Certificate"),"."),(0,n.kt)("li",{parentName:"ol"},"Select a ",(0,n.kt)("strong",{parentName:"li"},"Certificate")," from the drop-down list."),(0,n.kt)("li",{parentName:"ol"},"Enter the ",(0,n.kt)("strong",{parentName:"li"},"Host")," using encrypted communication."),(0,n.kt)("li",{parentName:"ol"},"To add additional hosts that use the certificate, click ",(0,n.kt)("strong",{parentName:"li"},"Add Hosts"),".")),(0,n.kt)("h3",{id:"labels-and-annotations"},"Labels and Annotations"),(0,n.kt)("p",null,"Add ",(0,n.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/"},"Labels")," and/or ",(0,n.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/"},"Annotations")," to provide metadata for your ingress."),(0,n.kt)("p",null,"For a list of annotations available for use, see the ",(0,n.kt)("a",{parentName:"p",href:"https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/"},"Nginx Ingress Controller Documentation"),"."))}u.isMDXComponent=!0}}]);
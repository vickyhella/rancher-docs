"use strict";(self.webpackChunkrancher_docs=self.webpackChunkrancher_docs||[]).push([[88990],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),d=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=d(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=d(n),h=o,m=p["".concat(l,".").concat(h)]||p[h]||u[h]||a;return n?r.createElement(m,s(s({ref:t},c),{},{components:n})):r.createElement(m,s({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=p;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var d=2;d<a;d++)s[d]=n[d];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},64140:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>d});var r=n(87462),o=(n(67294),n(3905));const a={title:"Failed to get job complete status"},s=void 0,i={unversionedId:"getting-started/installation-and-upgrade/advanced-options/advanced-use-cases/helm2/rke-add-on/troubleshooting/job-complete-status",id:"version-2.0-2.4/getting-started/installation-and-upgrade/advanced-options/advanced-use-cases/helm2/rke-add-on/troubleshooting/job-complete-status",title:"Failed to get job complete status",description:"#### Important: RKE add-on install is only supported up to Rancher v2.0.8",source:"@site/versioned_docs/version-2.0-2.4/getting-started/installation-and-upgrade/advanced-options/advanced-use-cases/helm2/rke-add-on/troubleshooting/job-complete-status.md",sourceDirName:"getting-started/installation-and-upgrade/advanced-options/advanced-use-cases/helm2/rke-add-on/troubleshooting",slug:"/getting-started/installation-and-upgrade/advanced-options/advanced-use-cases/helm2/rke-add-on/troubleshooting/job-complete-status",permalink:"/zh/v2.0-v2.4/getting-started/installation-and-upgrade/advanced-options/advanced-use-cases/helm2/rke-add-on/troubleshooting/job-complete-status",draft:!1,editUrl:"https://github.com/rancher/rancher-docs/edit/main/versioned_docs/version-2.0-2.4/getting-started/installation-and-upgrade/advanced-options/advanced-use-cases/helm2/rke-add-on/troubleshooting/job-complete-status.md",tags:[],version:"2.0-2.4",lastUpdatedAt:1663953084,formattedLastUpdatedAt:"2022\u5e749\u670823\u65e5",frontMatter:{title:"Failed to get job complete status"},sidebar:"tutorialSidebar",previous:{title:"Generic troubleshooting",permalink:"/zh/v2.0-v2.4/getting-started/installation-and-upgrade/advanced-options/advanced-use-cases/helm2/rke-add-on/troubleshooting/generic-troubleshooting"},next:{title:"404 - default backend",permalink:"/zh/v2.0-v2.4/getting-started/installation-and-upgrade/advanced-options/advanced-use-cases/helm2/rke-add-on/troubleshooting/default-backend"}},l={},d=[{value:"Failed to deploy addon execute job rke-user-includes-addons: Failed to get job complete status",id:"failed-to-deploy-addon-execute-job-rke-user-includes-addons-failed-to-get-job-complete-status",level:3},{value:"error: error converting YAML to JSON: yaml: line 9:",id:"error-error-converting-yaml-to-json-yaml-line-9",level:4},{value:"Error from server (BadRequest): error when creating &quot;/etc/config/rke-user-addon.yaml&quot;: Secret in version &quot;v1&quot; cannot be handled as a Secret",id:"error-from-server-badrequest-error-when-creating-etcconfigrke-user-addonyaml-secret-in-version-v1-cannot-be-handled-as-a-secret",level:4},{value:"The Ingress &quot;cattle-ingress-http&quot; is invalid: spec.rules0.host: Invalid value: &quot;IP&quot;: must be a DNS name, not an IP address",id:"the-ingress-cattle-ingress-http-is-invalid-specrules0host-invalid-value-ip-must-be-a-dns-name-not-an-ip-address",level:4}],c={toc:d};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("blockquote",null,(0,o.kt)("h4",{parentName:"blockquote",id:"important-rke-add-on-install-is-only-supported-up-to-rancher-v208"},(0,o.kt)("strong",{parentName:"h4"},"Important: RKE add-on install is only supported up to Rancher v2.0.8")),(0,o.kt)("p",{parentName:"blockquote"},"Please use the Rancher Helm chart to install Rancher on a Kubernetes cluster. For details, see the ",(0,o.kt)("a",{parentName:"p",href:"/zh/v2.0-v2.4/getting-started/installation-and-upgrade/resources/helm-version-requirements"},"Kubernetes Install "),"."),(0,o.kt)("p",{parentName:"blockquote"},"If you are currently using the RKE add-on install method, see ",(0,o.kt)("a",{parentName:"p",href:"/zh/v2.0-v2.4/getting-started/installation-and-upgrade/install-upgrade-on-a-kubernetes-cluster/upgrades/migrating-from-rke-add-on"},"Migrating from a Kubernetes Install with an RKE Add-on")," for details on how to move to using the helm chart.")),(0,o.kt)("p",null,"To debug issues around this error, you will need to download the command-line tool ",(0,o.kt)("inlineCode",{parentName:"p"},"kubectl"),". See ",(0,o.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/tasks/tools/install-kubectl/"},"Install and Set Up kubectl")," how to download ",(0,o.kt)("inlineCode",{parentName:"p"},"kubectl")," for your platform."),(0,o.kt)("p",null,"When you have made changes to ",(0,o.kt)("inlineCode",{parentName:"p"},"rancher-cluster.yml"),", you will have to run ",(0,o.kt)("inlineCode",{parentName:"p"},"rke remove --config rancher-cluster.yml")," to clean the nodes, so it cannot conflict with previous configuration errors."),(0,o.kt)("h3",{id:"failed-to-deploy-addon-execute-job-rke-user-includes-addons-failed-to-get-job-complete-status"},"Failed to deploy addon execute job ","[rke-user-includes-addons]",": Failed to get job complete status"),(0,o.kt)("p",null,"Something is wrong in the addons definitions, you can run the following command to get the root cause in the logging of the job:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"kubectl --kubeconfig kube_config_rancher-cluster.yml logs -l job-name=rke-user-addon-deploy-job -n kube-system\n")),(0,o.kt)("h4",{id:"error-error-converting-yaml-to-json-yaml-line-9"},"error: error converting YAML to JSON: yaml: line 9:"),(0,o.kt)("p",null,"The structure of the addons definition in ",(0,o.kt)("inlineCode",{parentName:"p"},"rancher-cluster.yml")," is wrong. In the different resources specified in the addons section, there is a error in the structure of the YAML. The pointer  ",(0,o.kt)("inlineCode",{parentName:"p"},"yaml line 9")," references to the line number of the addon that is causing issues."),(0,o.kt)("b",null,"Things to check"),(0,o.kt)("ul",null,(0,o.kt)("ul",null,(0,o.kt)("li",null,"Is each of the base64 encoded certificate string placed directly after the key, for example: `tls.crt: LS01...`, there should be no newline/space before, in between or after."),(0,o.kt)("li",null,"Is the YAML properly formatted, each indentation should be 2 spaces as shown in the template files."),(0,o.kt)("li",null,"Verify the integrity of your certificate by running this command `cat MyCertificate | base64 -d` on Linux, `cat MyCertificate | base64 -D` on Mac OS . If any error exists, the command output will tell you."))),(0,o.kt)("h4",{id:"error-from-server-badrequest-error-when-creating-etcconfigrke-user-addonyaml-secret-in-version-v1-cannot-be-handled-as-a-secret"},'Error from server (BadRequest): error when creating "/etc/config/rke-user-addon.yaml": Secret in version "v1" cannot be handled as a Secret'),(0,o.kt)("p",null,"The base64 string of one of the certificate strings is wrong. The log message will try to show you what part of the string is not recognized as valid base64."),(0,o.kt)("b",null,"Things to check"),(0,o.kt)("ul",null,(0,o.kt)("ul",null,(0,o.kt)("li",null,"Check if the base64 string is valid by running one of the commands below:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"# MacOS\necho BASE64_CRT | base64 -D\n# Linux\necho BASE64_CRT | base64 -d\n# Windows\ncertutil -decode FILENAME.base64 FILENAME.verify\n")))),(0,o.kt)("h4",{id:"the-ingress-cattle-ingress-http-is-invalid-specrules0host-invalid-value-ip-must-be-a-dns-name-not-an-ip-address"},'The Ingress "cattle-ingress-http" is invalid: spec.rules',"[0]",'.host: Invalid value: "IP": must be a DNS name, not an IP address'),(0,o.kt)("p",null,"The host value can only contain a host name, as it is needed by the ingress controller to match the hostname and pass to the correct backend."))}u.isMDXComponent=!0}}]);
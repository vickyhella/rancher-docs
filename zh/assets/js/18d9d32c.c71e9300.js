"use strict";(self.webpackChunkrancher_docs=self.webpackChunkrancher_docs||[]).push([[87287],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>u});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),o=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=o(e.components);return a.createElement(p.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},k=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,p=e.parentName,m=d(e,["components","mdxType","originalType","parentName"]),k=o(n),u=r,N=k["".concat(p,".").concat(u)]||k[u]||s[u]||l;return n?a.createElement(N,i(i({ref:t},m),{},{components:n})):a.createElement(N,i({ref:t},m))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,i=new Array(l);i[0]=k;var d={};for(var p in t)hasOwnProperty.call(t,p)&&(d[p]=t[p]);d.originalType=e,d.mdxType="string"==typeof e?e:r,i[1]=d;for(var o=2;o<l;o++)i[o]=n[o];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}k.displayName="MDXCreateElement"},20388:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>s,frontMatter:()=>l,metadata:()=>d,toc:()=>o});var a=n(87462),r=(n(67294),n(3905));const l={title:"Rancher Helm Chart \u9009\u9879"},i=void 0,d={unversionedId:"getting-started/installation-and-upgrade/installation-references/helm-chart-options",id:"getting-started/installation-and-upgrade/installation-references/helm-chart-options",title:"Rancher Helm Chart \u9009\u9879",description:"\u672c\u6587\u63d0\u4f9b\u4e86 Rancher Helm Chart \u7684\u914d\u7f6e\u53c2\u8003\u3002",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/getting-started/installation-and-upgrade/installation-references/helm-chart-options.md",sourceDirName:"getting-started/installation-and-upgrade/installation-references",slug:"/getting-started/installation-and-upgrade/installation-references/helm-chart-options",permalink:"/zh/getting-started/installation-and-upgrade/installation-references/helm-chart-options",draft:!1,editUrl:"https://github.com/rancher/rancher-docs/edit/main/docs/getting-started/installation-and-upgrade/installation-references/helm-chart-options.md",tags:[],version:"current",lastUpdatedAt:1669184735,formattedLastUpdatedAt:"2022\u5e7411\u670823\u65e5",frontMatter:{title:"Rancher Helm Chart \u9009\u9879"},sidebar:"tutorialSidebar",previous:{title:"\u5b89\u88c5\u53c2\u8003",permalink:"/zh/pages-for-subheaders/installation-references"},next:{title:"TLS \u8bbe\u7f6e",permalink:"/zh/getting-started/installation-and-upgrade/installation-references/tls-settings"}},p={},o=[{value:"\u5e38\u7528\u9009\u9879",id:"\u5e38\u7528\u9009\u9879",level:2},{value:"\u9ad8\u7ea7\u9009\u9879",id:"\u9ad8\u7ea7\u9009\u9879",level:2},{value:"\u5f15\u5bfc\u5bc6\u7801",id:"\u5f15\u5bfc\u5bc6\u7801",level:3},{value:"API \u5ba1\u8ba1\u65e5\u5fd7",id:"api-\u5ba1\u8ba1\u65e5\u5fd7",level:3},{value:"\u989d\u5916\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf",id:"\u989d\u5916\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf",level:3},{value:"TLS \u8bbe\u7f6e",id:"tls-\u8bbe\u7f6e",level:3},{value:"\u5bfc\u5165 <code>local</code> \u96c6\u7fa4",id:"\u5bfc\u5165-local-\u96c6\u7fa4",level:3},{value:"\u81ea\u5b9a\u4e49 Ingress",id:"\u81ea\u5b9a\u4e49-ingress",level:3},{value:"HTTP \u4ee3\u7406",id:"http-\u4ee3\u7406",level:3},{value:"\u989d\u5916\u7684\u6388\u4fe1 CA",id:"\u989d\u5916\u7684\u6388\u4fe1-ca",level:3},{value:"\u79c1\u6709\u4ed3\u5e93\u548c\u79bb\u7ebf\u5b89\u88c5",id:"\u79c1\u6709\u4ed3\u5e93\u548c\u79bb\u7ebf\u5b89\u88c5",level:3},{value:"\u5916\u90e8 TLS \u7ec8\u6b62",id:"\u5916\u90e8-tls-\u7ec8\u6b62",level:2},{value:"\u4f7f\u7528 NGINX v0.25 \u4e3a\u5916\u90e8 TLS \u914d\u7f6e Ingress",id:"\u4f7f\u7528-nginx-v025-\u4e3a\u5916\u90e8-tls-\u914d\u7f6e-ingress",level:3},{value:"\u5fc5\u987b\u7684 Header",id:"\u5fc5\u987b\u7684-header",level:3},{value:"\u5efa\u8bae\u7684\u8d85\u65f6\u65f6\u95f4",id:"\u5efa\u8bae\u7684\u8d85\u65f6\u65f6\u95f4",level:3},{value:"\u5065\u5eb7\u68c0\u67e5",id:"\u5065\u5eb7\u68c0\u67e5",level:3},{value:"\u793a\u4f8b NGINX \u914d\u7f6e",id:"\u793a\u4f8b-nginx-\u914d\u7f6e",level:3}],m={toc:o};function s(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"\u672c\u6587\u63d0\u4f9b\u4e86 Rancher Helm Chart \u7684\u914d\u7f6e\u53c2\u8003\u3002"),(0,r.kt)("p",null,"\u5982\u9700\u9009\u62e9 Helm Chart \u7248\u672c\uff0c\u8bf7\u53c2\u89c1",(0,r.kt)("a",{parentName:"p",href:"/zh/getting-started/installation-and-upgrade/resources/choose-a-rancher-version"},"\u672c\u9875"),"\u3002"),(0,r.kt)("p",null,"\u4e86\u89e3\u5f00\u542f\u5b9e\u9a8c\u6027\u529f\u80fd\u7684\u8be6\u60c5\uff0c\u8bf7\u53c2\u89c1",(0,r.kt)("a",{parentName:"p",href:"/zh/pages-for-subheaders/enable-experimental-features"},"\u672c\u9875"),"\u3002"),(0,r.kt)("h2",{id:"\u5e38\u7528\u9009\u9879"},"\u5e38\u7528\u9009\u9879"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u9009\u9879"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9ed8\u8ba4\u503c"),(0,r.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"bootstrapPassword")),(0,r.kt)("td",{parentName:"tr",align:null},'" "'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - \u4e3a\u7b2c\u4e00\u4e2a\u7ba1\u7406\u5458\u7528\u6237\u8bbe\u7f6e",(0,r.kt)("a",{parentName:"td",href:"#%E5%BC%95%E5%AF%BC%E5%AF%86%E7%A0%81"},"\u5f15\u5bfc\u5bc6\u7801"),"\u3002\u767b\u5f55\u540e\uff0c\u7ba1\u7406\u5458\u9700\u8981\u91cd\u7f6e\u5bc6\u7801\u3002\u5982\u4e0d\u8bbe\u7f6e\uff0c\u4f1a\u4f7f\u7528\u968f\u673a\u751f\u6210\u7684\u5f15\u5bfc\u5bc6\u7801\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"hostname")),(0,r.kt)("td",{parentName:"tr",align:null},'" "'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - \u4f60\u7684 Rancher Server \u7684\u5b8c\u5168\u9650\u5b9a\u7684\u57df\u540d\uff08FQDN)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"ingress.tls.source")),(0,r.kt)("td",{parentName:"tr",align:null},'"rancher"'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string"),' - \u4ece\u54ea\u91cc\u83b7\u53d6 Ingress \u7684\u8bc1\u4e66- "rancher, letsEncrypt, secret"')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"letsEncrypt.email")),(0,r.kt)("td",{parentName:"tr",align:null},'" "'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - \u4f60\u7684\u90ae\u7bb1\u5730\u5740")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"letsEncrypt.environment")),(0,r.kt)("td",{parentName:"tr",align:null},'"production"'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string"),' - \u53ef\u9009\u9879\uff1a"staging, production"')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"privateCA")),(0,r.kt)("td",{parentName:"tr",align:null},"false"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"bool")," - \u5982\u679c\u4f60\u7684\u8bc1\u4e66\u662f\u7531\u79c1\u6709 CA \u7b7e\u53d1\u7684\uff0c\u628a\u8fd9\u4e2a\u503c\u8bbe\u7f6e\u4e3a true")))),(0,r.kt)("br",null),(0,r.kt)("h2",{id:"\u9ad8\u7ea7\u9009\u9879"},"\u9ad8\u7ea7\u9009\u9879"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u9009\u9879"),(0,r.kt)("th",{parentName:"tr",align:null},"\u9ed8\u8ba4\u503c"),(0,r.kt)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"additionalTrustedCAs")),(0,r.kt)("td",{parentName:"tr",align:null},"false"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"bool")," - \u8bf7\u53c2\u89c1",(0,r.kt)("a",{parentName:"td",href:"#%E9%A2%9D%E5%A4%96%E7%9A%84%E6%8E%88%E4%BF%A1-ca"},"\u989d\u5916\u7684\u6388\u4fe1 CA"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"addLocal")),(0,r.kt)("td",{parentName:"tr",align:null},'"true"'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - \u8ba9 Rancher \u68c0\u6d4b\u5e76\u5bfc\u5165 \u201clocal\u201d Rancher Server \u96c6\u7fa4\u3002",(0,r.kt)("em",{parentName:"td"},"\u6ce8\u610f\uff1a\u6b64\u9009\u9879\u5728 2.5.0 \u4e2d\u5df2\u4e0d\u53ef\u7528\u3002\u4f60\u53ef\u8003\u8651\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"em"},"restrictedAdmin")," \u9009\u9879\uff0c\u6765\u907f\u514d\u7528\u6237\u4fee\u6539\u672c\u5730\u96c6\u7fa4\u3002"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"antiAffinity")),(0,r.kt)("td",{parentName:"tr",align:null},'"preferred"'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string"),' - Rancher Pod \u7684\u53cd\u4eb2\u548c\u6027\u89c4\u5219 - "preferred, required"')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"auditLog.destination")),(0,r.kt)("td",{parentName:"tr",align:null},'"sidecar"'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string"),' - \u53d1\u9001\u5ba1\u8ba1\u65e5\u5fd7\u5230 Sidecar \u5bb9\u5668\u7684\u63a7\u5236\u53f0\u6216 hostPath \u5377 - "sidecar, hostPath"')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"auditLog.hostPath")),(0,r.kt)("td",{parentName:"tr",align:null},'"/var/log/rancher/audit"'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - \u4e3b\u673a\u4e0a\u7684\u65e5\u5fd7\u6587\u4ef6\u76ee\u6807\u5730\u5740\uff08\u4ec5\u5f53",(0,r.kt)("inlineCode",{parentName:"td"},"auditLog.destination")," \u7684\u503c\u662f ",(0,r.kt)("inlineCode",{parentName:"td"},"hostPath")," \u65f6\u751f\u6548\uff09")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"auditLog.level")),(0,r.kt)("td",{parentName:"tr",align:null},"0"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"int")," - \u8bbe\u7f6e ",(0,r.kt)("a",{parentName:"td",href:"/zh/how-to-guides/advanced-user-guides/enable-api-audit-log"},"API \u5ba1\u8ba1\u65e5\u5fd7"),"\u7b49\u7ea7\u30020 \u4ee3\u8868\u5173\u95ed\u3002","[0-3]")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"auditLog.maxAge")),(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"int")," - \u65e7\u5ba1\u8ba1\u65e5\u5fd7\u6587\u4ef6\u6700\u591a\u53ef\u4fdd\u7559\u7684\u5929\u6570\uff08\u4ec5\u5f53",(0,r.kt)("inlineCode",{parentName:"td"},"auditLog.destination")," \u7684\u503c\u662f ",(0,r.kt)("inlineCode",{parentName:"td"},"hostPath")," \u65f6\u751f\u6548\uff09")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"auditLog.maxBackup")),(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"int")," - \u5ba1\u8ba1\u6587\u4ef6\u6700\u5927\u53ef\u4fdd\u7559\u7684\u4e2a\u6570\uff08\u4ec5\u5f53 ",(0,r.kt)("inlineCode",{parentName:"td"},"auditLog.destination")," \u7684\u503c\u662f ",(0,r.kt)("inlineCode",{parentName:"td"},"hostPath")," \u65f6\u751f\u6548\uff09")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"auditLog.maxSize")),(0,r.kt)("td",{parentName:"tr",align:null},"100"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"int")," - \u5728\u5ba1\u8ba1\u65e5\u5fd7\u88ab\u8f6e\u6362\u524d\u7684\u6700\u5927\u5bb9\u91cf\uff0c\u5355\u4f4d\u662f MB\uff08\u4ec5\u5f53 ",(0,r.kt)("inlineCode",{parentName:"td"},"auditLog.destination")," \u7684\u503c\u662f ",(0,r.kt)("inlineCode",{parentName:"td"},"hostPath")," \u65f6\u751f\u6548\uff09")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"auditLog.image.repository")),(0,r.kt)("td",{parentName:"tr",align:null},'"registry.suse.com/bci/bci-micro"'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - \u7528\u4e8e\u6536\u96c6\u5ba1\u8ba1\u65e5\u5fd7\u7684\u955c\u50cf\u7684\u4f4d\u7f6e\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"auditLog.image.tag")),(0,r.kt)("td",{parentName:"tr",align:null},'"15.4.14.3"'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - \u7528\u4e8e\u6536\u96c6\u5ba1\u8ba1\u65e5\u5fd7\u7684\u955c\u50cf\u7684\u6807\u7b7e\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"auditLog.image.pullPolicy")),(0,r.kt)("td",{parentName:"tr",align:null},'"IfNotPresent"'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - \u8986\u76d6 auditLog \u955c\u50cf\u7684 imagePullPolicy - \u201cAlways\u201d\u3001\u201cNever\u201d\u3001\u201cIfNotPresent\u201d\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"busyboxImage")),(0,r.kt)("td",{parentName:"tr",align:null},'""'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - \u7528\u4e8e\u6536\u96c6\u5ba1\u8ba1\u65e5\u5fd7\u7684 busybox \u955c\u50cf\u4f4d\u7f6e\u3002",(0,r.kt)("em",{parentName:"td"},"\u6ce8\u610f\uff1a\u6b64\u9009\u9879\u5df2\u5f03\u7528\uff0c\u8bf7\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"em"},"auditLog.image.repository")," \u6765\u63a7\u5236\u5ba1\u8ba1 sidecar \u955c\u50cf"),"\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"certmanager.version")),(0,r.kt)("td",{parentName:"tr",align:null},'""'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - \u8bbe\u7f6e cert-manager compatibility")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"debug")),(0,r.kt)("td",{parentName:"tr",align:null},"false"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"bool")," - \u5728 Rancher Server \u8bbe\u7f6e debug \u53c2\u6570")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"extraEnv")),(0,r.kt)("td",{parentName:"tr",align:null},"[]"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"list")," - \u4e3a Rancher \u989d\u5916\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"imagePullSecrets")),(0,r.kt)("td",{parentName:"tr",align:null},"[]"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"list")," - \u79c1\u6709\u955c\u50cf\u4ed3\u5e93\u51ed\u8bc1\u7684\u5bc6\u6587\u540d\u79f0\u5217\u8868")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"ingress.configurationSnippet")),(0,r.kt)("td",{parentName:"tr",align:null},'""'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - \u6dfb\u52a0\u989d\u5916\u7684 Nginx \u914d\u7f6e\u3002\u53ef\u7528\u4e8e\u4ee3\u7406\u914d\u7f6e\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"ingress.extraAnnotations")),(0,r.kt)("td",{parentName:"tr",align:null},"{}"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"map")," - \u7528\u4e8e\u81ea\u5b9a\u4e49 Ingress \u7684\u989d\u5916\u6ce8\u91ca")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"ingress.enabled")),(0,r.kt)("td",{parentName:"tr",align:null},"true"),(0,r.kt)("td",{parentName:"tr",align:null},"\u5982\u679c\u503c\u4e3a false\uff0cHelm \u4e0d\u4f1a\u5b89\u88c5 Rancher Ingress\u3002\u4f60\u53ef\u628a\u503c\u8bbe\u4e3a false \u4ee5\u90e8\u7f72\u4f60\u81ea\u5df1\u7684 Ingress\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"letsEncrypt.ingress.class")),(0,r.kt)("td",{parentName:"tr",align:null},'""'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - cert-manager acmesolver ingress \u7684\u53ef\u9009 ingress \u7c7b\uff0c\u7528\u4e8e\u54cd\u5e94 Let's Encrypt ACME \u8d28\u8be2\u3002\u9009\u9879\uff1atraefik\uff0cnginx\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"noProxy")),(0,r.kt)("td",{parentName:"tr",align:null},'"127.0.0.0/8,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,.svc,.cluster.local,cattle-system.svc"'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - \u4e0d\u4f7f\u7528\u4ee3\u7406\u7684\u4e3b\u673a\u540d\u6216 IP \u5730\u5740\u7684\u9017\u53f7\u5206\u9694\u5217\u8868")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"proxy")),(0,r.kt)("td",{parentName:"tr",align:null},'""'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - \u7ed9 Rancher \u914d\u7f6e\u7684 HTTP","[S]"," \u4ee3\u7406")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"rancherImage")),(0,r.kt)("td",{parentName:"tr",align:null},'"rancher/rancher"'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - Rancher \u955c\u50cf\u6e90")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"rancherImagePullPolicy")),(0,r.kt)("td",{parentName:"tr",align:null},'"IfNotPresent"'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string"),' - \u8986\u76d6 Rancher Server \u955c\u50cf\u7684 imagePullPolicy - "Always", "Never", "IfNotPresent"')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"rancherImageTag")),(0,r.kt)("td",{parentName:"tr",align:null},"\u548c Chart \u7248\u672c\u4e00\u81f4"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - rancher/rancher \u955c\u50cf\u6807\u7b7e")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"replicas")),(0,r.kt)("td",{parentName:"tr",align:null},"3"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"int")," - Rancher Server \u526f\u672c\u6570\u3002\u5982\u679c\u8bbe\u4e3a -1\uff0c\u4f1a\u6839\u636e\u96c6\u7fa4\u4e2d\u7684\u53ef\u7528\u8282\u70b9\u6570\u81ea\u52a8\u9009\u62e9 1\uff0c2\u62163\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"resources")),(0,r.kt)("td",{parentName:"tr",align:null},"{}"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"map")," - Rancher Pod \u8d44\u6e90\u8bf7\u6c42\u548c\u9650\u5236")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"restrictedAdmin")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"bool")," - \u5982\u679c\u503c\u4e3a true\uff0c\u521d\u59cb\u7684 Rancher \u7528\u6237\u8bbf\u95ee\u672c\u5730 Kubernetes \u96c6\u7fa4\u4f1a\u53d7\u5230\u9650\u5236\uff0c\u4ee5\u907f\u514d\u6743\u9650\u5347\u7ea7\u3002\u8be6\u60c5\u8bf7\u53c2\u89c1 ",(0,r.kt)("a",{parentName:"td",href:"/zh/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/manage-role-based-access-control-rbac/global-permissions#%E5%8F%97%E9%99%90%E7%AE%A1%E7%90%86%E5%91%98"},"restricted-admin \u89d2\u8272"),"\u3002")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"systemDefaultRegistry")),(0,r.kt)("td",{parentName:"tr",align:null},'""'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - \u7528\u4e8e\u6240\u6709\u7cfb\u7edf\u5bb9\u5668\u955c\u50cf\u7684\u79c1\u6709\u4ed3\u5e93\uff0c\u4f8b\u5982 ",(0,r.kt)("a",{parentName:"td",href:"http://registry.example.com/"},"http://registry.example.com/"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"tls")),(0,r.kt)("td",{parentName:"tr",align:null},'"ingress"'),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"string")," - \u8be6\u60c5\u8bf7\u53c2\u89c1",(0,r.kt)("a",{parentName:"td",href:"#%E5%A4%96%E9%83%A8-tls-%E7%BB%88%E6%AD%A2"},"\u5916\u90e8 TLS \u7ec8\u6b62"),'\u3002- "ingress, external"')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"useBundledSystemChart")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"bool")," - \u9009\u62e9 Rancher Server \u6253\u5305\u7684 system-charts\u3002\u6b64\u53c2\u6570\u7528\u4e8e\u79bb\u7ebf\u73af\u5883\u5b89\u88c5\u3002")))),(0,r.kt)("h3",{id:"\u5f15\u5bfc\u5bc6\u7801"},"\u5f15\u5bfc\u5bc6\u7801"),(0,r.kt)("p",null,"Rancher \u9996\u6b21\u542f\u52a8\u65f6\uff0c\u4f1a\u4e3a\u7b2c\u4e00\u4e2a\u7ba1\u7406\u5458\u7528\u6237\u968f\u673a\u751f\u6210\u4e00\u4e2a\u5bc6\u7801\u3002\u5f53\u7ba1\u7406\u5458\u9996\u6b21\u767b\u5f55 Rancher \u65f6\uff0c\u7528\u4e8e\u83b7\u53d6\u5f15\u5bfc\u5bc6\u7801\uff08Bootstrap\uff09\u7684\u547d\u4ee4\u4f1a\u5728 UI \u4e0a\u663e\u793a\u3002\u7ba1\u7406\u5458\u9700\u8981\u8fd0\u884c\u547d\u4ee4\u5e76\u4f7f\u7528\u5f15\u5bfc\u5bc6\u7801\u767b\u5f55\u3002\u7136\u540e Rancher \u4f1a\u8ba9\u7ba1\u7406\u5458\u91cd\u7f6e\u5bc6\u7801\u3002"),(0,r.kt)("p",null,"\u5982\u679c\u4f60\u60f3\u6307\u5b9a\u5f15\u5bfc\u5bc6\u7801\u800c\u4e0d\u4f7f\u7528\u968f\u673a\u751f\u6210\u7684\u5bc6\u7801\uff0c\u8bf7\u53c2\u8003\u4ee5\u4e0b\u547d\u4ee4\u8bbe\u7f6e\u5bc6\u7801\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-plain"},'--set bootstrapPassword="rancher"\n')),(0,r.kt)("p",null,"\u65e0\u8bba\u4f60\u662f\u4f7f\u7528\u63d0\u4f9b\u7684\u5bc6\u7801\u8fd8\u662f\u751f\u6210\u7684\u5bc6\u7801\uff0c\u5bc6\u7801\u5747\u5b58\u50a8\u5728 Kubernetes \u5bc6\u6587\u4e2d\u3002\u5b89\u88c5 Rancher \u540e\uff0c\u5982\u4f55\u4f7f\u7528 kubectl \u83b7\u53d6\u5bc6\u7801\u7684\u8bf4\u660e\u5c06\u4f1a\u5728 UI \u4e2d\u663e\u793a\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"kubectl get secret --namespace cattle-system bootstrap-secret -o go-template='{{ .data.bootstrapPassword|base64decode}}{{ \"\\n\" }}'\n")),(0,r.kt)("h3",{id:"api-\u5ba1\u8ba1\u65e5\u5fd7"},"API \u5ba1\u8ba1\u65e5\u5fd7"),(0,r.kt)("p",null,"\u542f\u7528 ",(0,r.kt)("a",{parentName:"p",href:"/zh/how-to-guides/advanced-user-guides/enable-api-audit-log"},"API \u5ba1\u8ba1\u65e5\u5fd7"),"\u3002"),(0,r.kt)("p",null,"\u4f60\u53ef\u4ee5\u50cf\u6536\u96c6\u5176\u4ed6\u5bb9\u5668\u65e5\u5fd7\u4e00\u6837\u6536\u96c6\u6b64\u65e5\u5fd7\u3002\u5728 Rancher Server \u96c6\u7fa4\u4e0a\u4e3a ",(0,r.kt)("inlineCode",{parentName:"p"},"System")," \u9879\u76ee\u542f\u7528 ",(0,r.kt)("a",{parentName:"p",href:"/zh/pages-for-subheaders/logging"},"Logging"),"\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-plain"},"--set auditLog.level=1\n")),(0,r.kt)("p",null,"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u542f\u7528\u5ba1\u8ba1\u65e5\u5fd7\u4f1a\u5728 Rancher pod \u4e2d\u521b\u5efa\u4e00\u4e2a Sidecar \u5bb9\u5668\u3002\u8fd9\u4e2a\u5bb9\u5668\uff08",(0,r.kt)("inlineCode",{parentName:"p"},"rancher-audit-log"),"\uff09\u4f1a\u628a\u65e5\u5fd7\u6d41\u4f20\u8f93\u5230 ",(0,r.kt)("inlineCode",{parentName:"p"},"stdout"),"\u3002\u4f60\u53ef\u4ee5\u50cf\u6536\u96c6\u5176\u4ed6\u5bb9\u5668\u65e5\u5fd7\u4e00\u6837\u6536\u96c6\u6b64\u65e5\u5fd7\u3002\u5982\u679c\u4f60\u4f7f\u7528 Sidecar \u4f5c\u4e3a\u5ba1\u8ba1\u65e5\u5fd7\u7684\u76ee\u6807\u65f6\uff0c ",(0,r.kt)("inlineCode",{parentName:"p"},"hostPath"),"\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"maxAge"),"\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"maxBackups")," \u548c ",(0,r.kt)("inlineCode",{parentName:"p"},"maxSize")," \u9009\u9879\u4e0d\u4f1a\u751f\u6548\u3002\u5efa\u8bae\u4f7f\u7528\u4f60\u7684\u64cd\u4f5c\u7cfb\u7edf\u6216 Docker Daemon \u7684\u65e5\u5fd7\u8f6e\u6362\u529f\u80fd\u6765\u63a7\u5236\u78c1\u76d8\u7a7a\u95f4\u7684\u4f7f\u7528\u3002\u8bf7\u4e3a Rancher Server \u96c6\u7fa4\u6216 System \u9879\u76ee\u542f\u7528 ",(0,r.kt)("a",{parentName:"p",href:"/zh/pages-for-subheaders/logging"},"Logging"),"\u3002"),(0,r.kt)("p",null,"\u5c06 ",(0,r.kt)("inlineCode",{parentName:"p"},"auditLog.destination")," \u7684\u503c\u8bbe\u4e3a ",(0,r.kt)("inlineCode",{parentName:"p"},"hostPath"),"\uff0c\u53ef\u4ee5\u5c06\u65e5\u5fd7\u8f6c\u53d1\u5230\u4e0e\u4e3b\u673a\u7cfb\u7edf\u5171\u4eab\u7684\u5377\uff0c\u800c\u4e0d\u662f\u4f20\u8f93\u5230 Sidecar \u5bb9\u5668\u3002\u5982\u679c\u76ee\u6807\u8bbe\u7f6e\u4e3a ",(0,r.kt)("inlineCode",{parentName:"p"},"hostPath"),"\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u8c03\u6574\u5176\u4ed6 auditLog \u53c2\u6570\u4ee5\u8fdb\u884c\u65e5\u5fd7\u8f6e\u6362\u3002"),(0,r.kt)("h3",{id:"\u989d\u5916\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf"},"\u989d\u5916\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf"),(0,r.kt)("p",null,"\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"extraEnv")," \u4e3a Rancher Server \u989d\u5916\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u3002\u8be5\u5217\u8868\u4f7f\u7528\u4e0e\u5bb9\u5668\u6e05\u5355\u5b9a\u4e49\u76f8\u540c\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"name")," \u548c ",(0,r.kt)("inlineCode",{parentName:"p"},"value")," \u952e\u3002\u8bb0\u4f4f\u9700\u8981\u7ed9\u503c\u52a0\u4e0a\u5f15\u53f7\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-plain"},"--set 'extraEnv[0].name=CATTLE_TLS_MIN_VERSION'\n--set 'extraEnv[0].value=1.0'\n")),(0,r.kt)("h3",{id:"tls-\u8bbe\u7f6e"},"TLS \u8bbe\u7f6e"),(0,r.kt)("p",null,"\u5f53\u4f60\u5728 Kubernetes \u96c6\u7fa4\u5185\u5b89\u88c5 Rancher \u65f6\uff0cTLS \u4f1a\u5728\u96c6\u7fa4\u7684 Ingress Controller \u4e0a\u5378\u8f7d\u3002\u652f\u6301\u7684 TLS \u8bbe\u7f6e\u53d6\u51b3\u4e8e\u4f7f\u7528\u7684 Ingress Controller\u3002"),(0,r.kt)("p",null,"\u53c2\u89c1 ",(0,r.kt)("a",{parentName:"p",href:"/zh/getting-started/installation-and-upgrade/installation-references/tls-settings"},"TLS \u8bbe\u7f6e"),"\u4e86\u89e3\u66f4\u591a\u4fe1\u606f\u548c\u9009\u9879\u3002"),(0,r.kt)("h3",{id:"\u5bfc\u5165-local-\u96c6\u7fa4"},"\u5bfc\u5165 ",(0,r.kt)("inlineCode",{parentName:"h3"},"local")," \u96c6\u7fa4"),(0,r.kt)("p",null,"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cRancher Server \u4f1a\u68c0\u6d4b\u5e76\u5bfc\u5165\u5176\u6240\u5728\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"local")," \u96c6\u7fa4\u3002\u6709\u6743\u8bbf\u95ee ",(0,r.kt)("inlineCode",{parentName:"p"},"local")," \u96c6\u7fa4\u7684\u7528\u6237\u5bf9 Rancher Server \u7ba1\u7406\u7684\u6240\u6709\u96c6\u7fa4\u5177\u6709\u201croot\u201d\u8bbf\u95ee\u6743\u9650\u3002"),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"\u5982\u679c\u4f60\u5173\u95ed addLocal\uff0c\u5927\u591a\u6570 Rancher 2.5 \u529f\u80fd\u90fd\u4e0d\u80fd\u4f7f\u7528\uff0c\u5305\u62ec EKS Provisioner\u3002")),(0,r.kt)("p",null,"\u5982\u679c\u8fd9\u5728\u4f60\u7684\u73af\u5883\u4e2d\u662f\u4e00\u4e2a\u95ee\u9898\uff0c\u4f60\u53ef\u4ee5\u5728\u521d\u59cb\u5b89\u88c5\u65f6\u5c06\u6b64\u9009\u9879\u8bbe\u7f6e\u4e3a\u201cfalse\u201d\u3002"),(0,r.kt)("p",null,"\u6b64\u9009\u9879\u4ec5\u5728\u9996\u6b21\u5b89\u88c5 Rancher \u65f6\u6709\u6548\u3002\u8be6\u60c5\u8bf7\u53c2\u89c1 ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/rancher/rancher/issues/16522"},"Issue 16522"),"\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-plain"},'--set addLocal="false"\n')),(0,r.kt)("h3",{id:"\u81ea\u5b9a\u4e49-ingress"},"\u81ea\u5b9a\u4e49 Ingress"),(0,r.kt)("p",null,"\u8981\u81ea\u5b9a\u4e49\u6216\u4f7f\u7528 Rancher Server \u7684\u5176\u4ed6 Ingress\uff0c\u4f60\u53ef\u4ee5\u8bbe\u7f6e\u81ea\u5df1\u7684 Ingress annotations\u3002"),(0,r.kt)("p",null,"\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u8bc1\u4e66\u9881\u53d1\u8005\u7684\u793a\u4f8b\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-plain"},"--set ingress.extraAnnotations.'cert-manager\\.io/cluster-issuer'=issuer-name\n")),(0,r.kt)("p",null,"\u4ee5\u4e0b\u662f\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"ingress.configurationSnippet"),"\u8bbe\u7f6e\u9759\u6001\u4ee3\u7406\u5934\u7684\u5b9e\u4f8b\u3002\u8be5\u503c\u50cf\u6a21\u677f\u4e00\u6837\u8fdb\u884c\u89e3\u6790\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528\u53d8\u91cf\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-plain"},"--set ingress.configurationSnippet='more_set_input_headers X-Forwarded-Host {{ .Values.hostname }};'\n")),(0,r.kt)("h3",{id:"http-\u4ee3\u7406"},"HTTP \u4ee3\u7406"),(0,r.kt)("p",null,"Rancher \u7684\u4e00\u4e9b\u529f\u80fd\uff08Helm Chart\uff09\u9700\u8981\u4f7f\u7528\u4e92\u8054\u7f51\u624d\u80fd\u4f7f\u7528\u3002\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"proxy")," \u6765\u8bbe\u7f6e\u4f60\u7684\u4ee3\u7406\u670d\u52a1\u5668\u3002"),(0,r.kt)("p",null,"\u5728 ",(0,r.kt)("inlineCode",{parentName:"p"},"noProxy")," \u5217\u8868\u4e2d\u6dfb\u52a0\u4f8b\u5916\u7684 IP\u3002\u786e\u4fdd\u4f60\u5df2\u6dfb\u52a0\u4e86 Pod \u96c6\u7fa4 IP \u8303\u56f4\uff08\u9ed8\u8ba4\uff1a",(0,r.kt)("inlineCode",{parentName:"p"},"10.42.0.0/16"),"\uff09\uff0c\u670d\u52a1\u96c6\u7fa4 IP \u8303\u56f4\uff08\u9ed8\u8ba4\uff1a",(0,r.kt)("inlineCode",{parentName:"p"},"10.43.0.0/16"),"\uff09\uff0c\u5185\u90e8\u96c6\u7fa4\u57df\u540d\uff08\u9ed8\u8ba4\uff1a",(0,r.kt)("inlineCode",{parentName:"p"},".svc,.cluster.local"),"\uff09\u548c\u6240\u6709 worker \u96c6\u7fa4 ",(0,r.kt)("inlineCode",{parentName:"p"},"controlplane")," \u8282\u70b9\u3002Rancher \u652f\u6301\u5728\u6b64\u5217\u8868\u4e2d\u4f7f\u7528 CIDR \u8868\u793a\u6cd5\u8303\u56f4\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-plain"},'--set proxy="http://<username>:<password>@<proxy_url>:<proxy_port>/"\n--set noProxy="127.0.0.0/8\\,10.0.0.0/8\\,172.16.0.0/12\\,192.168.0.0/16\\,.svc\\,.cluster.local"\n')),(0,r.kt)("h3",{id:"\u989d\u5916\u7684\u6388\u4fe1-ca"},"\u989d\u5916\u7684\u6388\u4fe1 CA"),(0,r.kt)("p",null,"\u5982\u679c\u4f60\u6709\u79c1\u6709\u955c\u50cf\u4ed3\u5e93\uff08registries\uff09\u3001\u5e94\u7528\u5546\u5e97\uff08catalogs\uff09\u6216\u62e6\u622a\u8bc1\u4e66\u7684\u4ee3\u7406\uff0c\u5219\u53ef\u80fd\u9700\u8981\u5411 Rancher \u6dfb\u52a0\u989d\u5916\u7684\u6388\u4fe1 CA\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-plain"},"--set additionalTrustedCAs=true\n")),(0,r.kt)("p",null,"\u521b\u5efa\u5b8c Rancher deployment \u540e\uff0c\u5c06 pem \u683c\u5f0f\u7684 CA \u8bc1\u4e66\u590d\u5236\u5230\u4e00\u4e2a\u540d\u4e3a ",(0,r.kt)("inlineCode",{parentName:"p"},"ca-additional.pem")," \u7684\u6587\u4ef6\u4e2d\uff0c\u5e76\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"kubectl")," \u5728 ",(0,r.kt)("inlineCode",{parentName:"p"},"cattle-system")," \u547d\u540d\u7a7a\u95f4\u4e2d\u521b\u5efa ",(0,r.kt)("inlineCode",{parentName:"p"},"tls-ca-additional")," \u5bc6\u6587\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-plain"},"kubectl -n cattle-system create secret generic tls-ca-additional --from-file=ca-additional.pem=./ca-additional.pem\n")),(0,r.kt)("h3",{id:"\u79c1\u6709\u4ed3\u5e93\u548c\u79bb\u7ebf\u5b89\u88c5"},"\u79c1\u6709\u4ed3\u5e93\u548c\u79bb\u7ebf\u5b89\u88c5"),(0,r.kt)("p",null,"\u6709\u5173\u4f7f\u7528\u79c1\u6709\u4ed3\u5e93\u5b89\u88c5 Rancher \u7684\u8be6\u60c5\uff0c\u8bf7\u53c2\u89c1",(0,r.kt)("a",{parentName:"p",href:"/zh/pages-for-subheaders/air-gapped-helm-cli-install"},"\u79bb\u7ebf\u5b89\u88c5"),"\u3002"),(0,r.kt)("h2",{id:"\u5916\u90e8-tls-\u7ec8\u6b62"},"\u5916\u90e8 TLS \u7ec8\u6b62"),(0,r.kt)("p",null,"\u6211\u4eec\u5efa\u8bae\u5c06\u8d1f\u8f7d\u5747\u8861\u5668\u914d\u7f6e\u4e3a 4 \u5c42\u5747\u8861\uff0c\u5c06\u666e\u901a 80/tcp \u548c 443/tcp \u8f6c\u53d1\u5230 Rancher Management \u96c6\u7fa4\u8282\u70b9\u3002\u96c6\u7fa4\u4e0a\u7684 Ingress Controller \u4f1a\u5c06\u7aef\u53e3 80 \u4e0a\u7684 HTTP \u6d41\u91cf\u91cd\u5b9a\u5411\u5230\u7aef\u53e3 443 \u4e0a\u7684 HTTPS\u3002"),(0,r.kt)("p",null,"\u4f60\u53ef\u4ee5\u5728 Rancher \u96c6\u7fa4\uff08Ingress\uff09\u5916\u90e8\u7684 L7 \u8d1f\u8f7d\u5747\u8861\u5668\u4e0a\u7ec8\u6b62 SSL/TLS\u3002\u4f7f\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"--set tls=external")," \u9009\u9879\uff0c\u5c06\u8d1f\u8f7d\u5747\u8861\u5668\u6307\u5411\u6240\u6709 Rancher \u96c6\u7fa4\u8282\u70b9\u4e0a\u7684\u7aef\u53e3 HTTP 80\u3002\u8fd9\u5c06\u5728 HTTP \u7aef\u53e3 80 \u4e0a\u66b4\u9732 Rancher \u63a5\u53e3\u3002\u8bf7\u6ce8\u610f\uff0c\u5141\u8bb8\u76f4\u63a5\u8fde\u63a5\u5230 Rancher \u96c6\u7fa4\u7684\u5ba2\u6237\u7aef\u4e0d\u4f1a\u88ab\u52a0\u5bc6\u3002\u5982\u679c\u4f60\u9009\u62e9\u8fd9\u6837\u505a\uff0c\u6211\u4eec\u5efa\u8bae\u4f60\u5c06\u7f51\u7edc\u7ea7\u522b\u7684\u76f4\u63a5\u8bbf\u95ee\u9650\u5236\u4e3a\u4ec5\u4f60\u7684\u8d1f\u8f7d\u5747\u8861\u5668\u3002"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f\u79c1\u6709 CA \u7b7e\u540d\u7684\u8bc1\u4e66\uff0c\u8bf7\u6dfb\u52a0 ",(0,r.kt)("inlineCode",{parentName:"p"},"--set privateCA=true")," \u5e76\u53c2\u89c1",(0,r.kt)("a",{parentName:"p",href:"/zh/getting-started/installation-and-upgrade/resources/add-tls-secrets"},"\u6dfb\u52a0 TLS \u5bc6\u6587 - \u4f7f\u7528\u79c1\u6709 CA \u7b7e\u540d\u8bc1\u4e66"),"\uff0c\u4e3a Rancher \u6dfb\u52a0 CA \u8bc1\u4e66\u3002")),(0,r.kt)("p",null,"\u4f60\u7684\u8d1f\u8f7d\u5747\u8861\u5668\u5fc5\u987b\u652f\u6301\u957f\u671f\u5b58\u5728\u7684 Websocket \u8fde\u63a5\uff0c\u5e76\u4e14\u9700\u8981\u63d2\u5165\u4ee3\u7406\u5934\uff0c\u4ee5\u4fbf Rancher \u53ef\u4ee5\u6b63\u786e\u4f20\u9001\u94fe\u63a5\u3002"),(0,r.kt)("h3",{id:"\u4f7f\u7528-nginx-v025-\u4e3a\u5916\u90e8-tls-\u914d\u7f6e-ingress"},"\u4f7f\u7528 NGINX v0.25 \u4e3a\u5916\u90e8 TLS \u914d\u7f6e Ingress"),(0,r.kt)("p",null,"\u5728 NGINX 0.25 \u4e2d\uff0cNGINX \u5173\u4e8e\u8f6c\u53d1\u5934\u548c\u5916\u90e8 TLS \u7ec8\u6b62\u7684\u884c\u4e3a",(0,r.kt)("a",{parentName:"p",href:"https://github.com/kubernetes/ingress-nginx/blob/master/Changelog.md#0220"},"\u5df2\u66f4\u6539"),"\u3002\u56e0\u6b64\uff0c\u5982\u679c\u4f60\u540c\u65f6\u4f7f\u7528 NGINX 0.25 \u548c\u5916\u90e8 TLS \u7ec8\u6b62\u914d\u7f6e\uff0c\u4f60\u5fc5\u987b\u7f16\u8f91 ",(0,r.kt)("inlineCode",{parentName:"p"},"cluster.yml")," \u6765\u4e3a Ingress \u542f\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"use-forwarded-headers")," \u9009\u9879\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"ingress:\n  provider: nginx\n  options:\n    use-forwarded-headers: 'true'\n")),(0,r.kt)("h3",{id:"\u5fc5\u987b\u7684-header"},"\u5fc5\u987b\u7684 Header"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Host")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"X-Forwarded-Proto")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"X-Forwarded-Port")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"X-Forwarded-For"))),(0,r.kt)("h3",{id:"\u5efa\u8bae\u7684\u8d85\u65f6\u65f6\u95f4"},"\u5efa\u8bae\u7684\u8d85\u65f6\u65f6\u95f4"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u8bfb\u8d85\u65f6\uff1a",(0,r.kt)("inlineCode",{parentName:"li"},"1800 seconds")),(0,r.kt)("li",{parentName:"ul"},"\u5199\u8d85\u65f6\uff1a",(0,r.kt)("inlineCode",{parentName:"li"},"1800 seconds")),(0,r.kt)("li",{parentName:"ul"},"\u8fde\u63a5\u8d85\u65f6\uff1a",(0,r.kt)("inlineCode",{parentName:"li"},"30 seconds"))),(0,r.kt)("h3",{id:"\u5065\u5eb7\u68c0\u67e5"},"\u5065\u5eb7\u68c0\u67e5"),(0,r.kt)("p",null,"Rancher \u5c06\u5bf9 ",(0,r.kt)("inlineCode",{parentName:"p"},"/healthz")," \u7aef\u70b9\u7684\u5065\u5eb7\u68c0\u67e5\u54cd\u5e94",(0,r.kt)("inlineCode",{parentName:"p"},"200"),"\u3002"),(0,r.kt)("h3",{id:"\u793a\u4f8b-nginx-\u914d\u7f6e"},"\u793a\u4f8b NGINX \u914d\u7f6e"),(0,r.kt)("p",null,"\u6b64 NGINX \u914d\u7f6e\u5df2\u5728 NGINX 1.14 \u4e0a\u8fdb\u884c\u4e86\u6d4b\u8bd5\u3002"),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"\u6b64 NGINX \u914d\u7f6e\u53ea\u662f\u4e00\u4e2a\u793a\u4f8b\uff0c\u53ef\u80fd\u4e0d\u9002\u5408\u4f60\u7684\u73af\u5883\u3002\u5982\u9700\u67e5\u9605\u5b8c\u6574\u6587\u6863\uff0c\u8bf7\u53c2\u89c1 ",(0,r.kt)("a",{parentName:"p",href:"https://docs.nginx.com/nginx/admin-guide/load-balancer/http-load-balancer/"},"NGINX \u8d1f\u8f7d\u5747\u8861 - HTTP \u8d1f\u8f7d\u5747\u8861"),"\u3002")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5c06 ",(0,r.kt)("inlineCode",{parentName:"li"},"IP_NODE1"),"\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"IP_NODE2")," \u548c ",(0,r.kt)("inlineCode",{parentName:"li"},"IP_NODE3")," \u66ff\u6362\u4e3a\u4f60\u96c6\u7fa4\u4e2d\u8282\u70b9\u7684 IP \u5730\u5740\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5c06\u4e24\u5904\u7684 ",(0,r.kt)("inlineCode",{parentName:"li"},"FQDN")," \u5747\u66ff\u6362\u4e3a Rancher \u7684 DNS \u540d\u79f0\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u628a ",(0,r.kt)("inlineCode",{parentName:"li"},"/certs/fullchain.pem")," \u548c ",(0,r.kt)("inlineCode",{parentName:"li"},"/certs/privkey.pem")," \u5206\u522b\u66ff\u6362\u4e3a\u670d\u52a1\u5668\u8bc1\u4e66\u548c\u670d\u52a1\u5668\u8bc1\u4e66\u5bc6\u94a5\u7684\u4f4d\u7f6e\u3002")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"worker_processes 4;\nworker_rlimit_nofile 40000;\n\nevents {\n    worker_connections 8192;\n}\n\nhttp {\n    upstream rancher {\n        server IP_NODE_1:80;\n        server IP_NODE_2:80;\n        server IP_NODE_3:80;\n    }\n\n    map $http_upgrade $connection_upgrade {\n        default Upgrade;\n        ''      close;\n    }\n\n    server {\n        listen 443 ssl http2;\n        server_name FQDN;\n        ssl_certificate /certs/fullchain.pem;\n        ssl_certificate_key /certs/privkey.pem;\n\n        location / {\n            proxy_set_header Host $host;\n            proxy_set_header X-Forwarded-Proto $scheme;\n            proxy_set_header X-Forwarded-Port $server_port;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_pass http://rancher;\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection $connection_upgrade;\n            # \u6b64\u9879\u5141\u8bb8\u6267\u884c\u7684 shell \u7a97\u53e3\u4fdd\u6301\u5f00\u542f\uff0c\u6700\u957f\u53ef\u8fbe15\u5206\u949f\u3002\u4e0d\u4f7f\u7528\u6b64\u53c2\u6570\u7684\u8bdd\uff0c\u9ed8\u8ba41\u5206\u949f\u540e\u81ea\u52a8\u5173\u95ed\u3002\n            proxy_read_timeout 900s;\n            proxy_buffering off;\n        }\n    }\n\n    server {\n        listen 80;\n        server_name FQDN;\n        return 301 https://$server_name$request_uri;\n    }\n}\n")))}s.isMDXComponent=!0}}]);
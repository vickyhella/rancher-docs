<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-how-to-guides/new-user-guides/deploy-apps-across-clusters/multi-cluster-apps">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="search" type="application/opensearchdescription+xml" title="Rancher Manager" href="/zh/opensearch.xml"><title data-rh="true">多集群应用 | Rancher Manager</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://docs.ranchermanager.rancher.io//zh/how-to-guides/new-user-guides/deploy-apps-across-clusters/multi-cluster-apps"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="多集群应用 | Rancher Manager"><meta data-rh="true" name="description" content="Rancher v2.5 开始已弃用多集群应用。我们现在建议使用 Fleet 来跨集群部署应用。"><meta data-rh="true" property="og:description" content="Rancher v2.5 开始已弃用多集群应用。我们现在建议使用 Fleet 来跨集群部署应用。"><link data-rh="true" rel="icon" href="/zh/img/favicon.png"><link data-rh="true" rel="canonical" href="http://docs.ranchermanager.rancher.io//zh/how-to-guides/new-user-guides/deploy-apps-across-clusters/multi-cluster-apps"><link data-rh="true" rel="alternate" href="http://docs.ranchermanager.rancher.io//how-to-guides/new-user-guides/deploy-apps-across-clusters/multi-cluster-apps" hreflang="en"><link data-rh="true" rel="alternate" href="http://docs.ranchermanager.rancher.io//zh/how-to-guides/new-user-guides/deploy-apps-across-clusters/multi-cluster-apps" hreflang="zh"><link data-rh="true" rel="alternate" href="http://docs.ranchermanager.rancher.io//how-to-guides/new-user-guides/deploy-apps-across-clusters/multi-cluster-apps" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://30NEY6C9UY-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/zh/assets/css/styles.27db6f3b.css">
<link rel="preload" href="/zh/assets/js/runtime~main.de9de94d.js" as="script">
<link rel="preload" href="/zh/assets/js/main.4d43490c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh/"><div class="navbar__logo"><img src="/zh/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/zh/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/zh/">v2.6</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh/how-to-guides/new-user-guides/deploy-apps-across-clusters/multi-cluster-apps">v2.6</a></li><li><a class="dropdown__link" href="/zh/v2.5/how-to-guides/new-user-guides/deploy-apps-across-clusters/multi-cluster-apps">v2.5</a></li><li><a class="dropdown__link" href="/zh/v2.0-v2.4">v2.0-v2.4</a></li><li><a class="dropdown__link" href="/zh/versions">All versions</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__docs navbar__link--active" href="/zh/">文档</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/how-to-guides/new-user-guides/deploy-apps-across-clusters/multi-cluster-apps" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/zh/how-to-guides/new-user-guides/deploy-apps-across-clusters/multi-cluster-apps" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">简体中文</a></li></ul></div><a href="https://github.com/rancher/rancher-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__github btn btn-secondary icon-github">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh/">Rancher 2.6</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/getting-started">开始使用</a><button aria-label="打开/收起侧边栏菜单「开始使用」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/zh/how-to-guides">操作指南</a><button aria-label="打开/收起侧边栏菜单「操作指南」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/zh/pages-for-subheaders/new-user-guides">新用户指南</a><button aria-label="打开/收起侧边栏菜单「新用户指南」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/pages-for-subheaders/kubernetes-cluster-setup">Kubernetes 集群设置</a><button aria-label="打开/收起侧边栏菜单「Kubernetes 集群设置」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/pages-for-subheaders/infrastructure-setup">基础设施设置</a><button aria-label="打开/收起侧边栏菜单「基础设施设置」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/pages-for-subheaders/kubernetes-clusters-in-rancher-setup">Rancher 设置中的 Kubernetes 集群</a><button aria-label="打开/收起侧边栏菜单「Rancher 设置中的 Kubernetes 集群」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/pages-for-subheaders/kubernetes-resources-setup">Kubernetes 资源设置</a><button aria-label="打开/收起侧边栏菜单「Kubernetes 资源设置」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/pages-for-subheaders/helm-charts-in-rancher">Rancher 中的 Helm Chart</a><button aria-label="打开/收起侧边栏菜单「Rancher 中的 Helm Chart」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/zh/pages-for-subheaders/deploy-apps-across-clusters">跨集群部署应用</a><button aria-label="打开/收起侧边栏菜单「跨集群部署应用」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/how-to-guides/new-user-guides/deploy-apps-across-clusters/fleet">Fleet - 大规模的 GitOps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh/how-to-guides/new-user-guides/deploy-apps-across-clusters/multi-cluster-apps">多集群应用</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/pages-for-subheaders/backup-restore-and-disaster-recovery">备份、恢复和灾难恢复</a><button aria-label="打开/收起侧边栏菜单「备份、恢复和灾难恢复」" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/pages-for-subheaders/advanced-user-guides">高级用户指南</a><button aria-label="打开/收起侧边栏菜单「高级用户指南」" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/reference-guides">参考指南</a><button aria-label="打开/收起侧边栏菜单「参考指南」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/explanations">说明</a><button aria-label="打开/收起侧边栏菜单「说明」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/faq">常见问题</a><button aria-label="打开/收起侧边栏菜单「常见问题」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/troubleshooting">故障排除</a><button aria-label="打开/收起侧边栏菜单「故障排除」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh/contribute-to-rancher">参与 Rancher 社区贡献</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/zh/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/how-to-guides"><span itemprop="name">操作指南</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/pages-for-subheaders/new-user-guides"><span itemprop="name">新用户指南</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/pages-for-subheaders/deploy-apps-across-clusters"><span itemprop="name">跨集群部署应用</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">多集群应用</span><meta itemprop="position" content="4"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">版本：v2.6</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>多集群应用</h1></header><blockquote><p>Rancher v2.5 开始已弃用多集群应用。我们现在建议使用 <a href="/zh/how-to-guides/new-user-guides/deploy-apps-across-clusters/fleet">Fleet</a> 来跨集群部署应用。</p></blockquote><p>通常，大多数应用都部署在单个 Kubernetes 集群上，但有时你可能需要跨不同集群和/或项目部署同一应用的多个副本。在 Rancher 中，<em>多集群应用</em> 指的是使用 Helm Chart 跨多个集群部署的应用。由于能够跨多个集群部署相同的应用，因此可以避免在每个集群上重复执行相同的应用配置操作而引入的人为错误。使用多集群应用，你可以通过自定义在所有项目/集群中使用相同的配置，并根据你的目标项目更改配置。由于多集群应用被视为单个应用，因此更容易管理和维护。</p><p>全局应用商店中的任何 Helm Chart 都可用于部署和管理多集群应用。</p><p>创建多集群应用后，你可以对全局 DNS 条目进行编程，以便更轻松地访问应用。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="先决条件">先决条件<a class="hash-link" href="#先决条件" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="权限">权限<a class="hash-link" href="#权限" title="标题的直接链接">​</a></h3><p>要在 Rancher 中创建多集群应用，你至少需要具有以下权限之一：</p><ul><li>目标集群中的<a href="/zh/how-to-guides/advanced-user-guides/authentication-permissions-and-global-configuration/manage-role-based-access-control-rbac/cluster-and-project-roles#%E9%A1%B9%E7%9B%AE%E8%A7%92%E8%89%B2">项目成员角色</a>，能够创建、读取、更新和删除工作负载</li><li>目标项目所在集群的<a href="/zh/how-to-guides/advanced-user-guides/authentication-permissions-and-global-configuration/manage-role-based-access-control-rbac/cluster-and-project-roles#%E9%9B%86%E7%BE%A4%E8%A7%92%E8%89%B2">集群所有者角色</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="启用旧版功能">启用旧版功能<a class="hash-link" href="#启用旧版功能" title="标题的直接链接">​</a></h3><p>由于 Rancher 2.5 已弃用多集群应用并使用 Fleet 取代它，你需要使用功能开关以启用多集群应用。</p><ol><li>在左上角，单击 <strong>☰ &gt; 全局设置</strong>。</li><li>单击<strong>功能开关</strong>。</li><li>转到<code>旧版应用</code>功能开关并单击<strong>激活</strong>。</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="启动多集群应用">启动多集群应用<a class="hash-link" href="#启动多集群应用" title="标题的直接链接">​</a></h2><ol><li>在左上角，单击<strong>☰ &gt; 多集群应用</strong>。</li><li>点击<strong>启动</strong>。</li><li>找到要启动的应用。</li><li>（可选）查看来自 Helm Chart <code>README</code> 的详细描述。</li><li>在<strong>配置选项</strong>下输入多集群应用的<strong>名称</strong>。默认情况下，此名称还用于在每个<a href="#%E7%9B%AE%E6%A0%87">目标项目</a>中为多集群应用创建一个 Kubernetes 命名空间。命名空间命名为 <code>&lt;MULTI-CLUSTER_APPLICATION_NAME&gt;-&lt;PROJECT_ID&gt;</code>。</li><li>选择一个<strong>模板版本</strong>。</li><li>完成<a href="#%E5%A4%9A%E9%9B%86%E7%BE%A4%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9">多集群应用配置选项</a>以及<a href="#%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9">应用配置选项</a>。</li><li>选择可以<a href="#%E6%88%90%E5%91%98">与多集群应用交互</a>的<strong>成员</strong>。</li><li>添加<a href="#%E8%A6%86%E7%9B%96%E7%89%B9%E5%AE%9A%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9">自定义应用配置答案</a>，这将更改默认应用配置答案中特定项目的配置。</li><li>查看<strong>预览</strong>中的文件。确认后，单击<strong>启动</strong>。</li></ol><p><strong>结果</strong>：应用已部署到所选的命名空间。你可以从项目中查看应用状态。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="多集群应用配置选项">多集群应用配置选项<a class="hash-link" href="#多集群应用配置选项" title="标题的直接链接">​</a></h2><p>Rancher 将多集群应用的配置选项分为以下几个部分。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="目标">目标<a class="hash-link" href="#目标" title="标题的直接链接">​</a></h3><p>在<strong>目标</strong>部分中，选择用于部署应用的项目。项目列表仅显示你有权访问的项目。所选的每个项目都会被添加到列表中，其中显示了所选的集群名称和项目名称。要移除目标项目，单击 <strong>-</strong>。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="升级">升级<a class="hash-link" href="#升级" title="标题的直接链接">​</a></h3><p>在<strong>升级</strong>部分中，选择升级应用时需要使用的升级策略。</p><ul><li><p><strong>滚动更新（批量）</strong>：选择此升级策略时，每次升级的应用数量取决于选择的<strong>批量大小</strong>和<strong>间隔</strong>（多少秒后才开始下一批更新）。</p></li><li><p><strong>同时升级所有应用</strong>：选择此升级策略时，所有项目的所有应用都将同时升级。</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="角色">角色<a class="hash-link" href="#角色" title="标题的直接链接">​</a></h3><p>在<strong>角色</strong>中，你可以定义多集群应用的角色。通常，当用户<a href="/zh/pages-for-subheaders/helm-charts-in-rancher">启动商店应用</a>时，该用户的权限会用于创建应用所需的所有工作负载/资源。</p><p>多集群应用由 <em>系统用户</em> 部署，系统用户还被指定为所有底层资源的创建者。由于实际用户可以从某个目标项目中删除，因此使用 <em>系统用户</em> 而不是实际用户。如果实际用户从其中一个项目中删除，则该用户将不再能够管理其他项目的应用。</p><p>Rancher 允许你选择<strong>项目</strong>或<strong>集群</strong>的角色选项。Rancher 将允许你根据用户的权限使用其中一个角色进行创建。</p><ul><li><p><strong>项目</strong> - 相当于<a href="/zh/how-to-guides/advanced-user-guides/authentication-permissions-and-global-configuration/manage-role-based-access-control-rbac/cluster-and-project-roles#%E9%A1%B9%E7%9B%AE%E8%A7%92%E8%89%B2">项目成员</a>。如果你选择此角色，Rancher 将检查用户是否在所有目标项目中至少具有<a href="/zh/how-to-guides/advanced-user-guides/authentication-permissions-and-global-configuration/manage-role-based-access-control-rbac/cluster-and-project-roles#%E9%A1%B9%E7%9B%AE%E8%A7%92%E8%89%B2">项目成员</a>的角色。虽然用户可能没有被明确授予 <em>项目成员</em> 角色，但如果用户是<a href="/zh/how-to-guides/advanced-user-guides/authentication-permissions-and-global-configuration/manage-role-based-access-control-rbac/global-permissions">管理员</a>、<a href="/zh/how-to-guides/advanced-user-guides/authentication-permissions-and-global-configuration/manage-role-based-access-control-rbac/cluster-and-project-roles#%E9%9B%86%E7%BE%A4%E8%A7%92%E8%89%B2">集群所有者</a>或<a href="/zh/how-to-guides/advanced-user-guides/authentication-permissions-and-global-configuration/manage-role-based-access-control-rbac/cluster-and-project-roles#%E9%A1%B9%E7%9B%AE%E8%A7%92%E8%89%B2">项目所有者</a>，则认为该用户具有所需的权限级别。</p></li><li><p><strong>集群</strong> - 相当于<a href="/zh/how-to-guides/advanced-user-guides/authentication-permissions-and-global-configuration/manage-role-based-access-control-rbac/cluster-and-project-roles#%E9%9B%86%E7%BE%A4%E8%A7%92%E8%89%B2">集群所有者</a>。如果你选择此角色，Rancher 将检查用户是否在所有目标项目中至少具有<a href="/zh/how-to-guides/advanced-user-guides/authentication-permissions-and-global-configuration/manage-role-based-access-control-rbac/cluster-and-project-roles#%E9%A1%B9%E7%9B%AE%E8%A7%92%E8%89%B2">集群所有者</a>的角色。虽然用户可能没有被明确授予 <em>集群所有者</em> 角色，但如果用户是<a href="/zh/how-to-guides/advanced-user-guides/authentication-permissions-and-global-configuration/manage-role-based-access-control-rbac/global-permissions">管理员</a>，则认为该用户具有所需的权限级别。</p></li></ul><p>在启动应用时，Rancher 会在启动应用之前确认你在目标项目中是否拥有这些权限。</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>某些应用（如 <em>Grafana</em> 或 <em>Datadog</em>）需要访问特定集群级别的资源。这些应用将需要 <em>集群</em> 角色。如果你之后发现应用需要集群角色，则可以升级多集群应用以更新角色。</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="应用配置选项">应用配置选项<a class="hash-link" href="#应用配置选项" title="标题的直接链接">​</a></h2><p>对于每个 Helm Chart，你需要输入一个必须的答案列表才能成功部署 Chart。由于 Rancher 会将答案作为 <code>--set</code> 标志传递给 Helm，因此你必须按照<a href="https://helm.sh/docs/intro/using_helm/#the-format-and-limitations-of---set" target="_blank" rel="noopener noreferrer">使用 Helm：–set 的格式和限制</a>中的语法规则来格式化这些答案。</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>示例</h5></div><div class="admonition-content"><p>当输入的答案包含用逗号分隔的两个值（即 <code>abc, bcd</code>）时，你需要用双引号将值括起来（即 <code>&quot;abc, bcd&quot; </code>）。</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用-questionsyml-文件">使用 questions.yml 文件<a class="hash-link" href="#使用-questionsyml-文件" title="标题的直接链接">​</a></h3><p>如果你部署的 Helm Chart 包含 <code>questions.yml</code> 文件，Rancher UI 会将此文件转换成易于使用的 UI 来收集问题的答案。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="原生-helm-chart-的键值对">原生 Helm Chart 的键值对<a class="hash-link" href="#原生-helm-chart-的键值对" title="标题的直接链接">​</a></h3><p>对于原生 Helm Chart（即来自 <strong>Helm Stable</strong> 或 <strong>Helm Incubator</strong> 应用商店或自定义 Helm Chart 仓库的 Chart），答案会在 <strong>Answers</strong> 中以键值对的形式提供。这些答案能覆盖默认值。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="成员">成员<a class="hash-link" href="#成员" title="标题的直接链接">​</a></h3><p>默认情况下，多集群应用只能由应用的创建者管理。你可以在<strong>成员</strong>中添加其他用户，以便这些用户管理或查看多集群应用。</p><ol><li><p>在<strong>成员</strong>搜索框中键入成员的名称，查找要添加的用户。</p></li><li><p>为该成员选择<strong>访问类型</strong>。多集群项目有三种访问类型，请仔细阅读并了解这些访问类型的含义，以了解多集群应用权限的启用方式。</p><ul><li><p><strong>所有者</strong>：此访问类型可以管理多集群应用的任何配置，包括模板版本、<a href="#%E5%A4%9A%E9%9B%86%E7%BE%A4%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9">多集群应用配置选项</a>，<a href="#%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9">应用配置选项</a>，可以与多集群应用交互的成员，以及<a href="#%E8%A6%86%E7%9B%96%E7%89%B9%E5%AE%9A%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9">自定义应用配置答案</a>。由于多集群应用的创建使用与用户不同的权限集，因此多集群应用的任何 <em>所有者</em> 都可以管理/删除<a href="#%E7%9B%AE%E6%A0%87">目标项目</a>中的应用，而不需要显式授权访问这些项目。请仅为受信任的用户配置此访问类型。</p></li><li><p><strong>成员</strong>：此访问类型只能修改模板版本、<a href="#%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9">应用配置选项</a>和<a href="#%E8%A6%86%E7%9B%96%E7%89%B9%E5%AE%9A%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9">自定义应用配置答案</a>。由于多集群应用的创建使用与用户不同的权限集，因此多集群应用的任何 <em>成员</em> 都可以修改应用，而不需要显式授权访问这些项目。请仅为受信任的用户配置此访问类型。</p></li><li><p><strong>只读</strong>：此访问类型不能修改多集群应用的任何配置选项。用户只能查看这些应用。</p></li></ul><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>请确保仅为受信任的用户授予 <em>所有者</em> 或 <em>成员</em> 访问权限，因为这些用户即使无法直接访问项目，也将自动能够管理为此多集群应用创建的应用。</p></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="覆盖特定项目的应用配置选项">覆盖特定项目的应用配置选项<a class="hash-link" href="#覆盖特定项目的应用配置选项" title="标题的直接链接">​</a></h3><p>多集群应用的主要优势之一，是能够在多个集群/项目中使用相同配置部署相同的应用。在某些情况下，你可能需要为某个特定项目使用稍微不同的配置选项，但你依然希望统一管理该应用与其他匹配的应用。此时，你可以为该项目覆盖特定的<a href="#%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9">应用配置选项</a>，而不需要创建全新的应用。</p><ol><li><p>在<strong>答案覆盖</strong>中，单击<strong>添加覆盖</strong>。</p></li><li><p>对于每个覆盖，你可以选择以下内容：</p><ul><li><p><strong>范围</strong>：在配置选项中选择要覆盖哪些目标项目的答案。</p></li><li><p><strong>问题</strong>：选择要覆盖的问题。</p></li><li><p><strong>答案</strong>：输入要使用的答案。</p></li></ul></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="升级多集群应用角色和项目">升级多集群应用角色和项目<a class="hash-link" href="#升级多集群应用角色和项目" title="标题的直接链接">​</a></h2><ul><li><p><strong>在现有的多集群应用上更改角色</strong>
多集群应用的创建者和任何具有“所有者”访问类型的用户都可以升级其<strong>角色</strong>。添加新角色时，我们会检查用户在所有当前目标项目中是否具有该角色。Rancher 会根据 <code>Roles</code> 字段的安装部分，相应地检查用户是否具有全局管理员、集群所有者或项目所有者的角色。</p></li><li><p><strong>添加/删除目标项目</strong></p></li></ul><ol><li>多集群应用的创建者和任何具有“所有者”访问类型的用户都添加或移除目标项目。添加新项目时，我们检查此请求的调用者是否具有多集群应用中定义的所有角色。Rancher 会检查用户是否具有全局管理员、集群所有者和项目所有者的角色。</li><li>删除目标项目时，我们不会进行这些成员资格检查。这是因为调用者的权限可能与目标项目有关，或者由于该项目已被删除导致调用者希望将该项目从目标列表中删除。</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="多集群应用管理">多集群应用管理<a class="hash-link" href="#多集群应用管理" title="标题的直接链接">​</a></h2><p>与同一类型的多个单独应用相比，使用多集群应用的好处之一是易于管理。你可以克隆、升级或回滚多集群应用。</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>先决条件：</h5></div><div class="admonition-content"><p><code>旧版应用</code>功能开关已启用。</p></div></div><ol><li><p>在左上角，单击<strong>☰ &gt; 多集群应用</strong>。</p></li><li><p>选择要对其执行操作的多集群应用，然后单击 <strong>⋮</strong>。选择以下选项之一：</p><ul><li><strong>克隆</strong>：创建另一个具有相同配置的多集群应用。通过使用此选项，你可以轻松复制多集群应用。</li><li><strong>升级</strong>：升级多集群应用以更改某些配置。在为多集群应用执行升级时，如果你有合适的<a href="#%E6%88%90%E5%91%98">访问类型</a>，则可以修改<a href="#%E5%8D%87%E7%BA%A7">升级策略</a>。</li><li><strong>回滚</strong>：将你的应用回滚到特定版本。如果你的一个或多个<a href="#%E7%9B%AE%E6%A0%87">目标</a>的多集群应用在升级后出现问题，你可以使用 Rancher 存储的多达 10 个多集群应用版本进行回滚。回滚多集群应用会恢复<strong>所有</strong>目标集群和项目的应用，而不仅仅是受升级问题影响的目标。</li></ul></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="删除多集群应用">删除多集群应用<a class="hash-link" href="#删除多集群应用" title="标题的直接链接">​</a></h2><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>先决条件：</h5></div><div class="admonition-content"><p><code>旧版应用</code>功能开关已启用。</p></div></div><ol><li><p>在左上角，单击<strong>☰ &gt; 多集群应用</strong>。</p></li><li><p>选择要删除的多集群应用，然后单击<strong>⋮ &gt; 删除</strong>。删除多集群应用会删除所有目标项目中的所有应用和命名空间。</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>不能独立删除在目标项目中为多集群应用创建的应用。只有删除多集群应用后才能删除这些应用。</p></div></div></li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/rancher/rancher-docs/edit/main/docs/how-to-guides/new-user-guides/deploy-apps-across-clusters/multi-cluster-apps.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vbeJ"><span class="theme-last-updated">最后<!-- -->于 <b><time datetime="2022-09-19T03:39:36.000Z">2022/9/19</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh/how-to-guides/new-user-guides/deploy-apps-across-clusters/fleet"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Fleet - 大规模的 GitOps</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh/pages-for-subheaders/backup-restore-and-disaster-recovery"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">备份和灾难恢复</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#先决条件" class="table-of-contents__link toc-highlight">先决条件</a><ul><li><a href="#权限" class="table-of-contents__link toc-highlight">权限</a></li><li><a href="#启用旧版功能" class="table-of-contents__link toc-highlight">启用旧版功能</a></li></ul></li><li><a href="#启动多集群应用" class="table-of-contents__link toc-highlight">启动多集群应用</a></li><li><a href="#多集群应用配置选项" class="table-of-contents__link toc-highlight">多集群应用配置选项</a><ul><li><a href="#目标" class="table-of-contents__link toc-highlight">目标</a></li><li><a href="#升级" class="table-of-contents__link toc-highlight">升级</a></li><li><a href="#角色" class="table-of-contents__link toc-highlight">角色</a></li></ul></li><li><a href="#应用配置选项" class="table-of-contents__link toc-highlight">应用配置选项</a><ul><li><a href="#使用-questionsyml-文件" class="table-of-contents__link toc-highlight">使用 questions.yml 文件</a></li><li><a href="#原生-helm-chart-的键值对" class="table-of-contents__link toc-highlight">原生 Helm Chart 的键值对</a></li><li><a href="#成员" class="table-of-contents__link toc-highlight">成员</a></li><li><a href="#覆盖特定项目的应用配置选项" class="table-of-contents__link toc-highlight">覆盖特定项目的应用配置选项</a></li></ul></li><li><a href="#升级多集群应用角色和项目" class="table-of-contents__link toc-highlight">升级多集群应用角色和项目</a></li><li><a href="#多集群应用管理" class="table-of-contents__link toc-highlight">多集群应用管理</a></li><li><a href="#删除多集群应用" class="table-of-contents__link toc-highlight">删除多集群应用</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 SUSE Rancher. All Rights Reserved.</div></div></div></footer></div>
<script src="/zh/assets/js/runtime~main.de9de94d.js"></script>
<script src="/zh/assets/js/main.4d43490c.js"></script>
</body>
</html>
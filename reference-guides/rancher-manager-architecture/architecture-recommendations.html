<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-reference-guides/rancher-manager-architecture/architecture-recommendations">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Architecture Recommendations | Rancher Manager</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://ranchermanager.docs.rancher.com/reference-guides/rancher-manager-architecture/architecture-recommendations"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Architecture Recommendations | Rancher Manager"><meta data-rh="true" name="description" content="If you are installing Rancher on a single node, the main architecture recommendation that applies to your installation is that the node running Rancher should be separate from downstream clusters."><meta data-rh="true" property="og:description" content="If you are installing Rancher on a single node, the main architecture recommendation that applies to your installation is that the node running Rancher should be separate from downstream clusters."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="http://ranchermanager.docs.rancher.com/reference-guides/rancher-manager-architecture/architecture-recommendations"><link data-rh="true" rel="alternate" href="http://ranchermanager.docs.rancher.com/reference-guides/rancher-manager-architecture/architecture-recommendations" hreflang="en"><link data-rh="true" rel="alternate" href="http://ranchermanager.docs.rancher.com/zh/reference-guides/rancher-manager-architecture/architecture-recommendations" hreflang="zh"><link data-rh="true" rel="alternate" href="http://ranchermanager.docs.rancher.com/reference-guides/rancher-manager-architecture/architecture-recommendations" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://30NEY6C9UY-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-57KS2MW",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>


<link rel="search" type="application/opensearchdescription+xml" title="Rancher Manager" href="/opensearch.xml">

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="0f98beb0-fc4c-417d-a42e-564e2cae42d2" async></script>
<script src="/scripts/optanonwrapper.js" async></script><link rel="stylesheet" href="/assets/css/styles.35be4547.css">
<link rel="preload" href="/assets/js/runtime~main.74cb3068.js" as="script">
<link rel="preload" href="/assets/js/main.0657872f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-57KS2MW" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/">v2.7</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/reference-guides/rancher-manager-architecture/architecture-recommendations">v2.7</a></li><li><a class="dropdown__link" href="/v2.6/reference-guides/rancher-manager-architecture/architecture-recommendations">v2.6</a></li><li><a class="dropdown__link" href="/v2.5/reference-guides/rancher-manager-architecture/architecture-recommendations">v2.5</a></li><li><a class="dropdown__link" href="/v2.0-v2.4/reference-guides/rancher-manager-architecture/architecture-recommendations">v2.0-v2.4</a></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/reference-guides/rancher-manager-architecture/architecture-recommendations" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/zh/reference-guides/rancher-manager-architecture/architecture-recommendations" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">简体中文</a></li></ul></div><a href="https://github.com/rancher/rancher-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__github">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://rancher.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Rancher Home<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">What is Rancher?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/getting-started/overview">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/pages-for-subheaders/new-user-guides">How-to Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/pages-for-subheaders/best-practices">Reference Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/pages-for-subheaders/best-practices">Best Practices</a><button aria-label="Toggle the collapsible sidebar category &#x27;Best Practices&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/pages-for-subheaders/rancher-manager-architecture">Rancher Manager Architecture</a><button aria-label="Toggle the collapsible sidebar category &#x27;Rancher Manager Architecture&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference-guides/rancher-manager-architecture/rancher-server-and-components">Rancher Server and Components</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference-guides/rancher-manager-architecture/communicating-with-downstream-user-clusters">Communicating with Downstream User Clusters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/reference-guides/rancher-manager-architecture/architecture-recommendations">Architecture Recommendations</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/pages-for-subheaders/cluster-configuration">Cluster Configuration</a><button aria-label="Toggle the collapsible sidebar category &#x27;Cluster Configuration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/pages-for-subheaders/single-node-rancher-in-docker">Single-Node Rancher in Docker</a><button aria-label="Toggle the collapsible sidebar category &#x27;Single-Node Rancher in Docker&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/pages-for-subheaders/backup-restore-configuration">Backup &amp; Restore Configuration</a><button aria-label="Toggle the collapsible sidebar category &#x27;Backup &amp; Restore Configuration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference-guides/kubernetes-concepts">Kubernetes Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/pages-for-subheaders/monitoring-v2-configuration">Monitoring V2 Configuration</a><button aria-label="Toggle the collapsible sidebar category &#x27;Monitoring V2 Configuration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/pages-for-subheaders/prometheus-federator">Prometheus Federator</a><button aria-label="Toggle the collapsible sidebar category &#x27;Prometheus Federator&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/pages-for-subheaders/user-settings">User Settings</a><button aria-label="Toggle the collapsible sidebar category &#x27;User Settings&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/pages-for-subheaders/cli-with-rancher">CLI with Rancher</a><button aria-label="Toggle the collapsible sidebar category &#x27;CLI with Rancher&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/pages-for-subheaders/about-the-api">About the API</a><button aria-label="Toggle the collapsible sidebar category &#x27;About the API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference-guides/rancher-cluster-tools">Cluster Tools for Logging, Monitoring, and Visibility</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference-guides/rancher-project-tools">Project Tools for Logging, Monitoring, and Visibility</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference-guides/system-tools">System Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference-guides/rke1-template-example-yaml">RKE1 Example YAML</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/pages-for-subheaders/rancher-security">Rancher Security</a><button aria-label="Toggle the collapsible sidebar category &#x27;Rancher Security&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/pages-for-subheaders/cloud-marketplace">Integrations in Rancher</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/faq/general-faq">FAQ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/troubleshooting/general-troubleshooting">Troubleshooting</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/contribute-to-rancher">Contributing to Rancher</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Reference Guides</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/pages-for-subheaders/rancher-manager-architecture"><span itemprop="name">Rancher Manager Architecture</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Architecture Recommendations</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v2.7</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Architecture Recommendations</h1></header><p>If you are installing Rancher on a single node, the main architecture recommendation that applies to your installation is that the node running Rancher should be <a href="#separation-of-rancher-and-user-clusters">separate from downstream clusters.</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="separation-of-rancher-and-user-clusters">Separation of Rancher and User Clusters<a href="#separation-of-rancher-and-user-clusters" class="hash-link" aria-label="Direct link to Separation of Rancher and User Clusters" title="Direct link to Separation of Rancher and User Clusters">​</a></h2><p>A user cluster is a downstream Kubernetes cluster that runs your apps and services.</p><p>If you have a Docker installation of Rancher, the node running the Rancher server should be separate from your downstream clusters.</p><p>If Rancher is intended to manage downstream Kubernetes clusters, the Kubernetes cluster that the Rancher server runs on should also be separate from the downstream user clusters.</p><p><img loading="lazy" alt="Separation of Rancher Server from User Clusters" src="/assets/images/rancher-architecture-separation-of-rancher-server-b32508a12beee49d72836caa5469e585.svg" width="827" height="595" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-ha-is-better-for-rancher-in-production">Why HA is Better for Rancher in Production<a href="#why-ha-is-better-for-rancher-in-production" class="hash-link" aria-label="Direct link to Why HA is Better for Rancher in Production" title="Direct link to Why HA is Better for Rancher in Production">​</a></h2><p>We recommend installing the Rancher server on a high-availability Kubernetes cluster, primarily because it protects the Rancher server data. In a high-availability installation, a load balancer serves as the single point of contact for clients, distributing network traffic across multiple servers in the cluster and helping to prevent any one server from becoming a point of failure.</p><p>We don&#x27;t recommend installing Rancher in a single Docker container, because if the node goes down, there is no copy of the cluster data available on other nodes and you could lose the data on your Rancher server.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="k3s-kubernetes-cluster-installations">K3s Kubernetes Cluster Installations<a href="#k3s-kubernetes-cluster-installations" class="hash-link" aria-label="Direct link to K3s Kubernetes Cluster Installations" title="Direct link to K3s Kubernetes Cluster Installations">​</a></h3><p>One option for the underlying Kubernetes cluster is to use K3s Kubernetes. K3s is Rancher&#x27;s CNCF certified Kubernetes distribution. It is easy to install and uses half the memory of Kubernetes, all in a binary of less than 100 MB. Another advantage of K3s is that it allows an external datastore to hold the cluster data, allowing the K3s server nodes to be treated as ephemeral.</p><figcaption>Architecture of a K3s Kubernetes Cluster Running the Rancher Management Server</figcaption><p><img loading="lazy" alt="Architecture of a K3s Kubernetes Cluster Running the Rancher Management Server" src="/assets/images/k3s-server-storage-d746fa487cbe57d9ac9c5ed69c068f74.svg" width="249" height="371" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rke-kubernetes-cluster-installations">RKE Kubernetes Cluster Installations<a href="#rke-kubernetes-cluster-installations" class="hash-link" aria-label="Direct link to RKE Kubernetes Cluster Installations" title="Direct link to RKE Kubernetes Cluster Installations">​</a></h3><p>In an RKE installation, the cluster data is replicated on each of three etcd nodes in the cluster, providing redundancy and data duplication in case one of the nodes fails.</p><figcaption>Architecture of an RKE Kubernetes Cluster Running the Rancher Management Server</figcaption><p><img loading="lazy" alt="Architecture of an RKE Kubernetes cluster running the Rancher management server" src="/assets/images/rke-server-storage-479a90c18ba2cf4b197554330d05afe8.svg" width="341" height="322" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="recommended-load-balancer-configuration-for-kubernetes-installations">Recommended Load Balancer Configuration for Kubernetes Installations<a href="#recommended-load-balancer-configuration-for-kubernetes-installations" class="hash-link" aria-label="Direct link to Recommended Load Balancer Configuration for Kubernetes Installations" title="Direct link to Recommended Load Balancer Configuration for Kubernetes Installations">​</a></h2><p>We recommend the following configurations for the load balancer and Ingress controllers:</p><ul><li>The DNS for Rancher should resolve to a Layer 4 load balancer (TCP).</li><li>The Load Balancer should forward port TCP/80 and TCP/443 to all 3 nodes in the Kubernetes cluster.</li><li>The Ingress controller will redirect HTTP to HTTPS and terminate SSL/TLS on port TCP/443.</li><li>The Ingress controller will forward traffic to port TCP/80 on the pod in the Rancher deployment.</li></ul><figcaption>Rancher installed on a Kubernetes cluster with layer 4 load balancer, depicting SSL termination at Ingress controllers</figcaption><p><img loading="lazy" alt="Rancher HA" src="/assets/images/rancher2ha-109862fddef6042942f103cfc94d892b.svg" width="1236" height="525" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="environment-for-kubernetes-installations">Environment for Kubernetes Installations<a href="#environment-for-kubernetes-installations" class="hash-link" aria-label="Direct link to Environment for Kubernetes Installations" title="Direct link to Environment for Kubernetes Installations">​</a></h2><p>It is strongly recommended to install Rancher on a Kubernetes cluster on hosted infrastructure such as Amazon&#x27;s EC2 or Google Compute Engine.</p><p>For the best performance and greater security, we recommend a dedicated Kubernetes cluster for the Rancher management server. Running user workloads on this cluster is not advised. After deploying Rancher, you can <a href="/pages-for-subheaders/kubernetes-clusters-in-rancher-setup">create or import clusters</a> for running your workloads.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="recommended-node-roles-for-kubernetes-installations">Recommended Node Roles for Kubernetes Installations<a href="#recommended-node-roles-for-kubernetes-installations" class="hash-link" aria-label="Direct link to Recommended Node Roles for Kubernetes Installations" title="Direct link to Recommended Node Roles for Kubernetes Installations">​</a></h2><p>The below recommendations apply when Rancher is installed on a K3s Kubernetes cluster or an RKE Kubernetes cluster.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="k3s-cluster-roles">K3s Cluster Roles<a href="#k3s-cluster-roles" class="hash-link" aria-label="Direct link to K3s Cluster Roles" title="Direct link to K3s Cluster Roles">​</a></h3><p>In K3s clusters, there are two types of nodes: server nodes and agent nodes. Both servers and agents can have workloads scheduled on them. Server nodes run the Kubernetes master.</p><p>For the cluster running the Rancher management server, we recommend using two server nodes. Agent nodes are not required.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rke-cluster-roles">RKE Cluster Roles<a href="#rke-cluster-roles" class="hash-link" aria-label="Direct link to RKE Cluster Roles" title="Direct link to RKE Cluster Roles">​</a></h3><p>If Rancher is installed on an RKE Kubernetes cluster, the cluster should have three nodes, and each node should have all three Kubernetes roles: etcd, controlplane, and worker.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="contrasting-rke-cluster-architecture-for-rancher-server-and-for-downstream-kubernetes-clusters">Contrasting RKE Cluster Architecture for Rancher Server and for Downstream Kubernetes Clusters<a href="#contrasting-rke-cluster-architecture-for-rancher-server-and-for-downstream-kubernetes-clusters" class="hash-link" aria-label="Direct link to Contrasting RKE Cluster Architecture for Rancher Server and for Downstream Kubernetes Clusters" title="Direct link to Contrasting RKE Cluster Architecture for Rancher Server and for Downstream Kubernetes Clusters">​</a></h3><p>Our recommendation for RKE node roles on the Rancher server cluster contrasts with our recommendations for the downstream user clusters that run your apps and services.</p><p>Rancher uses RKE as a library when provisioning downstream Kubernetes clusters. Note: The capability to provision downstream K3s clusters will be added in a future version of Rancher.</p><p>For downstream Kubernetes clusters, we recommend that each node in a user cluster should have a single role for stability and scalability.</p><p><img loading="lazy" alt="Kubernetes Roles for Nodes in Rancher Server Cluster vs. User Clusters" src="/assets/images/rancher-architecture-node-roles-d119f0d32608589178cd9bf1375745cc.svg" width="801" height="411" class="img_ev3q"></p><p>RKE only requires at least one node with each role and does not require nodes to be restricted to one role. However, for the clusters that run your apps, we recommend separate roles for each node so that workloads on worker nodes don&#x27;t interfere with the Kubernetes master or cluster data as your services scale.</p><p>We recommend that downstream user clusters should have at least:</p><ul><li><strong>Three nodes with only the etcd role</strong> to maintain a quorum if one node is lost, making the state of your cluster highly available</li><li><strong>Two nodes with only the controlplane role</strong> to make the master component highly available</li><li><strong>One or more nodes with only the worker role</strong> to run the Kubernetes node components, as well as the workloads for your apps and services</li></ul><p>With that said, it is safe to use all three roles on three nodes when setting up the Rancher server because:</p><ul><li>It allows one <code>etcd</code> node failure.</li><li>It maintains multiple instances of the master components by having multiple <code>controlplane</code> nodes.</li><li>No other workloads than Rancher itself should be created on this cluster.</li></ul><p>Because no additional workloads will be deployed on the Rancher server cluster, in most cases it is not necessary to use the same architecture that we recommend for the scalability and reliability of downstream clusters.</p><p>For more best practices for downstream clusters, refer to the <a href="/pages-for-subheaders/checklist-for-production-ready-clusters">production checklist</a> or our <a href="/pages-for-subheaders/best-practices">best practices guide.</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="architecture-for-an-authorized-cluster-endpoint-ace">Architecture for an Authorized Cluster Endpoint (ACE)<a href="#architecture-for-an-authorized-cluster-endpoint-ace" class="hash-link" aria-label="Direct link to Architecture for an Authorized Cluster Endpoint (ACE)" title="Direct link to Architecture for an Authorized Cluster Endpoint (ACE)">​</a></h2><p>If you are using an <a href="/pages-for-subheaders/rancher-manager-architecture#4-authorized-cluster-endpoint">authorized cluster endpoint (ACE),</a> we recommend creating an FQDN pointing to a load balancer which balances traffic across your nodes with the <code>controlplane</code> role.</p><p>If you are using private CA signed certificates on the load balancer, you have to supply the CA certificate, which will be included in the generated kubeconfig file to validate the certificate chain. See the documentation on <a href="/how-to-guides/new-user-guides/manage-clusters/access-clusters/use-kubectl-and-kubeconfig">kubeconfig files</a> and <a href="/reference-guides/user-settings/api-keys#creating-an-api-key">API keys</a> for more information.</p><p>As of Rancher v2.6.3, ACE support is available for registered RKE2 and K3s clusters. To view the manual steps to perform on the downstream cluster to enable the ACE, click <a href="/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/register-existing-clusters#authorized-cluster-endpoint-support-for-rke2-and-k3s-clusters">here</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/rancher/rancher-docs/edit/main/docs/reference-guides/rancher-manager-architecture/architecture-recommendations.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-10-29T00:09:06.000Z">Oct 29, 2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/reference-guides/rancher-manager-architecture/communicating-with-downstream-user-clusters"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Communicating with Downstream User Clusters</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/pages-for-subheaders/cluster-configuration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Cluster Configuration</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#separation-of-rancher-and-user-clusters" class="table-of-contents__link toc-highlight">Separation of Rancher and User Clusters</a></li><li><a href="#why-ha-is-better-for-rancher-in-production" class="table-of-contents__link toc-highlight">Why HA is Better for Rancher in Production</a><ul><li><a href="#k3s-kubernetes-cluster-installations" class="table-of-contents__link toc-highlight">K3s Kubernetes Cluster Installations</a></li><li><a href="#rke-kubernetes-cluster-installations" class="table-of-contents__link toc-highlight">RKE Kubernetes Cluster Installations</a></li></ul></li><li><a href="#recommended-load-balancer-configuration-for-kubernetes-installations" class="table-of-contents__link toc-highlight">Recommended Load Balancer Configuration for Kubernetes Installations</a></li><li><a href="#environment-for-kubernetes-installations" class="table-of-contents__link toc-highlight">Environment for Kubernetes Installations</a></li><li><a href="#recommended-node-roles-for-kubernetes-installations" class="table-of-contents__link toc-highlight">Recommended Node Roles for Kubernetes Installations</a><ul><li><a href="#k3s-cluster-roles" class="table-of-contents__link toc-highlight">K3s Cluster Roles</a></li><li><a href="#rke-cluster-roles" class="table-of-contents__link toc-highlight">RKE Cluster Roles</a></li><li><a href="#contrasting-rke-cluster-architecture-for-rancher-server-and-for-downstream-kubernetes-clusters" class="table-of-contents__link toc-highlight">Contrasting RKE Cluster Architecture for Rancher Server and for Downstream Kubernetes Clusters</a></li></ul></li><li><a href="#architecture-for-an-authorized-cluster-endpoint-ace" class="table-of-contents__link toc-highlight">Architecture for an Authorized Cluster Endpoint (ACE)</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 SUSE Rancher. All Rights Reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.74cb3068.js"></script>
<script src="/assets/js/main.0657872f.js"></script>
</body>
</html>